"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[801],{92771:(e,t,i)=>{i.d(t,{JJ:()=>C,QO:()=>Z,A1:()=>D,Pk:()=>V});var r=i(15070),a=i(65917),n=i(20270),o=i(2911),l=i(4615),s=i(89101),d=i(77420),u=i(49953),c=i(9844),p=i(19889),g=i(97880),m=i(44876),f=i(36054),v=i(50906),b=i(76463),_=i(47307),h=i(81677),y=i(95477),x=i(12982),w=i(43348),M=i(33929),I=i(79315),S=i(3815),F=i(9953),k=i(64293),R=i(30149);function C(e){const{environment:t,formState:i,formData:a}=e;return"create-bot"===i.type?function(e){const{environment:t,formData:i}=e,{currentUserRootStore:r}=I.default.state;if(!r)return;const{botStore:a}=b.lz({environment:t,name:i.name,icon:i.icon,userId:r.id,spaceStore:i.space,spaceRole:"none",type:"guest",capabilities:i.capabilities||{read_content:!0,insert_content:!0,update_content:!0,read_user_without_email:!0,read_user_with_email:!0}});return U(t,{id:a.id,table:d.cZ,spaceId:i.space.id}),v.trackDeveloperIntegrationsCreate(t,{table:d.cZ}),{id:a.id,table:d.cZ,spaceId:i.space.id}}({environment:t,formData:a}):"update-bot"===i.type?function(e){const{environment:t,botPointer:i,formData:r}=e,{currentUserRootStore:a}=I.default.state;if(!a)return;const n=(0,S.Kv)(a,i),o="developerIntegrationActions.updateBot";return R.createAndCommit({userAction:o,environment:t,perform:e=>{F.sW({store:n,data:{name:r.name,icon:r.icon,parent_id:r.space.id,last_edited_by_id:a.id,last_edited_by_table:p.KJ,last_edited_at:Date.now(),capabilities:r.capabilities},transaction:e}),e.postSubmitCallbacks=[t=>{t&&L(t,o,e.spaceId)}]}}),v.trackDeveloperIntegrationsUpdate(t,{table:d.cZ}),i}({environment:t,botPointer:{id:i.startingRecord.value.id,table:i.startingRecord.table,spaceId:i.startingRecord.value.space_id},formData:a}):"create-guest-integration"===i.type?function(e){const{environment:t,botPointer:i,formData:a}=e,{currentUserRootStore:n}=I.default.state;if(!n)return;const o=(0,S.Kv)(n,i),l=o.getValue(),s=l&&(0,r.hA)(l)?l.capabilities:{read_content:!0,insert_content:!0,update_content:!0,read_user_without_email:!0,read_user_with_email:!0},d={name:a.name,tagline:a.tagline,icon:a.icon,email:a.email,website_url:a.website_url,privacy_policy_url:a.privacy_policy_url,terms_of_use_url:a.terms_of_use_url,template_page_id:a.template_page_id,redirect_uris:a.redirect_uris,capabilities:s,userRootStore:n,developer_name:a.developer_name},u="developerIntegrationActions.integrationId",{performResult:g}=R.createAndCommit({userAction:u,environment:t,perform:e=>{const i=h.Do(t,e,d).id;return F.sW({store:o,data:{integration_id:i,parent_table:p.KJ,parent_id:n.id},transaction:e}),e.postSubmitCallbacks=[t=>{t&&L(t,u,e.spaceId)}],i}}),m={id:g,table:c.K2};return U(t,m),v.trackDeveloperIntegrationsCreate(t,{table:c.K2,template_id:a.template_page_id}),m}({environment:t,botPointer:{id:i.startingRecord.value.id,table:i.startingRecord.table,spaceId:i.startingRecord.value.space_id},formData:a}):"update-guest-integration"===i.type?T({environment:t,integrationPointer:{id:i.startingRecord.value.id,table:i.startingRecord.table},formData:a}):"create-third-party-external-integration"===i.type?function(e){const{environment:t,formData:i,integrationPointer:r}=e,{currentUserRootStore:a}=I.default.state,n=r.id;if(!a)return;const o=P(i);if(!o)return;const l=o.oauth_authorize_url;T({environment:t,integrationPointer:r,formData:i,hasLinkPreviewCapabilities:!0,redirect_uris:[l]});const s="developerIntegrationActions.createThirdPartyExternalIntegration";return R.createAndCommit({userAction:s,environment:t,perform:e=>{h.xt(t,e,{integrationId:n,userRootStore:a,config:o}),e.postSubmitCallbacks=[t=>{t&&L(t,s,e.spaceId)}]}}),U(t,r),v.trackDeveloperIntegrationsCreate(t,{table:c.K2}),r}({environment:t,integrationPointer:{id:i.startingRecord.value.id,table:i.startingRecord.table},formData:a}):"update-third-party-external-integration"===i.type?function(e){const{environment:t,integrationPointer:i,formData:r}=e,{currentUserRootStore:a}=I.default.state;if(!a)return;const n=P(r);if(!n)return;const o=(0,S.Kv)(a,{table:u.r9,id:i.id}),l={oauth_authorize_url:n.oauth_authorize_url,oauth_token_url:n.oauth_token_url,client_id:n.client_id,client_secret:n.client_secret,scopes:n.scopes||null,deletion_url:n.deletion_url||null},s=n.oauth_authorize_url;T({environment:t,integrationPointer:i,formData:r,hasLinkPreviewCapabilities:!0,redirect_uris:[s]});const d="developerIntegrationActions.updateThirdPartyExternalIntegration";return R.createAndCommit({userAction:d,environment:t,perform:e=>{F.sW({store:o,data:l,transaction:e}),e.postSubmitCallbacks=[t=>{t&&L(t,d,e.spaceId)}]}}),i}({environment:t,integrationPointer:{id:i.startingRecord.value.id,table:i.startingRecord.table},formData:a}):"update-first-party-external-integration"===i.type?T({environment:t,integrationPointer:{id:i.startingRecord.value.id,table:i.startingRecord.table},formData:a,hasLinkPreviewCapabilities:!0}):(0,g.t1)(i)}function T(e){const{environment:t,integrationPointer:i,formData:r,hasLinkPreviewCapabilities:a,redirect_uris:o}=e,{currentUserRootStore:l}=I.default.state;if(!l)return;const s=(0,S.Kv)(l,i),d=s.getValue(),u=i.id,p="guest"===(null==d?void 0:d.type)?null==d?void 0:d.info.template_page_id:void 0,f=a?{...r.capabilities,link_preview:!0}:r.capabilities,b=a?"external":"guest",_={name:r.name,redirect_uris:o??r.redirect_uris,capabilities:f,type:b},h=(0,S.Vh)(s,s.pointer,"info"),y=function(e){const{hasLinkPreviewCapabilities:t,integrationId:i,formData:r,currentIntegrationInfo:a}=e;if(t)return function(e){var t;const{integrationId:i,formData:r,currentIntegrationInfo:a}=e,o=(null==a||null===(t=a.original_url_patterns)||void 0===t?void 0:t.filter((e=>{var t;return!0===(null===(t=e.additional_types)||void 0===t?void 0:t.collection)})))??[],l=r.url_matching_and_placeholder.map((e=>{const t=[];for(const i of e.attributes){const e=(0,m.GY)(i);if(!(0,n.nj)(e))return;t.push(e)}return{name:(0,w.X)({patternName:e.name,integrationId:i}),regex:e.regex,attributes:t,sample_urls:e.sampleUrls}})).filter(g.$K),s=r.domain.domainVerifications.filter((e=>"unverified"===e.type)).map((e=>e.domain));return{tagline:r.tagline,icon:r.icon,email:r.email,website_url:r.website_url,privacy_policy_url:r.privacy_policy_url,terms_of_use_url:r.terms_of_use_url,developer_name:r.developer_name,unfurl_url:r.unfurl_url,development_url_domains:s,original_url_patterns:[...l,...o],dark_icon:(null==a?void 0:a.dark_icon)??r.icon,accent_color:(null==a?void 0:a.accent_color)??{r:36,g:41,b:47},accent_icon:(null==a?void 0:a.accent_icon)??r.icon}}({integrationId:i,formData:r,currentIntegrationInfo:a});return{tagline:r.tagline,icon:r.icon,email:r.email,website_url:r.website_url,privacy_policy_url:r.privacy_policy_url,terms_of_use_url:r.terms_of_use_url,template_page_id:r.template_page_id,developer_name:r.developer_name}}({hasLinkPreviewCapabilities:a,integrationId:u,formData:r,currentIntegrationInfo:h.getValue()}),x="developerIntegrationActions.updateIntegration";R.createAndCommit({userAction:x,environment:t,perform:e=>{F.sW({store:s,data:_,transaction:e}),F.sW({store:h,data:y,transaction:e}),e.postSubmitCallbacks=[t=>{t&&L(t,x,e.spaceId)}]}});const M=r.template_page_id??void 0,k=p!==M;return v.trackDeveloperIntegrationsUpdate(t,{table:c.K2,...k&&{template_id_before:p},...k&&{template_id_after:M}}),i}function Z(e){const{environment:t,integrationId:i,allVerifiedDomains:r,domainToRemove:a}=e,{currentUserRootStore:n}=I.default.state;if(!n)return;const o=(0,S.Kv)(n,{table:c.K2,id:i}),l=(0,S.Vh)(o,o.pointer,"info"),s="developerIntegrationActions.removeVerifiedDomain";R.createAndCommit({userAction:s,environment:t,perform:e=>{F.sW({store:l,data:{original_url_domains:r.filter((e=>e!==a))},transaction:e}),e.postSubmitCallbacks=[t=>{t&&L(t,s,e.spaceId)}]}}),v.trackDeveloperIntegrationsUpdate(t,{table:c.K2})}function D(e){k.navigate({environment:e,url:s._j.myIntegrations})}function U(e,t){const i={[d.cZ]:"internal",[c.K2]:"public"}[t.table],r=(0,l.cj)(t.id);k.navigate({environment:e,url:`${s._j.myIntegrations}/${i}/${r}`})}function V(e){const t=(0,l.cj)(e.id);return`${y.Z.domainBaseUrl}${s._j.myIntegrations}/public/${t}/lab`}function P(e){const t={oauth_authorize_url:e.external_oauth_authorize_url,oauth_token_url:e.external_oauth_token_url,client_id:e.external_client_id,client_secret:e.external_client_secret,scopes:e.external_oauth_scopes,deletion_url:e.external_deletion_url};return(0,f.Gu)(u.wG,t)?void 0:t}function L(e,t,i){_.showErrorMessage(M.default.formatMessage(x.sY.transactionGenericError)),a.log({level:"error",from:"developerIntegrationActions",type:"createAndCommit",error:(0,o.Ui)(e),data:{userAction:t,spaceId:i}})}},56305:(e,t,i)=>{i.r(t),i.d(t,{default:()=>g});var r=i(77094),a=i.n(r),n=(i(67294),i(16489)),o=i(5366),l=i(43250),s=i(12982),d=i(22230),u=i(79500),c=i(87100),p=i(97812);function g(e){window.__c="DeveloperIntegrationCreateV2";const{onClose:t,onSuccess:i}=e,r=(0,n.qz)(void 0,d.Z);return a()(p.Z,{className:l.Zp2,title:a()(o.FormattedMessage,{id:"developerIntegrationsCreateInternal.title.label",defaultMessage:"Create a new integration"}),subtitle:a()(o.FormattedMessage,{id:"developerIntegrationsCreateInternal.subtitle.label",defaultMessage:"Weâ€™ll walk you through how to setup a new integration."}),onNavigateBack:t,sideContent:a()(u.T,{supportedPages:(0,s.H)("create-bot")})},void 0,a()(c.Z,{onCreateNew:i,integrationFormStore:r,currentPage:"basic"}))}},31850:(e,t,i)=>{i.d(t,{Z:()=>f});var r=i(77094),a=i.n(r),n=i(97464),o=i.n(n),l=i(67294),s=i(24405),d=i(3779),u=i(87279),c=i(78140),p=i(32163),g=i(44532),m=i(72495);function f(e){window.__c="DeveloperIntegrationFormDropdown";const{value:t}=e,[i,r]=l.useState(!1),n=()=>r(!1);return a()(g.GI,{popupType:g.GI.PopupType.Popup,alignmentToOrigin:g.GI.Alignment.Start,placementToOrigin:g.GI.Placement.Bottom,originGap:2,sameWidthAsOrigin:!0,open:i,onDismiss:n,render:()=>l.createElement(b,o()({},e,{value:t,onClose:n})),origin:l.createElement(v,o()({},e,{value:t,onClick:()=>r(!0)}))})}function v(e){const{onClick:t,value:i,renderMenuItem:r}=e,a=(0,s.yK)((e=>({dropdown:{background:e.whiteButtonBackground,border:`1px solid ${e.outlineButtonBorder}`,borderRadius:3,height:32},expandIcon:{height:12,width:12,fill:e.lightIconColor}})),[]);return l.createElement(l.Fragment,null,r({item:i,focused:!1,onClick:t,style:a.dropdown,right:d.Z.expand(a.expandIcon)}))}function b(e){window.__c="SelectionDropdown";const{keyName:t,items:i,value:r,setValue:n,renderMenuItem:o,onClose:s}=e;let d=0;const g=i.map(((e,t)=>(e.id===(null==r?void 0:r.id)&&(d=t),{key:e.id,action:()=>{n(e),s()},render:t=>o({...t,item:e})})));return a()(c.Z,{menuType:u.og.Popup},void 0,a()(p.Z,{type:p.i.Vertical,initialFocus:d,sections:[{key:`form-input-section-${t}`,items:g,render:e=>l.createElement(m.Z,e)}]}))}},95284:(e,t,i)=>{i.d(t,{Z:()=>g});var r=i(77094),a=i.n(r),n=i(67294),o=i(480),l=i(5366),s=i(53471),d=i(71669),u=i(68785),c=i(63296),p=i(81865);function g(e){const{value:t,setValue:i,setError:r}=e,g=(0,o.O7)(),[m,f]=n.useState(!1);return n.createElement(n.Fragment,null,t&&a()(p.Z,{url:t,isAuthenticated:!1,stripGoogleIconQuery:!0,width:90,render:(e,t)=>a()("div",{style:{width:90,height:90}},void 0,a()(d.Z,{src:t,style:{width:90,height:90,objectFit:"cover",borderRadius:3}}))}),a()(c.Z,{isLarge:!0,style:{width:"fit-content",backgroundColor:"white"},onClick:()=>{s.cR({environment:g,onStart:()=>f(!0),bucket:"public",onError:e=>{r(e.message),f(!1)},onComplete:e=>{i(e[0]),f(!1)},accept:"image/*"})}},void 0,a()(l.FormattedMessage,{id:"formInputIcon.uploadButton.label",defaultMessage:"Upload image"}),m&&a()(u.Z,{style:{marginLeft:4}})))}},41750:(e,t,i)=>{i.d(t,{Z:()=>f});var r=i(77094),a=i.n(r),n=i(67294),o=i(8848),l=i(3779),s=i(82990),d=i(5366),u=i(91996),c=i(38381),p=i(64921),g=i(74194),m=i(97042);function f(e){window.__c="DeveloperIntegrationFormRegexRule";const{currentRule:t,onUpdate:i,shouldShowDelete:r,onDelete:l,onError:c}=e,{name:p,regex:f,attributes:b,sampleUrls:_}=t,[h,y]=n.useState(JSON.stringify(b,null,2));return a()("div",{style:{marginBottom:24}},void 0,a()("label",{},void 0,a()("div",{style:{fontSize:15,fontWeight:s.Z.fontWeight.regular,color:o.ZP.frontTextMedium}},void 0,a()(d.FormattedMessage,{id:"developerIntegrationForm.regexRule.name.label",defaultMessage:"Rule Name",description:"Label for the name input of the developer's pattern rule (e.g. github_pull)"})),a()(g.Z,{inputClassName:p,style:{background:o.ZP.white,height:32,fontSize:15},value:p,onChange:e=>{i({...t,name:e.target.value})},right:r&&a()(v,{onDelete:l})})),a()("label",{},void 0,a()("div",{style:{fontSize:15,fontWeight:s.Z.fontWeight.regular,color:o.ZP.frontTextMedium}},void 0,a()(d.FormattedMessage,{id:"developerIntegrationForm.sampleUrls.label",defaultMessage:"Sample URLs",description:"Label name for a field for sample URLs the developer wants to test their regexes on."})),a()(m.Z,{currentValue:_,setNewValue:e=>{i({...t,sampleUrls:e})},setErrorValue:e=>c(e),typeaheadTitle:a()(d.FormattedMessage,{id:"developerIntegrationsForm.urlsInput.typePrompt",defaultMessage:"Type or paste a urlâ€¦",description:"Prompt that appears as user adds urls to an input field."})})),a()("label",{},void 0,a()("div",{style:{fontSize:15,fontWeight:s.Z.fontWeight.regular,color:o.ZP.frontTextMedium}},void 0,a()(d.FormattedMessage,{id:"developerIntegrationForm.regexRule.pattern.label",defaultMessage:"Pattern",description:"Label for the regex input of the developer's regex pattern rule."})),a()(g.Z,{style:{background:o.ZP.white,fontSize:15},autosize:!0,textarea:!0,value:f,onChange:e=>{i({...t,regex:e.target.value})}})),a()("label",{},void 0,a()("div",{style:{fontSize:15,fontWeight:s.Z.fontWeight.regular,color:o.ZP.frontTextMedium}},void 0,a()(d.FormattedMessage,{id:"developerIntegrationForm.regexRule.attributes.label",defaultMessage:"Attributes",description:"Label for the attributes input of the developer's attribute JSON definition."})),a()(g.Z,{format:g.B.ExtraLarge,style:{backgroundColor:o.ZP.white},inputStyle:{fontSize:14,lineHeight:"18px",height:200,fontFamily:s.Z.baseFontFamily.mono,padding:4},textarea:!0,value:h,onChange:e=>{const r=e.target.value;y(r);const n=(0,u.Jv)(r);void 0===n?c(a()(d.FormattedMessage,{id:"developerIntegrationForm.jsonEditor.error",defaultMessage:"{value} attributes has invalid JSON.",description:"Error message returned to a developer when their payload is invalid.",values:{value:p}})):i({...t,attributes:n})}})))}function v(e){let{onDelete:t}=e;return window.__c="Trash",a()(p.Z,{style:{padding:4,borderRadius:3},onClick:()=>{c.Z.setState({open:!0,isDestructive:!1,isWarning:!0,title:a()(d.FormattedMessage,{id:"developerIntegrationFormRegexRule.deletionModal.title",defaultMessage:"Are you sure you want to delete this regex pattern rule?",description:"Confirmation modal message developer receives when trying to delete a Link Preview regex pattern rule."}),message:a()(d.FormattedMessage,{id:"developerIntegrationFormRegexRule.deletionModal.message",defaultMessage:"Changes will not be saved until you submit the form.",description:"Help message show in confirmation modal when developer tries to delete a Link Preview regex pattern rule."}),confirmationMessage:a()(d.FormattedMessage,{id:"developerIntegrationFormRegexRule.deletionModal.confirm",defaultMessage:"Delete",description:"Confirmation message shown in modal when developer tries to delete a Link Preview regex pattern rule."}),onConfirm:()=>{t()}})}},void 0,l.Z.trash({width:15,height:15}))}},79500:(e,t,i)=>{i.d(t,{T:()=>c,e:()=>m});var r=i(77094),a=i.n(r),n=i(67294),o=i(16489),l=i(24405),s=i(82990),d=i(12982),u=i(89728);function c(e){window.__c="DeveloperIntegrationFormSectionSidebar";const{supportedPages:t,selectedPage:i,setSelectedPage:r,integrationFormStore:n}=e,l=(0,o.VK)((()=>null==n?void 0:n.getState().type),[n]),s=i||t[0],u=e=>{(0,d.mP)(e)&&r&&r(e)};return a()("div",{style:b},void 0,t.map((e=>{const t=function(e,t,i){if(e!==t||!i)return!1;const r="linkPreview"===e&&"update-guest-integration"!==i;return"distribution"===e&&"update-bot"!==i||r}(s,e,l);return a()("div",{},e,a()(g,{highlightedSelection:s,currentSelection:{key:d.vb[e].key,title:d.vb[e].title},handleOnClick:u}),t&&a()(p,{currentPage:e,formStateType:l}))})))}function p(e){window.__c="DeveloperIntegrationFormSidebarSection";const{currentPage:t,formStateType:i}=e,r=d.vb[t].subsections,[o,s]=n.useState(),u=o||r[0].key,c=(0,l.yK)((()=>({sectionContainer:{marginLeft:20}})),[]),p=e=>{if((0,d.mP)(e))return;const t=document.getElementById((0,d.bK)(e));t&&(t.scrollIntoView(),s(e))};return a()("div",{style:c.sectionContainer},void 0,r.map((e=>a()(g,{currentSelection:e,highlightedSelection:u,handleOnClick:p,formStateType:i},e.key))))}function g(e){window.__c="DeveloperIntegrationFormSidebarButton";const{currentSelection:{key:t,title:i},highlightedSelection:r,handleOnClick:n,formStateType:o}=e,d="create-third-party-external-integration"===o&&"unfurling"===t,c=(0,l.yK)((e=>({sidebarButton:{...v,color:e.sidebarTextColor,...r===t&&{color:e.regularTextColor,fontWeight:s.Z.fontWeight.medium}}})),[t,r]);return a()(u.Z,{style:c.sidebarButton,onClick:()=>n(t),disabled:d,disabledFeedback:!0},void 0,i)}function m(e){window.__c="DeveloperIntegrationFormSectionHeader";const{section:t}=e,{title:i,subtitle:r,key:n}=t,o=(0,l.yK)((e=>({titleStyle:{...f},subtitleStyle:{fontSize:15,color:e.lightTextColor}})),[]);return a()("div",{style:o.titleStyle,id:(0,d.bK)(n)},void 0,i,r&&a()("div",{style:o.subtitleStyle},void 0,r))}const f={fontSize:30,marginTop:24,marginBottom:24,fontWeight:s.Z.fontWeight.bold},v={fontSize:15,height:28,marginTop:4,width:"100%"},b={display:"grid",gridTemplate:"none | auto | auto",marginTop:24,position:"sticky",top:16}},78397:(e,t,i)=>{i.d(t,{Z:()=>m});var r=i(97464),a=i.n(r),n=i(77094),o=i.n(n),l=i(67294),s=i(480),d=i(16489),u=i(38755),c=i(52275),p=i(31278),g=i(76798);const m=l.forwardRef(((e,t)=>{const{item:i,...r}=e,n=(0,s.O7)(),m=(0,d.VK)((()=>i&&(0,u.Wd)(n,i)),[n,i]),f=(0,d.VK)((()=>i&&(0,u.rn)(n,i)),[n,i]);return l.createElement(c.Z,a()({},r,{ref:t,title:i&&o()(g.Z,{store:i}),icon:i&&o()(p.Z,{disabled:!0,icon:m,title:f,isEmptyPage:!1,size:19})}))}))},87100:(e,t,i)=>{i.d(t,{Z:()=>Ve});var r=i(77094),a=i.n(r),n=i(96486),o=i(67294),l=i(480),s=i(16489),d=i(21202),u=i(97880),c=i(5366),p=i(92771),g=i(47307),m=i(43250),f=i(12982),v=i(33665),b=i(79315),_=i(3815),h=i(97464),y=i.n(h),x=i(33929),w=i(13991),M=i(24405),I=i(8848),S=i(84619),F=i(3779),k=i(74446),R=i(45953),C=i(89101),T=i(44312),Z=i(75246),D=i(82990),U=i(54642),V=i(42925),P=i(65270),L=i(38755),B=i(52507),E=i(64921),A=i(52275),z=i(12508),O=i(74194),N=i(32163),q=i(89728),K=i(72495),Y=i(58032),H=i(31850),j=i(95284);function W(e){window.__c="DeveloperIntegrationFormLabel";const{label:t,subtitle:i,caption:r,error:n,children:o,field:l,formStateType:s}=e,d=f.aP[l].requiredBy[s],u=(0,M.yK)((()=>({wrapper:{display:"flex"},label:{fontSize:15,fontWeight:D.Z.fontWeight.medium,color:I.ZP.frontTextMedium},required:{color:I.ZP.red,marginLeft:2},subtitle:{fontSize:15,color:I.ZP.frontTextLight},caption:{fontSize:15,color:I.ZP.frontTextLight},error:{marginTop:4,fontSize:15,color:I.ZP.frontRed},field:{display:"grid",gridTemplateColumns:"1fr",gap:6,marginBottom:32}})),[]);return a()("div",{style:u.field},void 0,a()("header",{style:u.wrapper},void 0,a()("div",{style:u.label},void 0,t),d&&a()("div",{style:u.required},void 0,"*")),r&&a()("div",{style:u.caption},void 0,r),o,i&&a()("div",{style:u.subtitle},void 0,i),n&&a()("div",{style:u.error},void 0,n))}var $=i(41750),G=i(79500),J=i(78397),Q=i(55268),X=i(18499),ee=i(97042),te=i(51490),ie=i(42402),re=i(46978),ae=i(5478),ne=i(719);function oe(e){const{integrationFormStore:t,formData:i,setFormData:r,pageSections:n,fieldDetails:l}=e,d=(0,s.VK)((()=>t.getState()),[t]);return o.createElement(o.Fragment,null,n.map((e=>o.createElement(o.Fragment,null,a()("div",{style:{marginBottom:24}},e.key,a()(G.e,{section:e})),e.fields.map((e=>a()(le,{formData:i,setFormData:r,formStoreState:d,formFieldDetail:l,field:e},e)))))))}function le(e){window.__c="DeveloperIntegrationsFormFieldView";const{formData:t,setFormData:i,formStoreState:r,formFieldDetail:n,field:o}=e,l=(0,s.VK)((()=>b.default.state.currentUserRootStore),[]),d=(0,s.VK)((()=>l?l.getAdminSpaceStores():[]),[l]),{type:u}=r,{label:c,subtitle:p,caption:g}=n[o]??{},{supportedBy:m}=f.aP[o],v=se[o];return m[u]&&v?a()(W,{label:c,subtitle:p,caption:g,error:t[o].error,field:o,formStateType:u},o,a()(v,{autoFocus:Boolean("create-bot"===u&&"name"===o),spaces:d,currentValue:t[o].value,setErrorValue:e=>{i({field:o,error:e})},setNewValue:e=>{i({value:e,field:o})},formStoreState:r})):null}const se={name:de,icon:function(e){window.__c="IconUpload";const{currentValue:t,setNewValue:i,setErrorValue:r}=e;return a()(j.Z,{value:t,setValue:i,setError:r})},space:function(e){window.__c="SpacePicker";const{spaces:t,currentValue:i,setNewValue:r,setErrorValue:n}=e,[l,s]=o.useState(!1);return(0,o.useEffect)((()=>{l||0!==t.length||(s(!0),n(a()(c.FormattedMessage,{id:"developerIntegrationsForm.spacePicker.missingSpacesError",defaultMessage:"You are not an owner of any workspaces. Please <linktonotion>create a new one</linktonotion> or ask your workspace owner to update your access.",values:{linktonotion:e=>a()(ie.Z,{href:(0,v.UY)("guides.joinOrCreateWorkspace")},void 0,e)}})))}),[t,n,l]),a()(H.Z,{keyName:"space",items:t,value:i,setValue:r,renderMenuItem:e=>o.createElement(J.Z,e)})},token:function(e){const t=(0,l.O7)(),{currentValue:i,setErrorValue:r}=e,n=(0,s.VK)((()=>b.default.state.currentUserStore),[]),d=(0,s.VK)((()=>{if(!n||!i)return;if(i.value.parent_table!==Z.bx)return;const e=_.H2.createChildStore(n,{id:i.value.parent_id,table:i.value.parent_table});return(0,L.rn)(t,e)}),[n,i,t]);if(!i)return null;return o.createElement(o.Fragment,null,a()(Q.Z,{bot:i.value,onError:r}),d&&a()("div",{style:{fontSize:15,color:I.ZP.frontTextLight}},void 0,a()(c.FormattedMessage,{id:"developerIntegrationForm.botToken.subtitle",defaultMessage:"Only works with the <bold>{spaceName}</bold> workspace. To change workspace, <developertermslink>create another integration</developertermslink>.",values:{spaceName:d,bold:e=>a()("b",{},void 0,e),developertermslink:e=>a()(ie.Z,{href:C._j.myIntegrations},void 0,e)}})))},client_id:function(e){window.__c="ShowOAuthClientId";const{currentValue:t}=e,i=(0,l.O7)(),[r,n]=o.useState(!1),s=ge(r);if(!t)return null;const d=a()(c.FormattedMessage,r?{defaultMessage:"ID copied",id:"developerIntegrationsForm.clientIdCopied.tooltip"}:{defaultMessage:"Copy client ID",id:"developerIntegrationsForm.copyClientId.tooltip"});return a()(O.Z,{type:"text",disabled:!0,style:s.authInput,value:t.value.id,right:a()("div",{style:{display:"flex"}},void 0,a()("div",{style:s.authInputRight}),a()(Y.Z,{placement:Y.Z.Placement.Top,renderTooltip:()=>d,render:e=>o.createElement(E.Z,y()({onClick:e=>{e.preventDefault(),n(!0),setTimeout((()=>{n(!1)}),1500),V.RD({environment:i,stringValue:t.value.id,copiedMessage:V.tq.copiedLinkToClipboard})}},e,{style:s.authButton}),a()(c.FormattedMessage,r?{id:"developerIntegrationsForm.copiedId.label",defaultMessage:"Copied"}:{id:"developerIntegrationsForm.copyId.label",defaultMessage:"Copy"}))}))})},client_secret:function(e){window.__c="ShowOAuthClientSecret";const{currentValue:t,setErrorValue:i}=e;if(!t)return null;return a()(X.Z,{integration:t.value,onError:i})},authorization_url:function(e){window.__c="ShowAuthorizationURL";const{currentValue:t}=e,i=(0,l.O7)(),[r,n]=o.useState(!1),s=ge(r);if(!t)return null;const d=a()(c.FormattedMessage,r?{defaultMessage:"URL copied",id:"developerIntegrationsForm.authUrlCopied.tooltip",description:"A message that appears when a user has clicked a button to copy a URL"}:{defaultMessage:"Copy authorization URL",id:"developerIntegrationsForm.authUrlCopy.tooltip",description:"A message that tells the developer that clicking the button will copy a URL to the authorization page"});return a()(O.Z,{type:"text",disabled:!0,style:s.authInput,value:t,right:a()("div",{style:{display:"flex"}},void 0,a()("div",{style:s.authInputRight}),a()(Y.Z,{placement:Y.Z.Placement.Top,renderTooltip:()=>d,render:e=>o.createElement(E.Z,y()({onClick:e=>{e.preventDefault(),n(!0),setTimeout((()=>{n(!1)}),1500),V.RD({environment:i,stringValue:t,copiedMessage:V.tq.copiedLinkToClipboard})}},e,{style:s.authButton}),a()(c.FormattedMessage,r?{id:"developerIntegrationsForm.copiedAuthUrl.label",defaultMessage:"Copied",description:"After clicking this button, the URL will have been copied to the clipboard."}:{id:"developerIntegrationsForm.copyAuthUrl.label",defaultMessage:"Copy",description:"Clicking this button will copy the URL."}))}))})},capabilities:function(e){window.__c="CapabilitiesTypePicker";const{setNewValue:t,currentValue:i}=e,r={...f.fP,...i},l={no_user_capabilities:!1===r.read_user_without_email&&!1===r.read_user_with_email,read_user_without_email:!0===r.read_user_without_email&&!1===r.read_user_with_email,read_user_with_email:!0===r.read_user_with_email};return a()(N.Z,{type:N.i.Vertical,initialFocus:void 0,sections:n.compact([{key:"content_capabilities",items:["read_content","update_content","insert_content"].map((e=>ce(e,r,t))),render:e=>o.createElement(K.Z,y()({},e,{title:x.default.formatMessage(ue.content_capabilities_title)}))},{key:"comment_capabilities",items:["read_comment","insert_comment"].map((e=>ce(e,r,t))),render:e=>o.createElement(K.Z,y()({},e,{title:x.default.formatMessage(ue.comment_capabilities_title)}))},{key:"user_capabilities",items:["no_user_capabilities","read_user_without_email","read_user_with_email"].map((e=>((e,t,i,r)=>({key:e,action:()=>null,render:n=>{const l=t=>{t.preventDefault(),r({...i,read_user_without_email:"no_user_capabilities"!==e,read_user_with_email:"read_user_with_email"===e})};return o.createElement(A.Z,y()({},n,{title:x.default.formatMessage(ue[`${e}_title`]),caption:x.default.formatMessage(ue[`${e}_caption`]),icon:a()(re.Z,{isSelected:t}),key:e,onClick:l}))}}))(e,l[e],r,t))),render:e=>o.createElement(K.Z,y()({},e,{title:x.default.formatMessage(ue.user_capabilities_title)}))}])})},template_url:de,redirect_uris:function(e){return window.__c="RedirectUrisInput",o.createElement(ee.Z,y()({},e,{style:{color:I.ZP.frontTextMedium},typeaheadTitle:a()(c.FormattedMessage,{id:"developerIntegrationsForm.redirectUri.typePrompt",defaultMessage:"Type a redirect uriâ€¦"})}))},tagline:de,privacy_policy_url:de,terms_of_use_url:de,email:de,developer_name:de,website_url:de,unfurl_url:de,domain:function(e){const{currentValue:t,autoFocus:i,setNewValue:r,formStoreState:n,setErrorValue:s}=e,d=(0,l.O7)(),g=(0,c.useIntl)(),m=pe();if("update-third-party-external-integration"!==n.type&&"update-first-party-external-integration"!==n.type)return null;const{developmentDomain:f,verifiedDomains:v,domainVerifications:b}=t||{developmentDomain:"",verifiedDomains:[],domainVerifications:[]},_=v.map((e=>({domain:e,status:ae.YF.Success,data:{type:"verified",domain:e}}))),h=Date.now(),y=b.filter(B.AS).sort(((e,t)=>e.createdAt-t.createdAt)).map((e=>({domain:e.domain,status:h>e.expiresAt?ae.YF.Failure:ae.YF.Pending,data:{...e,type:h>e.expiresAt?"invalid":"unverified"}}))),x=n.startingRecord.value.id;async function w(){const e=await U.getIntegrationDomainVerifications(d,{integrationId:x});if("success"===e.type){const t=R.Ak.create(e.data.recordMap),i=k.mF.fromRecordMapWithRole(t),a=e.data.verificationIds.map((e=>i({table:T.Jd,id:e}))).filter(u.$K).map(B.Hs).filter((e=>"verified"!==e.type));r({developmentDomain:f,verifiedDomains:v,domainVerifications:a})}}if("update-third-party-external-integration"===n.type)return a()(te.ZP,{domains:[..._,...y],domainVerificationStore:n.domainVerificationStore,verificationType:"integration",verificationTargetId:x,refreshDomains:w,onRemoveDomain:async function(e){if("verified"!==e.type){const t=await U.deleteDomainVerificationCode(d,{id:e.id});"failed"===t.type&&s(t.error.message),await w()}else p.QO({environment:d,integrationId:x,allVerifiedDomains:v,domainToRemove:e.domain})}});return o.createElement(o.Fragment,null,a()("div",{style:m.domainInputTitle},void 0,a()(c.FormattedMessage,{id:"developerIntegrationForm.domain.developmentDomain.label",defaultMessage:"Development domain",description:"Label for the development domain input of the user's integration. The domain only used by the integration in the development workspace."})),a()(O.Z,{autoFocus:i,style:m.basicTextInput,value:f,onChange:e=>r({verifiedDomains:v,domainVerifications:b,developmentDomain:e.target.value})}),a()("div",{style:m.domainInputTitle},void 0,a()(c.FormattedMessage,{id:"developerIntegrationForm.domain.verifiedDomains.label",defaultMessage:"Verified domain(s)",description:"Label for domain verification input of the user's integration. Includes modals that will go through adding and verifying a domain and the list of verified domains."})),a()(ne.Z,{placeholder:g.formatMessage({id:"domainVerificationInput.domainInput.placeholder",defaultMessage:"No domains configured",description:"Placeholder input for adding new domains."}),value:"",onChange:()=>{},onRemoveLastToken:()=>{},readOnly:!0,tokens:_.map((e=>{let{domain:t,status:i}=e;return a()(ae.ZP,{status:i,showRemoveButton:!1,isSingle:!1,format:S.l.Medium,value:t},t)}))}))},url_matching_and_placeholder:function(e){const{currentValue:t,setNewValue:i,setErrorValue:r}=e,n=pe();return o.createElement(o.Fragment,null,null==t?void 0:t.map(((e,n)=>a()($.Z,{currentRule:e,shouldShowDelete:0!==n,onUpdate:e=>{i([...t.slice(0,n),e,...t.slice(n+1)])},onDelete:()=>{0!==n&&i([...t.slice(0,n),...t.slice(n+1)])},onError:r},`regex-rule-${n}`))),a()(q.Z,{style:n.plainButton,isBlue:!0,onClick:e=>{e.preventDefault(),i([...t??[],P.VH])}},void 0,F.Z.plus(n.icon),a()(c.FormattedMessage,{id:"developerIntegrationsForm.regexPatternRulesInput.addMore.label",defaultMessage:"Add another rule",description:"A button in the 'URL matching and placeholder section. Developers can add multiple rules to match pasted URLs to their Link Preview integration."})))},external_oauth_authorize_url:de,external_oauth_token_url:de,external_client_id:de,external_client_secret:function(e){window.__c="HiddenTextInput";const{autoFocus:t,currentValue:i,setNewValue:r}=e,n=pe();return a()(O.Z,{type:"password",autoFocus:t,style:n.basicTextInput,value:i,onChange:e=>r(e.target.value)})},external_oauth_scopes:de,external_deletion_url:de};function de(e){window.__c="BasicTextInput";const{autoFocus:t,currentValue:i,setNewValue:r}=e,n=pe();return a()(O.Z,{autoFocus:t,style:n.basicTextInput,value:i,onChange:e=>r(e.target.value)})}const ue=(0,c.defineMessages)({read_comment_title:{id:"developerIntegrationForm.capabilities.read_comment.title",defaultMessage:"Read comments",description:"Label for a check box to enable an integration to read comments."},read_comment_caption:{id:"developerIntegrationForm.capabilities.read_comment.caption",defaultMessage:"Read comments on blocks and pages.",description:"Description for a check box to enable an integration to read comments."},insert_comment_title:{id:"developerIntegrationForm.capabilities.insert_comment.title",defaultMessage:"Insert comments",description:"Label for a check box to enable an integration to insert comments."},insert_comment_caption:{id:"developerIntegrationForm.capabilities.insert_comment.caption",defaultMessage:"Create comments on blocks and pages.",description:"Description for a check box to enable an integrations to insert comments."},comment_capabilities_title:{id:"developerIntegrationForm.capabilities.comment_capabilities.title",defaultMessage:"Comment Capabilities",description:"Header for a section where a developer can configure comment access for an integration."},content_capabilities_title:{id:"developerIntegrationForm.capabilities.content_capabilities.headerTitle",defaultMessage:"Content Capabilities",description:"Header for a section where a developer can configure content access for an integration."},user_capabilities_title:{id:"developerIntegrationForm.capabilities.user_capabilities.headerTitle",defaultMessage:"User Capabilities",description:"Header for a section where a developer can configure user access for an integration."},read_content_title:{id:"developerIntegrationForm.capabilities.read_content.title",defaultMessage:"Read content"},read_content_caption:{id:"developerIntegrationForm.capabilities.read_content.caption",defaultMessage:"Request to read content."},update_content_title:{id:"developerIntegrationForm.capabilities.update_content.title",defaultMessage:"Update content"},update_content_caption:{id:"developerIntegrationForm.capabilities.update_content.caption",defaultMessage:"Request to update existing content."},insert_content_title:{id:"developerIntegrationForm.capabilities.insert_content.title",defaultMessage:"Insert content"},insert_content_caption:{id:"developerIntegrationForm.capabilities.insert_content.caption",defaultMessage:"Request to create new content."},no_user_capabilities_title:{id:"developerIntegrationForm.capabilities.no_user_capabilities.title",defaultMessage:"No user information"},no_user_capabilities_caption:{id:"developerIntegrationForm.capabilities.no_user_capabilities.caption",defaultMessage:"Do not request any user information access."},read_user_without_email_title:{id:"developerIntegrationForm.capabilities.read_user_without_email.title",defaultMessage:"Read user information without email addresses"},read_user_without_email_caption:{id:"developerIntegrationForm.capabilities.read_user_without_email.caption",defaultMessage:"Request access to user information, not including email addresses."},read_user_with_email_title:{id:"developerIntegrationForm.capabilities.read_user_with_email.title",defaultMessage:"Read user information including email addresses"},read_user_with_email_caption:{id:"developerIntegrationForm.capabilities.read_user_with_email.caption",defaultMessage:"Request access to user information, including email addresses."}}),ce=(e,t,i)=>({key:e,action:()=>null,render:r=>{const n=r=>{r.preventDefault(),i({...t,[e]:!t[e]})};return o.createElement(A.Z,y()({},r,{title:x.default.formatMessage(ue[`${e}_title`]),caption:x.default.formatMessage(ue[`${e}_caption`]),icon:a()(z.Z,{checked:Boolean(t[e]),size:16,onClick:n}),key:e,onClick:n}))}});function pe(){return(0,M.yK)((()=>({basicTextInput:{background:I.ZP.white,height:32,fontSize:15},domainInputTitle:{marginTop:15,fontSize:15,fontWeight:D.Z.fontWeight.regular,color:I.ZP.frontTextMedium},plainButton:{display:"flex",alignItems:"center"},icon:{width:15,height:15}})),[])}function ge(e){return(0,M.yK)((()=>({authInput:{color:I.ZP.frontTextMedium,fontFamily:D.Z.getCompositeFontFamily(w.SP).mono},authInputRight:{width:30,marginLeft:-30,height:24,backgroundImage:"linear-gradient(to left, #f7f7f3 20%, rgba(255, 255, 255, 0) 100%)",zIndex:1},authButton:{display:"inline-flex",alignItems:"center",borderRadius:3,padding:"0 6px",height:24,color:e?I.ZP.frontTextMedium:I.ZP.blue,fontFamily:D.Z.getCompositeFontFamily(w.SP).sans}})),[e])}const me=[{key:"basic",title:x.default.formatMessage(f.sY.basicSectionTitle),fields:["name","icon","space"]}],fe={name:{label:x.default.formatMessage(f.sY.nameLabel),subtitle:x.default.formatMessage(f.sY.nameSubtitle)},icon:{label:x.default.formatMessage(f.sY.iconLabel),subtitle:x.default.formatMessage(f.sY.iconSubtitle)},space:{label:x.default.formatMessage(f.sY.spaceLabel),subtitle:x.default.formatMessage(f.sY.spaceSubtitle)}};const ve=[{key:"capabilities",title:x.default.formatMessage(f.sY.capabilitiesSectionTitle),fields:["capabilities"]}],be={capabilities:{label:x.default.formatMessage(f.sY.capabilitiesLabel),caption:a()(c.FormattedMessage,{id:"developerIntegrationForm.capabilities.caption",defaultMessage:"These requested capabilities will be displayed to users when they authorize your integration. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:e=>a()(ie.Z,{href:"https://developers.notion.com/docs/authorization"},void 0,e)}})}};var _e=i(24006);function he(e){const{label:t,subtitle:i,onClick:r,isDisabled:n,isActive:l}=e,s=(0,M.yK)((e=>({label:{fontSize:15,color:e.lightTextColor,display:"flex",justifyContent:"space-between"},subtitle:{fontSize:15,color:e.lightTextColor,paddingTop:15}})),[]);return o.createElement(o.Fragment,null,a()("div",{style:s.label},void 0,t,a()(_e.Z,{onClick:r,on:l,disabled:n})),a()("div",{style:s.subtitle},void 0,i))}const ye=[{key:"organization",title:x.default.formatMessage(f.sY.organizationSectionTitle),fields:["developer_name","website_url","tagline","privacy_policy_url","terms_of_use_url","email"]},{key:"oauth",title:x.default.formatMessage(f.sY.oauthSectionTitle),fields:["redirect_uris","template_url"]}],xe={redirect_uris:{label:x.default.formatMessage(f.sY.redirectUrisLabel),subtitle:x.default.formatMessage(f.sY.redirectUrisSubtitle)},website_url:{label:x.default.formatMessage(f.sY.websiteUrlLabel),subtitle:x.default.formatMessage(f.sY.websiteUrlSubtitle)},tagline:{label:x.default.formatMessage(f.sY.taglineLabel),subtitle:x.default.formatMessage(f.sY.taglineSubtitle)},privacy_policy_url:{label:x.default.formatMessage(f.sY.privacyPolicyUrlLabel),subtitle:x.default.formatMessage(f.sY.privacyPolicyUrlSubtitle)},terms_of_use_url:{label:x.default.formatMessage(f.sY.termOfUseLabel),subtitle:x.default.formatMessage(f.sY.termOfUseSubtitle)},template_url:{label:x.default.formatMessage(f.sY.templateLabel),subtitle:x.default.formatMessage(f.sY.templateSubtitle)},email:{label:x.default.formatMessage(f.sY.emailLabel),subtitle:x.default.formatMessage(f.sY.emailSubtitle)},developer_name:{label:x.default.formatMessage(f.sY.developerNameLabel),subtitle:x.default.formatMessage(f.sY.developerNameSubtitle)}};var we=i(38381),Me=i(97122);const Ie=(0,c.defineMessages)({confirmTitle:{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.title",defaultMessage:"Switch to Public integration?"},confirmContinue:{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.confirm",defaultMessage:"Continue"},confirmCapability:{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.title",defaultMessage:"Change requested capabilities?"},confirmCapabilityMessage:{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.message",defaultMessage:"Any existing users of your integration will be required to re-authenticate."},confirmCapabilitySubmit:{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.confirm",defaultMessage:"Change"},submitButtonCreate:{id:"formHandler.submitButton.create.label",defaultMessage:"Submit"},submitButtonUpdate:{id:"formHandler.submitButton.create.update",defaultMessage:"Save changes"},submitButtonContinue:{id:"formHandler.submitButton.continue.label",defaultMessage:"Continue",description:"Continue button when users are creating new external integration"}});function Se(e){window.__c="DeveloperIntegrationFormHandler";const{onSubmit:t,children:i,submitType:r,currentPage:n,capabilitiesHaveChanged:o}=e,l=(0,f.hs)(n,r),s=("update-guest-integration"===r||"update-third-party-external-integration"===r)&&o,d=Re();return a()("form",{id:"developer-integration-form",style:d.formContainerStyle,onSubmit:e=>{e.preventDefault(),"create-guest-integration"===r?we.Z.setState({open:!0,isDestructive:!1,isWarning:!1,title:x.default.formatMessage(Ie.confirmTitle),message:a()(c.FormattedMessage,{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.message",defaultMessage:"Youâ€˜ll get an OAuth secret and will need to implement OAuth for authorization. See <oauthdocumentationlink>developer docs</oauthdocumentationlink> for more information.",values:{oauthdocumentationlink:e=>a()(ie.Z,{href:C._j.developerOAuthDocs},void 0,e)}}),confirmationMessage:x.default.formatMessage(Ie.confirmContinue),onConfirm:()=>{t()}}):s?we.Z.setState({open:!0,isDestructive:!1,isWarning:!0,title:x.default.formatMessage(Ie.confirmCapability),message:x.default.formatMessage(Ie.confirmCapabilityMessage),confirmationMessage:x.default.formatMessage(Ie.confirmCapabilitySubmit),onConfirm:()=>{t()}}):t()}},void 0,i,l&&a()(Fe,{submitType:r}))}function Fe(e){window.__c="FormButton";const{submitType:t}=e,i=(0,f.oX)(t),r=(0,f.w8)(t),n=Re();return a()("div",{style:n.buttonContainerStyle},void 0,a()(Me.h,{onClick:()=>{const e=document.querySelector("form#developer-integration-form");if(e){const t=e.ownerDocument.createElement("input");t.style.display="none",t.type="submit",e.appendChild(t).click(),e.removeChild(t)}}},void 0,a()(ke,{submitType:t})),i&&a()("span",{style:n.buttonLabelStyle},void 0,a()(c.FormattedMessage,{id:"developerIntegrationFormHandler.create.developerTermsOnSubmit",defaultMessage:"By {action}, you agree to Notion's <developertermslink>Developer Terms</developertermslink>.",values:{developertermslink:e=>a()(ie.Z,{href:C._j.developerTerms},void 0,e),action:r?"continuing":"submitting"},description:"Subtitle that provides link to developer terms on submit"})))}function ke(e){const{submitType:t}=e,i=(0,f.oX)(t),r=(0,f.w8)(t),n=Re();if(!i)return o.createElement(o.Fragment,null,x.default.formatMessage(Ie.submitButtonUpdate));const l=r?"submitButtonContinue":"submitButtonCreate";return o.createElement(o.Fragment,null,a()("div",{style:{marginRight:4}},void 0,x.default.formatMessage(Ie[l])),F.Z.arrowRight(n.icon))}function Re(){return(0,M.yK)((()=>({buttonContainerStyle:{display:"flex",marginTop:24,flexDirection:"row-reverse",alignItems:"center"},buttonLabelStyle:{fontSize:15,color:I.ZP.frontTextLight,marginRight:42},formContainerStyle:{minWidth:200,maxWidth:440,marginLeft:24,display:"flex",flexDirection:"column"},icon:{width:14,height:14}})),[])}const Ce=[{key:"secrets",title:x.default.formatMessage(f.sY.secretSectionTitle),fields:["token","client_id","client_secret","authorization_url"]}],Te={token:{label:x.default.formatMessage(f.sY.tokenLabel)},client_id:{label:x.default.formatMessage(f.sY.clientIdLabel)},client_secret:{label:x.default.formatMessage(f.sY.clientSecretLabel)},authorization_url:{label:x.default.formatMessage(f.sY.authorizationUrlLabel)}};var Ze=i(9844);const De={key:"external_oauth",title:x.default.formatMessage(f.sY.externalOauthSectionTitle),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.sectionSubtitle.external_oauth",defaultMessage:"See the <textlink>official IETF spec</textlink> for information on OAuth 2.0.",values:{textlink:e=>a()(ie.Z,{href:"https://datatracker.ietf.org/doc/html/rfc6749",external:!0},void 0,e)}}),fields:["icon","external_oauth_authorize_url","external_oauth_token_url","external_client_id","external_client_secret","external_oauth_scopes","external_deletion_url"]};const Ue={icon:{label:x.default.formatMessage(f.sY.iconLabel),subtitle:x.default.formatMessage(f.sY.iconSubtitle)},unfurl_url:{label:x.default.formatMessage(f.sY.unfurlUrlLabel),caption:x.default.formatMessage(f.sY.unfurlUrlCaption)},domain:{label:x.default.formatMessage(f.sY.domainLabel),caption:a()(c.FormattedMessage,{id:"developerIntegrationForm.domainVerification.caption",defaultMessage:"Development and verified domains for URLs to unfurl with this integration. Domains must be verified before publishing to users. See the <textlink>Notion documentation</textlink> for more verification process.",description:"Description of the domain field for integrations and the domain verification process.",values:{textlink:e=>a()(ie.Z,{href:"https://developers.notion.com/docs/building-a-link-preview#domain-verification",external:!0},void 0,e)}})},url_matching_and_placeholder:{label:x.default.formatMessage(f.sY.urlMatchingAndPlaceholderLabel),caption:x.default.formatMessage(f.sY.urlMatchingAndPlaceholderCaption)},external_oauth_authorize_url:{label:x.default.formatMessage(f.sY.externalOauthAuthorizeUrlLabel),caption:x.default.formatMessage(f.sY.externalOauthAuthorizeUrlCaption)},external_oauth_token_url:{label:x.default.formatMessage(f.sY.externalOauthTokenUrlLabel),caption:x.default.formatMessage(f.sY.externalOauthTokenUrlCaption)},external_oauth_scopes:{label:x.default.formatMessage(f.sY.externalOauthScopesLabel),caption:x.default.formatMessage(f.sY.externalOauthScopesCaption)},external_client_id:{label:x.default.formatMessage(f.sY.externalClientIdLabel)},external_client_secret:{label:x.default.formatMessage(f.sY.externalClientSecretLabel)},external_deletion_url:{label:x.default.formatMessage(f.sY.externalDeletionUrlLabel),caption:x.default.formatMessage(f.sY.externalDeletionUrlCaption)}};function Ve(e){var t;window.__c="DeveloperIntegrationForm";const{integrationFormStore:i,onCreateNew:r,currentPage:h,setSelectedPage:y}=e,x=(0,l.O7)(),w=(0,s.VK)((()=>b.default.state.currentUserRootStore),[]),M=(0,s.VK)((()=>i.getState()),[i]),{type:I}=M,[S,F]=o.useReducer(f.x6,f.yb);(0,o.useEffect)((()=>{if(!w)return;(async()=>{const e=await(0,f.hl)({formStoreState:M,userRootStore:w,environment:x});for(const t of(0,u.Yd)(e))F({field:t,value:e[t]})})()}),[M,w,x]);const k=n.debounce((async()=>{const e=(0,f.m0)({formData:S,setFormData:F,formStateType:I,currentFieldNames:Le(h)});let t;if(S.template_url.value){const e=(0,v.K2)(S.template_url.value);w&&e&&(t=_.G.createChildStore(w,{table:d.iU,id:e}),await t.load())}const i=(0,f.Z6)({formData:S,setFormData:F,formStateType:I,templateStore:t,currentFieldNames:Le(h)});if(e.length>0||i.length>0||(0,f.tm)({formData:S,formStateType:I,currentFieldNames:Le(h)})||!w)return;const n=p.JJ({environment:x,formState:M,formData:(0,f.Xr)(S)});if(!n)return void g.showErrorMessage(a()(c.FormattedMessage,{id:"developerIntegrationsForm.error.submission",defaultMessage:"There was an error submitting your integration. Please try again or contact support if the issue persists."}));if(r&&r(n),(0,f.w8)(I))return;(0,f.oX)(I)&&y&&y("secrets");const o=document.querySelector(`.${m.rIs}`);o&&o.scrollIntoView({behavior:"smooth"})}),300),R=function(e,t){if(!t||!e)return!1;return(0,u.qP)(t).some((t=>{let[i,r]=t;return Boolean(e[i])!==r}))}(null===(t=M.startingRecord)||void 0===t?void 0:t.value.capabilities,S.capabilities.value),C=Pe[h];return a()(Se,{submitType:I,onSubmit:k,capabilitiesHaveChanged:R,currentPage:h},void 0,a()(C,{integrationFormStore:i,formData:S,setFormData:F}))}const Pe={distribution:function(e){const{integrationFormStore:t}=e,i=(0,s.VK)((()=>t.getState().type),[t]),r=["update-guest-integration","update-third-party-external-integration","update-first-party-external-integration","create-third-party-external-integration"].includes(i),n="update-bot"!==i,[l,d]=(0,o.useState)(n);return o.createElement(o.Fragment,null,a()(he,{onClick:()=>{const e=l?"internal":"public";d(!l),t.updateRecordTypeOnSwitch(e)},label:x.default.formatMessage(f.sY.distributionSwitcherLabel),subtitle:x.default.formatMessage(f.sY.distributionSwitcherSubtitle),isActive:l,isDisabled:r}),l&&o.createElement(oe,y()({},e,{pageSections:ye,fieldDetails:xe})))},linkPreview:function(e){const{integrationFormStore:t}=e,i=(0,s.VK)((()=>t.getState().type),[t]),r=(0,s.VK)((()=>{var e;return null===(e=t.getState().startingRecord)||void 0===e?void 0:e.value.id}),[t]),n="update-third-party-external-integration"===i,l="create-third-party-external-integration"===i||"update-third-party-external-integration"===i,[d,u]=(0,o.useState)(l),g="create-third-party-external-integration"===i?[De]:[De,(m=r,{key:"unfurling",title:x.default.formatMessage(f.sY.unfurlingSectionTitle),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.sectionCaption.unfurling",defaultMessage:"Visit the <previewlab>Link Preview Lab</previewlab> to plan out unfurling previews and responses.",values:{previewlab:e=>{if(!m)return"";const t=p.Pk({table:Ze.K2,id:m});return a()(ie.Z,{href:t,external:!0},void 0,e)}}}),fields:["unfurl_url","domain","url_matching_and_placeholder"]})];var m;return o.createElement(o.Fragment,null,a()(he,{onClick:()=>{const e=d?"public":"unfurling";u(!d),t.updateRecordTypeOnSwitch(e)},label:x.default.formatMessage(f.sY.unfurlingSwitcherLabel),subtitle:x.default.formatMessage(f.sY.unfurlingSwitcherSubtitle),isActive:d,isDisabled:n}),d&&o.createElement(oe,y()({},e,{pageSections:g,fieldDetails:Ue})))},secrets:function(e){return window.__c="DeveloperIntegrationFormSecretsView",o.createElement(oe,y()({},e,{pageSections:Ce,fieldDetails:Te}))},capabilities:function(e){return window.__c="DeveloperIntegrationFormCapabilitiesView",o.createElement(oe,y()({},e,{pageSections:ve,fieldDetails:be}))},basic:function(e){return window.__c="DeveloperIntegrationFormBasicView",o.createElement(oe,y()({},e,{pageSections:me,fieldDetails:fe}))}};function Le(e){switch(e){case"basic":return(0,f.Qo)(me);case"secrets":return(0,f.Qo)(Ce);case"capabilities":return(0,f.Qo)(ve);case"distribution":return(0,f.Qo)(ye);case"linkPreview":return["icon","external_oauth_authorize_url","external_oauth_token_url","external_client_id","external_client_secret","external_oauth_scopes","external_deletion_url","unfurl_url","domain","url_matching_and_placeholder"];default:return[]}}},87886:(e,t,i)=>{i.r(t),i.d(t,{LinkPreviewLab:()=>ie,default:()=>te});var r=i(97464),a=i.n(r),n=i(77094),o=i.n(n),l=i(67294),s=i(480),d=i(16489),u=i(24405),c=i(63123),p=i(3779),g=i(74181),m=i(89602),f=i(70203),v=i(97880),b=i(82990),_=i(44876),h=i(36054),y=i(5366),x=i(84823),w=i(43250),M=i(91996),I=i(65270),S=i(87279),F=i(79315),k=i(61766),R=i(30874),C=i(3403),T=i(64921),Z=i(52275),D=i(31945),U=i(74194),V=i(78140),P=i(32163),L=i(63296),B=i(72495),E=i(29823),A=i(97812),z=i(76745),O=i(67206),N=i(17970),q=i(34958),K=i(14577),Y=i(20475),H=i(8848),j=i(77744),W=i(58032),$=i(64369);i(29551);function G(e){window.__c="Artboard";const[t,i]=(0,l.useState)(!1);return o()("div",{onMouseEnter:()=>{i(!0)},onMouseLeave:()=>{i(!1)}},void 0,o()(J,{isInverted:e.isInverted},void 0,o()(Q,{showSize:e.showSize??t,showInsets:e.showInsets??t,insetSize:24},void 0,o()(ee,{isInverted:e.isInverted},void 0,e.children))))}function J(e){window.__c="ArtboardBorder";const t=(0,u.Fg)(),i=X(),r=e.isInverted?i:t,a=(0,l.useMemo)((()=>({borderRadius:3,overflow:"hidden",border:`1px solid ${r.regularDividerColor}`,backgroundColor:r.contentBackground,marginTop:12,marginBottom:12,color:r.regularTextColor})),[r]);return o()("div",{style:a},void 0,e.children)}function Q(e){window.__c="ArtboardInsets";const{showInsets:t,showSize:i,insetSize:r,children:a}=e,n=(0,l.useRef)(null),s=(0,u.yK)((e=>{const i=t?"rgba(255, 105, 180, 1)":"rgba(255, 105, 180, 0)",a=`1px dashed ${i}`,n=`${r}px`,o="all 0.1s ease-in-out",l={t:{borderBottom:a,transition:o},l:{borderRight:a,transition:o},r:{borderLeft:a,transition:o},b:{borderTop:a,transition:o,position:"relative"}};return{grid:{display:"grid",gridTemplateColumns:`${n} auto ${n}`,gridTemplateRows:`${n} auto ${n}`,...l.t,...l.l,...l.r,...l.b},...l,tl:{...l.t,...l.l},tr:{...l.t,...l.r},bl:{...l.b,...l.l},br:{...l.b,...l.r},c:{position:"relative"},insetText:{color:i,fontSize:10,paddingLeft:(r-10)/2,fontFamily:b.Z.baseFontFamily.githubMono,lineHeight:n,maxHeight:r,transition:o,position:"absolute"}}}),[t,r]);return o()("div",{style:s.grid},void 0,o()("div",{style:s.tl}),o()("div",{style:s.t}),o()("div",{style:s.tr}),o()("div",{style:s.l}),l.createElement("div",{style:s.c,ref:n},a),o()(W.Z,{forceVisibleState:i??t,renderTooltip:()=>{var e;return`${null===(e=n.current)||void 0===e?void 0:e.getBoundingClientRect().height}px`},placement:W.Z.Placement.Right,render:()=>o()("div",{style:s.r})}),o()("div",{style:s.bl}),o()(W.Z,{placement:W.Z.Placement.Bottom,forceVisibleState:i??t,renderTooltip:()=>{var e;return`${null===(e=n.current)||void 0===e?void 0:e.getBoundingClientRect().width}px`},render:()=>o()("div",{style:s.b},void 0,o()($.Z,{style:s.insetText},void 0,`${r}px inset`))}),o()("div",{style:s.br}))}function X(){const{mode:e}=(0,u.Fg)();return(0,H.gh)({theme:"light"===e?"dark":"light"})}function ee(e){let{children:t,isInverted:i}=e;window.__c="InverseThemeProvider";const{mode:r}=X(),a=function(e){const t=(0,s.O7)();return(0,l.useMemo)((()=>{const i=new Y.Z;return i.setState({mode:e}),{...t,ThemeStore:i,ThemeModeStore:new K.Z((()=>i.state.mode))}}),[t,e])}(r);return i?o()(q.EnvironmentContextProvider,{value:a},void 0,t):(0,j.jD)(t)}function te(e){window.__c="DeveloperIntegrationLab";const t=(0,s.O7)(),{integrationPointer:i}=e,r=(0,d.VK)((()=>F.default.state.currentUserStore),[]),a=(0,d.VK)((()=>{if(r)return r.getRecordValue(i)}),[r,i]),n=(0,c.V)({value:a,waitTimeInMs:5e3});return"pending"===n.status?o()(C.Z,{}):"rejected"!==n.status&&(0,g.VM)(n.value)?o()(A.Z,{className:w.hEP,title:o()(y.FormattedMessage,{id:"developerIntegrationLab.title.label",defaultMessage:"Link Preview Lab"}),subtitle:o()(y.FormattedMessage,{id:"developerIntegrationLab.subtitle.label",defaultMessage:"Plan out preview URL regex patterns and API responses."}),onNavigateBack:()=>x.V2(t,i),navigateBackMessage:o()(y.FormattedMessage,{id:"developerIntegrationLab.navigateBack.label",defaultMessage:"Back to integration"}),innerContainerStyles:{width:1200,margin:"auto",marginBottom:200}},void 0,o()(ie,{starterIntegration:n.value})):o()(E.Z,{})}function ie(e){let{starterIntegration:t}=e;window.__c="LinkPreviewLab";const[i,r]=l.useState(""),[a,n]=l.useState(I.Az),[s,d]=l.useState(I.SV),[u,c]=l.useState(I.VR()),[p,g]=l.useState(I.nZ),[m,f]=l.useState(I.e_),[v,b]=l.useState(I.P4),[h,y]=l.useState(t);return l.useEffect((()=>{const{original_url_domains:e,development_url_domains:i,original_url_patterns:r}=t.info,a=(null==e?void 0:e[0])||(null==i?void 0:i[0]);if(a&&g(a),null!=r&&r[0]){const{regex:e,attributes:t}=null==r?void 0:r[0];f(e);const i=t.map(_.Ah);b(i)}}),[t]),l.useEffect((()=>{y((e=>I.Hx({domain:p,regex:m,attributes:v,currentIntegration:e})))}),[p,m,v]),l.useEffect((()=>{R.Z.setState({loaded:!0,loading:!1,spaceId:I.C,integrations:[h],externalAuthentications:[],bots:[],completeSlackAuthentications:[]})}),[h]),o()("div",{style:{display:"flex",justifyContent:"space-between"}},void 0,o()(re,{style:{flex:1,marginRight:12},setErrorMessage:r,rootUrl:a,setRootUrl:n,relatedUrisToAttributes:u,setRelatedUrisToAttributes:c,domain:p,setDomain:g,regexPattern:m,setRegexPattern:f,regexAttributes:v,setRegexAttributes:b,rootAttributes:s,setRootAttributes:d}),o()(oe,{style:{flex:1},rootUrl:a,rootAttributes:s,relatedUrisToAttributes:u,integration:h,errorMessage:i}))}function re(e){window.__c="ConfigurationInput";const{style:t,rootUrl:i,setRootUrl:r,domain:a,setDomain:n,regexPattern:l,setRegexPattern:s,regexAttributes:u,setRegexAttributes:c,rootAttributes:p,setRootAttributes:g,relatedUrisToAttributes:f,setRelatedUrisToAttributes:v,setErrorMessage:_}=e,h=(0,d.VK)((()=>I.TG(p)),[p]);return o()("div",{style:t},void 0,o()("label",{},void 0,o()("div",{style:{fontSize:15,fontWeight:b.Z.fontWeight.medium}},void 0,o()(y.FormattedMessage,{id:"developerIntegrationLab.rootUrl.label",defaultMessage:"Pasted URL to Preview",description:"A url that the developers can test their integrations against as if a user attempted to unfurl it themselves."})),o()(U.Z,{value:i,onChange:e=>r(e.target.value)})),o()(le,{title:o()(y.FormattedMessage,{id:"developerIntegrationLab.regexConfiguration.label",defaultMessage:"Manage Regex Configuration",description:"Allows developers to test out regular expressions to match pasted unfurled urls."}),style:{marginTop:12}},void 0,o()("label",{style:{marginTop:12}},void 0,o()("div",{style:{fontSize:15,fontWeight:b.Z.fontWeight.medium}},void 0,o()(y.FormattedMessage,{id:"developerIntegrationLab.domain.label",defaultMessage:"Domain",description:"The domain of their integration (e.g. 'notion.so')."})),o()(U.Z,{value:a,onChange:e=>n(e.target.value)})),o()(de,{regexPattern:l,setRegexPattern:s,setErrorMessage:_}),o()("label",{style:{marginTop:12}},void 0,o()("div",{style:{fontSize:15,fontWeight:b.Z.fontWeight.medium}},void 0,o()(y.FormattedMessage,{id:"developerIntegrationLab.regexAttributes.label",defaultMessage:"Regex Attributes",description:"The matched attributes within their configuredregex patterns."})),o()(se,{value:u,onChange:c,validationType:m.$1,setErrorMessage:_}))),o()(le,{title:o()(y.FormattedMessage,{id:"developerIntegrationLab.rootAttributes.label",defaultMessage:"Unfurl response payload",description:"Allows developers to test their unfurl responses against our validator and visualizer."}),style:{marginTop:12}},void 0,o()(se,{value:p,onChange:g,validationType:m.$1,setErrorMessage:_})),o()(le,{title:o()(y.FormattedMessage,{id:"developerIntegrationLab.relatedAttributes.label",defaultMessage:"Related unfurl response payloads",description:"Allows developers to test additional unfurl responses against our validator and visualizer."}),style:{marginTop:12}},void 0,h.map((e=>{const t=f[e];return o()(le,{title:e,style:{marginTop:12,marginLeft:12}},e,t?o()(se,{value:t,onChange:t=>{v({...f,[e]:t})},validationType:m.$1,setErrorMessage:_}):o()(y.FormattedMessage,{id:"developerIntegrationLab.relatedAttributes.empty",defaultMessage:"No related attributes found."}))}))))}const ae=["preview","mention","hover"],ne=["authenticate","error","update","loaded"];function oe(e){window.__c="ConfigurationOutput";const{style:t,rootUrl:i,rootAttributes:r,relatedUrisToAttributes:a,integration:n,errorMessage:s}=e,[d,u]=l.useState("preview"),[c,p]=l.useState("loaded");return o()("div",{style:t},void 0,o()("div",{style:{display:"flex",alignItems:"center"}},void 0,o()("div",{style:{marginRight:12}},void 0,"Preview type:"),o()(ue,{title:d,options:ae,onSelectOption:e=>u(e)}),o()("div",{style:{marginLeft:12,marginRight:12}},void 0,"Preview state:"),o()(ue,{title:c,options:ne,onSelectOption:e=>p(e)})),o()("div",{style:{marginTop:12,maxWidth:600}},void 0,o()(ce,{previewType:d,previewState:c,rootUrl:i,rootAttributes:r,relatedUrisToAttributes:a,integration:n,errorMessage:s})))}function le(e){window.__c="Toggle";const[t,i]=l.useState(!1);return o()("div",{style:e.style},void 0,o()(T.Z,{onClick:()=>i(!t),style:{display:"flex",alignItems:"center"}},void 0,p.Z.triangle({width:"0.6875em",height:"0.6875em",transition:"transform 200ms ease-out",transform:`rotateZ(${t?180:90}deg)`,marginRight:4}),e.title),t&&e.children)}function se(e){window.__c="JSONEditor";const{value:t,onChange:i,validationType:r,setErrorMessage:a}=e,[n,s]=l.useState(JSON.stringify(t,null,2));return o()(U.Z,{format:U.B.ExtraLarge,inputStyle:{fontSize:14,lineHeight:"18px",height:500},textarea:!0,value:n,onChange:e=>{const t=e.target.value;s(t);const n=M.Jv(t);if(void 0===n)a("Could not parse JSON object input.");else{const e=(0,h.Gu)(r,n);e?a(e.message):(a(""),i(n))}}})}function de(e){window.__c="RegexInput";const{regexPattern:t,setRegexPattern:i,setErrorMessage:r}=e,[a,n]=l.useState(t);return o()("label",{style:{marginTop:12}},void 0,o()("div",{style:{fontSize:15,fontWeight:b.Z.fontWeight.medium}},void 0,"Regex Pattern"),o()(U.Z,{value:a,onChange:e=>{const t=e.target.value;n(t);try{new RegExp(t);i(t),r("")}catch(a){r("Invalid Regex.")}}}))}function ue(e){window.__c="PreviewDropdownButton";const{title:t,options:i,onSelectOption:r}=e,[n,s,u]=(0,d.AF)(void 0,k.Z);return o()(D.Z,{popupType:D.Z.PopupType.Popup,buttonPopupStore:u,renderOrigin:()=>o()(L.Z,{onClick:()=>s({...n,open:!0})},void 0,t,p.Z.chevronDown({width:10,marginTop:4,marginLeft:4})),render:()=>o()(V.Z,{menuType:S.og.Popup},void 0,o()(P.Z,{type:P.i.Vertical,sections:[{key:t,items:i.map((e=>({key:e,action:()=>{r(e),s({...n,open:!1})},render:t=>l.createElement(Z.Z,a()({},t,{title:e}))}))),render:e=>l.createElement(B.Z,e)}],initialFocus:void 0}))})}function ce(e){const{previewType:t,previewState:i,rootUrl:r,rootAttributes:a,relatedUrisToAttributes:n,integration:d,errorMessage:c}=e,[p,g]=l.useState(""),m=(0,s.O7)(),[f,v]=l.useState();l.useEffect((()=>{const e=I.rn({environment:m,rootUrl:r,rootAttributes:a,relatedUrisToAttributes:n,integration:d});"error"in e?g(e.error):(g(""),v(e))}),[m,r,a,n,d]),l.useEffect((()=>{g(c)}),[c]);const b=(0,u.yK)((e=>({error:{marginTop:12,marginBottom:12,padding:"12px 24px",marginRight:"auto",backgroundColor:e.accentColors.red[100]}})),[]);return l.createElement(l.Fragment,null,p&&o()("div",{style:b.error},void 0,p," "),f&&l.createElement(l.Fragment,null,o()(G,{isInverted:!1,showInsets:!1,showSize:!1},void 0,o()(ge,{previewType:t,previewState:i,previewStores:f})),o()(G,{isInverted:!0,showInsets:!1,showSize:!1},void 0,o()(ge,{previewType:t,previewState:i,previewStores:f}))))}function pe(e){window.__c="RenderedHoverPreview";const{previewStores:t}=e,i=(0,u.yK)((e=>({container:{borderRadius:4,boxShadow:e.lightBoxShadow}})),[]),r=(0,d.VK)((()=>{const e=t.previewBlockStore.id;if(!e)return;return{annotation:(0,f.x3)(e),store:t.inlineBlockStore,token:void 0}}),[t.previewBlockStore,t.inlineBlockStore]);return r?o()("div",{style:i.container},void 0,o()(O.D,{isHoveredTokenEditable:!0,state:r})):null}function ge(e){const{previewType:t,previewState:i,previewStores:r}=e;return"preview"===t?o()(z.Z,{store:"authenticate"===i?r.emptyInstanceBlockStore:r.previewBlockStore,disabled:!1,forceActionForUIDoc:"loaded"===i?void 0:i}):"mention"===t?o()(N.Z,{store:"authenticate"===i?r.emptyInlineBlockStore:r.inlineBlockStore,disabled:!1}):"hover"===t?l.createElement(pe,e):void(0,v.t1)(t)}},29823:(e,t,i)=>{i.d(t,{Z:()=>c});var r=i(77094),a=i.n(r),n=(i(67294),i(480)),o=i(3779),l=i(5366),s=i(84823),d=i(43250),u=i(97812);function c(){window.__c="DeveloperIntegrationNotFound";const e=(0,n.O7)();return a()(u.Z,{className:d.wG0,title:a()(l.FormattedMessage,{id:"developerIntegrationNotFound.title.label",defaultMessage:"Not Found"}),subtitle:a()(l.FormattedMessage,{id:"developerIntegrationNotFound.subtitle.label",defaultMessage:"This integration doesnâ€™t exist."}),onNavigateBack:()=>s.A1(e),icon:o.Z.eyes({width:98,height:98}),sideContent:null},void 0,null)}},55268:(e,t,i)=>{i.d(t,{Z:()=>b});var r=i(77094),a=i.n(r),n=i(67294),o=i(13991),l=i(480),s=i(8848),d=i(77420),u=i(82990),c=i(5366),p=i(50906),g=i(54642),m=i(38381),f=i(64921),v=i(41550);function b(e){window.__c="DeveloperIntegrationShowBotToken";const{onError:t,bot:i}=e,r=(0,l.O7)(),o=i.id,[s,u]=n.useState(),b=n.useCallback((async()=>{const e=await g.getBotToken(r,{botId:o});var i;"success"===e.type?(p.trackDeveloperIntegrationsViewSecret(r,{table:d.cZ}),u(e.data.token)):t((null===(i=e.body)||void 0===i?void 0:i.message)??"Error fetching bot token.")}),[r,o,t]),h=n.useCallback((async()=>{const e=await g.revokeBotToken(r,{botId:o});return"success"===e.type?{success:!0}:(t((null===(i=e.body)||void 0===i?void 0:i.message)??"Error revoking bot token."),{success:!1});var i}),[r,o,t]);return a()(v.Z,{secret:s,secretName:a()(c.FormattedMessage,{id:"developerIntegrationForm.botToken.secretName",defaultMessage:"token"}),onCopy:()=>{p.trackDeveloperIntegrationsCopySecret(r,{table:d.cZ,from:"developer-integrations-view"})},actionButtons:n.createElement(n.Fragment,null,a()(f.Z,{onClick:()=>{!function(e){const{onConfirm:t}=e;m.Z.setState({isDestructive:!1,isWarning:!1,open:!0,onConfirm:t,title:a()(c.FormattedMessage,{id:"developerIntegrationForm.refreshBotToken.confirmationModal.title",defaultMessage:"Refresh token?",description:"Confirmation message asking the user if they want to refresh the bot token."}),message:a()(c.FormattedMessage,{id:"developerIntegrationForm.refreshBotToken.confirmationModal.message",defaultMessage:"Refreshing will revoke the existing token and generate a new one. Make sure youâ€™re storing the token securely.",description:"Message telling the user about what will happen if they agree to refresh."}),confirmationMessage:a()(c.FormattedMessage,{id:"developerIntegrationForm.refreshBotToken.confirmationModal.confirm",defaultMessage:"Continue",description:"Confirmation 'continue' button when asking user if t hey want to refresh their bot token."})})}({onConfirm:async()=>{(await h()).success&&await b()}})},style:_.button},void 0,a()(c.FormattedMessage,{id:"developerIntegrationShotBotToken.refreshSecret.label",defaultMessage:"Refresh",description:"Button in bot token input if user wants to refresh their token. Will revoke the old one and generate a new one."})),a()(f.Z,{onClick:()=>{b()},style:_.button},void 0,a()(c.FormattedMessage,{id:"developerIntegrationShotBotToken.showSecret.label",defaultMessage:"Show",description:"Button in bot token input if user wants to view their token."})))})}const _={button:{display:"inline-flex",alignItems:"center",fontFamily:u.Z.getCompositeFontFamily(o.SP).sans,borderRadius:3,padding:"0 6px",height:24,color:s.ZP.blue}}},18499:(e,t,i)=>{i.d(t,{Z:()=>x});var r=i(77094),a=i.n(r),n=i(67294),o=i(13991),l=i(480),s=i(16489),d=i(8848),u=i(9844),c=i(82990),p=i(5366),g=i(50906),m=i(54642),f=i(84823),v=i(79315),b=i(38381),_=i(3815),h=i(64921),y=i(41550);function x(e){window.__c="DeveloperIntegrationShowClientSecret";const{onError:t,integration:i}=e,r=(0,l.O7)(),[o,d]=n.useState(),c=i.id,h=i.info.has_viewed_secret,x=(0,s.VK)((()=>v.default.state.currentUserStore),[]),M=x?(0,_.Kv)(x,{id:c,table:u.K2}):void 0,I=n.useCallback((async()=>{if(!M)return;const e=await m.getIntegrationSecret(r,{integrationId:c});var i;"success"===e.type?(f.bO({environment:r,integrationStore:M}),g.trackDeveloperIntegrationsViewSecret(r,{table:u.K2}),d(e.data.secret)):t((null===(i=e.body)||void 0===i?void 0:i.message)??"Error fetching client secret.")}),[r,M,c,t]);return a()(y.Z,{secret:o,secretName:a()(p.FormattedMessage,{id:"developerIntegrationForm.integrationSecret.secretName",defaultMessage:"secret"}),onCopy:()=>{g.trackDeveloperIntegrationsCopySecret(r,{table:u.K2,from:"developer-integrations-view"})},actionButtons:a()(w,{onClick:()=>{!function(e){const{hasSecretBeenViewed:t,onConfirm:i}=e,r=a()(p.FormattedMessage,t?{id:"developerIntegrationForm.clientSecret.confirmationModal.refreshTitle",defaultMessage:"Refresh OAuth client secret?",description:"Confirmation message asking the user if they want to refresh the client secret."}:{id:"developerIntegrationForm.clientSecret.confirmationModal.showTitle",defaultMessage:"Show OAuth client secret?",description:"Confirmation message asking the user if they want to see the client secret."}),n=a()(p.FormattedMessage,t?{id:"developerIntegrationForm.clientSecret.confirmationModal.alreadyViewedMessage",defaultMessage:"Youâ€™ve already viewed the client secret. Viewing again will revoke and generate a new one. Make sure youâ€™re storing the secret securely.",description:"Message telling the user about the client secret."}:{id:"developerIntegrationForm.clientSecret.confirmationModal.displayOnceMessage",defaultMessage:"This client secret will only be displayed once and cannot be viewed again. Make sure youâ€™re storing the secret securely.",description:"Message telling the user that the client secret will only show once."});b.Z.setState({isDestructive:!1,isWarning:!1,open:!0,onConfirm:i,title:r,message:n,confirmationMessage:a()(p.FormattedMessage,{id:"developerIntegrationForm.clientSecret.confirmationModal.confirm",defaultMessage:"Continue"})})}({hasSecretBeenViewed:h,onConfirm:()=>{I()}})},hasSecretBeenViewed:h})})}function w(e){window.__c="ShowSecretButton";const{onClick:t,hasSecretBeenViewed:i}=e;return a()(h.Z,{onClick:t,style:M.button},void 0,a()(p.FormattedMessage,i?{id:"formSecretShow.refreshSecret.label",defaultMessage:"Refresh"}:{id:"formSecretShow.showSecret.label",defaultMessage:"Show"}))}const M={button:{display:"inline-flex",alignItems:"center",fontFamily:c.Z.getCompositeFontFamily(o.SP).sans,borderRadius:3,padding:"0 6px",height:24,color:d.ZP.blue}}},41550:(e,t,i)=>{i.d(t,{Z:()=>b});var r=i(97464),a=i.n(r),n=i(77094),o=i.n(n),l=i(67294),s=i(13991),d=i(480),u=i(8848),c=i(5366),p=i(82990),g=i(42925),m=i(64921),f=i(74194),v=i(58032);function b(e){window.__c="DeveloperIntegrationShowSecret";const{secret:t,secretName:i,onCopy:r,actionButtons:a}=e;return o()(f.Z,{type:t?"text":"password",disabled:!0,style:{fontFamily:p.Z.getCompositeFontFamily(s.SP).mono,color:u.ZP.frontTextMedium},inputStyle:t?{cursor:"text"}:void 0,value:t||" ".repeat(40),right:o()("div",{style:{display:"flex"}},void 0,o()("div",{style:{width:30,marginLeft:-30,height:24,backgroundImage:"linear-gradient(to left, #f7f7f3 20%, rgba(255, 255, 255, 0) 100%)",zIndex:1}}),t?o()(_,{onCopy:r,secret:t,secretName:i}):a)})}function _(e){window.__c="CopySecretButton";const{secretName:t,secret:i,onCopy:r}=e,n=(0,d.O7)(),[s,p]=l.useState(!1),f=l.useCallback((()=>{g.RD({environment:n,stringValue:i,copiedMessage:g.tq.copiedToClipboard}),r()}),[n,r,i]),b=o()(c.FormattedMessage,s?{defaultMessage:"{secretName} copied",id:"formSecretShow.secretCopied.tooltip",description:"Tooltip shown when user copied integration secret to clipboard",values:{secretName:t}}:{defaultMessage:"Copy {secretName}",id:"formSecretShow.copySecret.tooltip",description:"Shortcut for copying a token from an integration management page; 'secretName' will be either 'secret' or 'token'",values:{secretName:t}});return o()(v.Z,{placement:v.Z.Placement.Top,renderTooltip:()=>b,render:e=>l.createElement(m.Z,a()({onClick:e=>{e.preventDefault(),p(!0),setTimeout((()=>{p(!1)}),1500),f()}},e,{style:{...h.button,color:s?u.ZP.mediumTextColor:u.ZP.blue}}),o()(c.FormattedMessage,s?{id:"formSecretShow.copied.label",defaultMessage:"Copied"}:{id:"formSecretShow.copySecret.label",defaultMessage:"Copy"}))})}const h={button:{display:"inline-flex",alignItems:"center",fontFamily:p.Z.getCompositeFontFamily(s.SP).sans,borderRadius:3,padding:"0 6px",height:24,color:u.ZP.blue}}},59781:(e,t,i)=>{i.r(t),i.d(t,{default:()=>U});var r=i(77094),a=i.n(r),n=i(67294),o=i(480),l=i(16489),s=i(63123),d=i(15070),u=i(59054),c=i(39248),p=i(77420),g=i(44312),m=i(49953),f=i(9844),v=i(70043),b=i(97880),_=i(5366),h=i(50906),y=i(54642),x=i(84823),w=i(43250),M=i(79315),I=i(85227),S=i(3403),F=i(91754),k=i(31278),R=i(29823),C=i(97812),T=i(2805),Z=i(56200),D=i(42402);function U(e){window.__c="DeveloperIntegrationView";const{botOrIntegrationPointer:t}=e,i=(0,o.O7)(),r=(0,l.VK)((()=>M.default.state.currentUserStore),[]),[,,U]=(0,l.AF)(void 0,I.Z),V=(0,l.Kw)(U),P=(0,l.VK)((()=>{if(t&&r){const e=t.table,i=r.getRecordValue(t);if(i){const a=e===f.K2&&(0,d.Be)(i.capabilities)&&r.getRecordValue({table:m.r9,id:t.id});return{botOrIntegrationRecord:{value:i,table:t.table},maybeExternalAuthRecord:a?{table:m.r9,value:a}:void 0}}}}),[r,t]),[{value:L}]=(0,u.r5)((async()=>{if(!r||!P||P.botOrIntegrationRecord.table!==f.K2)return[];const e=P.botOrIntegrationRecord.value.id,t=await y.getIntegrationDomainVerifications(i,{integrationId:e});if("success"===t.type){return t.data.verificationIds.map((e=>r.getRecordValue({table:g.Jd,id:e}))).filter(b.$K)}if("failed"===t.type)throw t.error;return(0,b.t1)(t)}),[i,P,r]);(0,n.useEffect)((()=>{if(!P)return;const{botOrIntegrationRecord:e,maybeExternalAuthRecord:t}=P;U.initializeNewForm(e,t,L||[]),h.trackDeveloperIntegrationsViewVisit(i,{table:e.table})}),[U,i,P,L]);const B=(0,s.V)({value:V.startingRecord});if("rejected"===B.status||!t)return a()(R.Z,{});if("pending"===B.status)return a()(S.Z,{});"resolved"!==B.status&&(0,b.t1)(B);const E=B.value,A=E.value.name,z=E.table===p.cZ?E.value.icon:E.value.info.icon,O={id:E.value.id,table:E.table},N=z?{pointer:O,icon:z}:void 0;return a()(C.Z,{className:w.TFu,title:A,subtitle:a()(_.FormattedMessage,{id:"developerIntegrationView.subtitle.label",defaultMessage:"Review and edit integration information."}),onNavigateBack:()=>x.A1(i),icon:a()(k.Z,{disabled:!0,icon:N,title:A,isEmptyPage:!1,size:98,isLarge:!0,style:{boxShadow:v.Z.frontDeepShadow},useInvertedColors:!0}),sideContent:a()(Z.T,{integrationFormStore:U})},void 0,"published"===V.status&&a()(F.Z,{type:F.$.Red,isMobile:!1},void 0,a()(_.FormattedMessage,{id:"developerIntegrationView.publishedIntegrationWarning",defaultMessage:"As soon as you save changes to this page, your listing on Notion'sÂ <integrationgallerylink>Integration Gallery</integrationgallerylink>Â will be updated.",description:"A warning that appears to developers when they're editing an integration that has already been published in our Integration Gallery.",values:{integrationgallerylink:e=>a()(D.Z,{disableHover:!0,href:(0,c.E)(E.value.id,E.value.name||"")},void 0,e)}})),a()(T.Z,{integrationFormStore:U}))}},12265:(e,t,i)=>{i.r(t),i.d(t,{default:()=>D});var r=i(77094),a=i.n(r),n=i(67294),o=i(480),l=i(16489),s=i(63123),d=i(15070),u=i(59054),c=i(77420),p=i(44312),g=i(49953),m=i(9844),f=i(70043),v=i(97880),b=i(5366),_=i(50906),h=i(54642),y=i(92771),x=i(43250),w=i(70764),M=i(12982),I=i(79315),S=i(22230),F=i(3403),k=i(31278),R=i(79500),C=i(87100),T=i(29823),Z=i(97812);function D(e){window.__c="DeveloperIntegrationView";const{botOrIntegrationPointer:t}=e,i=(0,o.O7)(),r=(0,l.VK)((()=>I.default.state.currentUserRootStore),[]),D=(0,l.qz)(void 0,S.Z),U=(0,l.VK)((()=>D.getState().type),[D]),V=(0,l.VK)((()=>D.getState().startingRecord),[D]),P=(0,l.VK)((()=>{const e=(0,w.QS)();return(0,M.H)(U,e)}),[U]),[L,B]=(0,n.useState)("secrets"),E=(0,l.VK)((()=>{if(t&&r){const e=t.table,i=r.getRecordValue(t);if(i){const a=e===m.K2&&(0,d.Be)(i.capabilities)&&r.getRecordValue({table:g.r9,id:t.id});return{botOrIntegrationRecord:{value:i,table:t.table},maybeExternalAuthRecord:a?{table:g.r9,value:a}:void 0}}}}),[r,t]),[{value:A}]=(0,u.r5)((async()=>{if(!r||!E||E.botOrIntegrationRecord.table!==m.K2)return[];const e=E.botOrIntegrationRecord.value.id,t=await h.getIntegrationDomainVerifications(i,{integrationId:e});if("success"===t.type){return t.data.verificationIds.map((e=>r.getRecordValue({table:p.Jd,id:e}))).filter(v.$K)}if("failed"===t.type)throw t.error;return(0,v.t1)(t)}),[i,E,r]);(0,n.useEffect)((()=>{if(!E)return;const{botOrIntegrationRecord:e,maybeExternalAuthRecord:t}=E;D.initializeNewForm(e,t,A||[]),_.trackDeveloperIntegrationsViewVisit(i,{table:e.table})}),[D,i,E,A]);const z=(0,s.V)({value:V});if("rejected"===z.status||!t)return a()(T.Z,{});if("pending"===z.status)return a()(F.Z,{});const O=z.value,N=O.value.name,q=O.table===c.cZ?O.value.icon:O.value.info.icon,K={id:O.value.id,table:O.table},Y=q?{pointer:K,icon:q}:void 0;return a()(Z.Z,{className:x.TFu,title:N,subtitle:a()(b.FormattedMessage,{id:"developerIntegrationView.subtitle.label",defaultMessage:"Review and edit integration information."}),onNavigateBack:()=>y.A1(i),icon:a()(k.Z,{disabled:!0,icon:Y,title:N,isEmptyPage:!1,size:98,isLarge:!0,style:{boxShadow:f.Z.frontDeepShadow},useInvertedColors:!0}),sideContent:a()(R.T,{supportedPages:P,selectedPage:L,setSelectedPage:B,integrationFormStore:D})},void 0,a()(C.Z,{integrationFormStore:D,currentPage:L,setSelectedPage:B}))}},8871:(e,t,i)=>{i.r(t),i.d(t,{default:()=>p});var r=i(77094),a=i.n(r),n=(i(67294),i(16489)),o=i(5366),l=i(43250),s=i(85227),d=i(97812),u=i(2805),c=i(56200);function p(e){window.__c="DeveloperIntegrationsCreate";const{onClose:t,onSuccess:i}=e,[,,r]=(0,n.AF)(void 0,s.Z);return a()(d.Z,{className:l.Zp2,title:a()(o.FormattedMessage,{id:"developerIntegrationsCreateInternal.title.label",defaultMessage:"Create a new integration"}),subtitle:a()(o.FormattedMessage,{id:"developerIntegrationsCreateInternal.subtitle.label",defaultMessage:"Weâ€™ll walk you through how to setup a new integration."}),onNavigateBack:t,sideContent:a()(c.T,{integrationFormStore:r})},void 0,a()(u.Z,{onCreateNew:i,integrationFormStore:r,shouldAutoFocusFirstField:!0}))}},2805:(e,t,i)=>{i.d(t,{Z:()=>be});var r=i(97464),a=i.n(r),n=i(77094),o=i.n(n),l=i(96486),s=i(67294),d=i(13991),u=i(480),c=i(16489),p=i(8848),g=i(84619),m=i(3779),f=i(74446),v=i(45953),b=i(89101),_=i(21202),h=i(77420),y=i(44312),x=i(9844),w=i(75246),M=i(97880),I=i(82990),S=i(5366),F=i(50906),k=i(54642),R=i(42925),C=i(84823),T=i(47307),Z=i(43250),D=i(81710),U=i(65270),V=i(33665),P=i(38755),L=i(79315),B=i(52507),E=i(3815),A=i(64921),z=i(52275),O=i(12508),N=i(74194),q=i(32163),K=i(89728),Y=i(72495),H=i(58032),j=i(31850),W=i(38381),$=i(97122),G=i(42402);function J(e){window.__c="DeveloperIntegrationFormHandler";const{onSubmit:t,children:i,submitType:r,capabilitiesHaveChanged:a}=e,n="create-bot"===r||"create-guest-integration"===r||"create-third-party-external-integration"===r;return o()("form",{id:"developer-integration-form",style:{minWidth:200,maxWidth:440,marginLeft:24,display:"flex",flexDirection:"column"},onSubmit:e=>{e.preventDefault(),"create-guest-integration"===r?W.Z.setState({open:!0,isDestructive:!1,isWarning:!1,title:o()(S.FormattedMessage,{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.title",defaultMessage:"Switch to Public integration?"}),message:o()(S.FormattedMessage,{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.message",defaultMessage:"Youâ€˜ll get an OAuth secret and will need to implement OAuth for authorization. See <oauthdocumentationlink>developer docs</oauthdocumentationlink> for more information.",values:{oauthdocumentationlink:e=>o()(G.Z,{href:b._j.developerOAuthDocs},void 0,e)}}),confirmationMessage:o()(S.FormattedMessage,{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.confirm",defaultMessage:"Continue"}),onConfirm:()=>{t()}}):"update-guest-integration"===r&&a?W.Z.setState({open:!0,isDestructive:!1,isWarning:!0,title:o()(S.FormattedMessage,{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.title",defaultMessage:"Change requested capabilities?"}),message:o()(S.FormattedMessage,{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.message",defaultMessage:"Any existing users of your integration will be required to re-authenticate."}),confirmationMessage:o()(S.FormattedMessage,{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.confirm",defaultMessage:"Change"}),onConfirm:()=>{t()}}):t()}},void 0,i,o()("div",{style:{display:"flex",marginTop:24,flexDirection:"row-reverse",alignItems:"center"}},void 0,o()($.h,{onClick:()=>{const e=document.querySelector("form#developer-integration-form");if(e){const t=e.ownerDocument.createElement("input");t.style.display="none",t.type="submit",e.appendChild(t).click(),e.removeChild(t)}}},void 0,o()(Q,{isCreate:n})),n&&o()("span",{style:{fontSize:15,color:p.ZP.frontTextLight,marginRight:42}},void 0,o()(S.FormattedMessage,{id:"developerIntegrationFormHandler.create.developerTerms",defaultMessage:"By submitting, you agree to Notion's <developertermslink>Developer Terms</developertermslink>.",values:{developertermslink:e=>o()(G.Z,{href:b._j.developerTerms},void 0,e)}}))))}function Q(e){const{isCreate:t}=e;return t?s.createElement(s.Fragment,null,o()("div",{style:{marginRight:4}},void 0,o()(S.FormattedMessage,{id:"formHandler.submitButton.create.label",defaultMessage:"Submit"})),m.Z.arrowRight({width:14,height:14})):o()(S.FormattedMessage,{id:"formHandler.submitButton.create.update",defaultMessage:"Save changes"})}var X=i(95284),ee=i(24405);function te(e){window.__c="DeveloperIntegrationFormLabel";const{label:t,subtitle:i,caption:r,error:a,children:n}=e,l=(0,ee.yK)((()=>({label:{fontSize:15,fontWeight:I.Z.fontWeight.medium,color:p.ZP.frontTextMedium},subtitle:{fontSize:15,color:p.ZP.frontTextLight},caption:{fontSize:15,color:p.ZP.frontTextLight},error:{marginTop:4,fontSize:15,color:p.ZP.frontRed},field:{display:"grid",gridTemplateColumns:"1fr",gap:6,marginBottom:32}})),[]);return o()("div",{style:l.field},void 0,o()("header",{style:l.label},void 0,t),r&&o()("div",{style:l.caption},void 0,r),n,i&&o()("div",{style:l.subtitle},void 0,i),a&&o()("div",{style:l.error},void 0,a))}var ie=i(17293),re=i(63296),ae=i(64369);function ne(e){window.__c="DeveloperIntegrationFormRadioButtonInput";const{options:t,value:i,setValue:r}=e;return o()("div",{style:{display:"flex",flexDirection:"column"}},void 0,t.map(((e,a)=>o()(oe,{option:e,value:i,setValue:r,isFirst:0===a,isLast:a===t.length-1},e.key))))}function oe(e){window.__c="StyledRadioButton";const{option:t,value:i,setValue:r,isFirst:a,isLast:n}=e,l=(0,ee.yK)((e=>({outliner:{display:"flex",flexDirection:"column",alignItems:"flex-start",height:"auto",padding:18,whiteSpace:"normal",fontSize:15,background:e.whiteButtonBackground,borderTopLeftRadius:a?3:0,borderTopRightRadius:a?3:0,borderBottomLeftRadius:n?3:0,borderBottomRightRadius:n?3:0,...!a&&{borderTop:void 0}}})),[a,n]);return o()(re.Z,{onClick:()=>r(t.key),style:l.outliner},void 0,o()(ie.Z,{title:t.title,isSelected:i===t.key,onClick:()=>{},name:"developer-integration-form-radio-button-input"},t.key),o()(ae.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginLeft:24,marginTop:-4,fontSize:15}},void 0,t.caption))}var le=i(41750),se=i(78397),de=i(56200),ue=i(55268),ce=i(18499),pe=i(97042),ge=i(51490),me=i(46978),fe=i(5478),ve=i(719);function be(e){var t;window.__c="DeveloperIntegrationsForm";const{integrationFormStore:i,onCreateNew:r,shouldAutoFocusFirstField:a}=e,n=(0,S.useIntl)(),d=(0,u.O7)(),[{currentUserRootStore:p}]=(0,c.AF)(L.default),g=(0,c.Kw)(i),{type:m}=g,f=(0,c.VK)((()=>(0,D.fY)()),[]),v=(0,c.VK)((()=>(0,D.Le)(i.getState().startingRecord)),[i]),[b,h]=s.useReducer(D.x6,D.yb);(0,s.useEffect)((()=>{if(!p)return;(async()=>{const e=await(0,D.hl)({formStoreState:g,userRootStore:p,environment:d});for(const t of(0,M.Yd)(e))h({field:t,value:e[t]})})()}),[g,p,d]);const y=(0,c.VK)((()=>p?p.getAdminSpaceStores():[]),[p]),x=l.debounce((async()=>{const e=(0,D.Xk)({formData:b,formStateType:m});let t;if(e.forEach((e=>{h({field:e,error:o()(S.FormattedMessage,{id:"developerIntegrationsForm.error.missingRequired",defaultMessage:"{ fieldName } is required.",values:{fieldName:f[e].label}})})})),b.template_url.value){const e=(0,V.K2)(b.template_url.value);p&&e&&(t=E.G.createChildStore(p,{table:_.iU,id:e}),await t.load())}const i=(0,D.bd)({formData:b,formStateType:m,templateStore:t});i.forEach((e=>{h({field:e.fieldName,error:e.errorMessages?e.errorMessages.map(((e,t)=>{let{descriptor:i,values:r}=e;return o()("div",{},`validation-error-${t}`,n.formatMessage(i,r))})):o()(S.FormattedMessage,{id:"developerIntegrationsCreateInternal.error.invalidInput",defaultMessage:"{ fieldName } is invalid.",values:{fieldName:f[e.fieldName].label}})})}));if(e.length>0||i.length>0||(0,D.tm)({formData:b,formStateType:m})||!p)return;const a=C.JJ({environment:d,formState:g,formData:(0,D.Xr)(b)});if(!a)return void T.showErrorMessage(o()(S.FormattedMessage,{id:"developerIntegrationsForm.error.submission",defaultMessage:"There was an error submitting your integration. Please try again or contact support if the issue persists."}));r&&r(a);const l=document.querySelector(`.${Z.rIs}`);l&&l.scrollIntoView({behavior:"smooth"})}),300),w=function(e,t){if(e&&t)for(const[i,r]of(0,M.qP)(t))if(Boolean(e[i])!==r)return!0;return!1}(null===(t=g.startingRecord)||void 0===t?void 0:t.value.capabilities,b.capabilities.value);return o()(J,{submitType:m,onSubmit:x,capabilitiesHaveChanged:w},void 0,D.cW.map((e=>v[e].supportedBy[m]?o()("div",{style:{marginBottom:24}},e,o()(de.e,{keyName:e,integrationFormStore:i}),v[e].fields.map((e=>{const{supportedBy:t,label:r,subtitle:n,caption:l}=f[e];if(t[m]){const t=_e[e];return o()(te,{label:r,subtitle:n,caption:l,error:b[e].error},e,o()(t,{autoFocus:Boolean(a&&"name"===e),spaces:y,currentValue:b[e].value,setErrorValue:t=>{h({field:e,error:t})},setNewValue:t=>{"submission_type"!==e?"client_secret"!==e&&"token"!==e&&h({value:t,field:e}):i.updateRecordTypeOnSubmission(t)},formStoreState:g}))}return null}))):null)))}const _e={token:function(e){const{currentValue:t,setErrorValue:i}=e,r=(0,c.VK)((()=>L.default.state.currentUserStore),[]),a=(0,u.O7)(),n=(0,c.VK)((()=>{if(!r||!t)return;if(t.value.parent_table!==w.bx)return;const e=E.H2.createChildStore(r,{id:t.value.parent_id,table:t.value.parent_table});return(0,P.rn)(a,e)}),[r,t,a]);if(!t)return null;return s.createElement(s.Fragment,null,o()(ue.Z,{bot:t.value,onError:i}),n&&o()("div",{style:{fontSize:15,color:p.ZP.frontTextLight}},void 0,o()(S.FormattedMessage,{id:"developerIntegrationForm.botToken.subtitle",defaultMessage:"Only works with the <bold>{spaceName}</bold> workspace. To change workspace, <developertermslink>create another integration</developertermslink>.",values:{spaceName:n,bold:e=>o()("b",{},void 0,e),developertermslink:e=>o()(G.Z,{href:b._j.myIntegrations},void 0,e)}})))},client_id:function(e){window.__c="ShowOAuthClientId";const{currentValue:t}=e,i=(0,u.O7)(),[r,n]=s.useState(!1);if(!t)return null;const l=o()(S.FormattedMessage,r?{defaultMessage:"ID copied",id:"developerIntegrationsForm.clientIdCopied.tooltip"}:{defaultMessage:"Copy client ID",id:"developerIntegrationsForm.copyClientId.tooltip"});return o()(N.Z,{type:"text",disabled:!0,style:{color:p.ZP.frontTextMedium,fontFamily:I.Z.getCompositeFontFamily(d.SP).mono},value:t.value.id,right:o()("div",{style:{display:"flex"}},void 0,o()("div",{style:{width:30,marginLeft:-30,height:24,backgroundImage:"linear-gradient(to left, #f7f7f3 20%, rgba(255, 255, 255, 0) 100%)",zIndex:1}}),o()(H.Z,{placement:H.Z.Placement.Top,renderTooltip:()=>l,render:e=>s.createElement(A.Z,a()({onClick:e=>{e.preventDefault(),n(!0),setTimeout((()=>{n(!1)}),1500),R.RD({environment:i,stringValue:t.value.id,copiedMessage:R.tq.copiedLinkToClipboard})}},e,{style:{display:"inline-flex",alignItems:"center",borderRadius:3,padding:"0 6px",height:24,color:r?p.ZP.frontTextMedium:p.ZP.blue,fontFamily:I.Z.getCompositeFontFamily(d.SP).sans}}),o()(S.FormattedMessage,r?{id:"developerIntegrationsForm.copiedId.label",defaultMessage:"Copied"}:{id:"developerIntegrationsForm.copyId.label",defaultMessage:"Copy"}))}))})},client_secret:function(e){window.__c="ShowOAuthClientSecret";const{currentValue:t,setErrorValue:i}=e;if(!t)return null;return o()(ce.Z,{integration:t.value,onError:i})},authorization_url:function(e){window.__c="ShowAuthorizationURL";const{currentValue:t}=e,i=(0,u.O7)(),[r,n]=s.useState(!1);if(!t)return null;const l=o()(S.FormattedMessage,r?{defaultMessage:"URL copied",id:"developerIntegrationsForm.authUrlCopied.tooltip",description:"A message that appears when a user has clicked a button to copy a URL"}:{defaultMessage:"Copy authorization URL",id:"developerIntegrationsForm.authUrlCopy.tooltip",description:"A message that tells the developer that clicking the button will copy a URL to the authorization page"});return o()(N.Z,{type:"text",disabled:!0,style:{color:p.ZP.frontTextMedium,fontFamily:I.Z.getCompositeFontFamily(d.SP).mono},value:t,right:o()("div",{style:{display:"flex"}},void 0,o()("div",{style:{width:30,marginLeft:-30,height:24,backgroundImage:"linear-gradient(to left, #f7f7f3 20%, rgba(255, 255, 255, 0) 100%)",zIndex:1}}),o()(H.Z,{placement:H.Z.Placement.Top,renderTooltip:()=>l,render:e=>s.createElement(A.Z,a()({onClick:e=>{e.preventDefault(),n(!0),setTimeout((()=>{n(!1)}),1500),R.RD({environment:i,stringValue:t,copiedMessage:R.tq.copiedLinkToClipboard})}},e,{style:{display:"inline-flex",alignItems:"center",borderRadius:3,padding:"0 6px",height:24,color:r?p.ZP.frontTextMedium:p.ZP.blue,fontFamily:I.Z.getCompositeFontFamily(d.SP).sans}}),o()(S.FormattedMessage,r?{id:"developerIntegrationsForm.copiedAuthUrl.label",defaultMessage:"Copied",description:"After clicking this button, the URL will have been copied to the clipboard."}:{id:"developerIntegrationsForm.copyAuthUrl.label",defaultMessage:"Copy",description:"Clicking this button will copy the URL."}))}))})},name:he,icon:function(e){window.__c="IconUpload";const{currentValue:t,setNewValue:i,setErrorValue:r}=e;return o()(X.Z,{value:t,setValue:i,setError:r})},space:xe,developer_space:xe,submission_type:function(e){window.__c="SubmissionTypePicker";const{currentValue:t,setNewValue:i,formStoreState:r}=e,a=(0,u.O7)(),n="create-bot"===r.type||"create-third-party-external-integration"===r.type,l={internal:{title:o()(S.FormattedMessage,{id:"developerInternalIntegration.integrationType.internal.title",defaultMessage:"Internal integration"}),caption:o()(S.FormattedMessage,{id:"developerInternalIntegration.integrationType.internal.caption",defaultMessage:"Only available for workspaces youâ€™re an admin of. The integration can be installed to those workspaces automatically and does not require review. {createIntegrationCopy}",values:{createIntegrationCopy:n&&o()(S.FormattedMessage,{id:"developerInternalIntegration.integrationType.internal.caption.create",defaultMessage:"Select this option to later upgrade this to a public integration.",description:"If users want to create a public integration, they must select this option to create an internal integration first."})}})},public:{title:o()(S.FormattedMessage,{id:"developerInternalIntegration.integrationType.public.title",defaultMessage:"Public integration"}),caption:o()(S.FormattedMessage,{id:"developerInternalIntegration.integrationType.public.caption",defaultMessage:"Available for any Notion user. May require review and verification for listing in the Integration Gallery."})},unfurling:{title:o()(S.FormattedMessage,{id:"developerInternalIntegration.integrationType.unfurling.title",defaultMessage:"Link preview"}),caption:o()(S.FormattedMessage,{id:"developerInternalIntegration.integrationType.unfurling.caption",defaultMessage:"Available for any Notion user. May require review and verification for listing in the Integration Gallery."})}};if(!t)return null;let s;"update-bot"===r.type||"create-guest-integration"===r.type?s=[{...l.internal,key:"internal"},{...l.public,key:"public"}]:"create-bot"!==r.type&&"create-third-party-external-integration"!==r.type||(s=[{...l.internal,key:"internal"},{...l.unfurling,key:"unfurling"}]);if(!s)return null;return o()(ne,{options:s,value:t,setValue:e=>{i(e),F.trackDeveloperIntegrationsToggleType(a,{table:"internal"===e?h.cZ:x.K2})}})},template_url:he,redirect_uris:function(e){return window.__c="RedirectUrisInput",s.createElement(pe.Z,a()({},e,{typeaheadTitle:o()(S.FormattedMessage,{id:"developerIntegrationsForm.redirectUri.typePrompt",defaultMessage:"Type a redirect uriâ€¦"})}))},website_url:he,tagline:he,privacy_policy_url:he,terms_of_use_url:he,email:he,capabilities:function(e){window.__c="CapabilitiesTypePicker";const{setNewValue:t}=e,i={...D.fP,...e.currentValue};return o()(q.Z,{type:q.i.Vertical,initialFocus:void 0,sections:l.compact([{key:"content_capabilities",items:[{key:"read_content",action:()=>null,render:e=>{const r=e=>{e.preventDefault(),t({...i,read_content:!i.read_content})};return s.createElement(z.Z,a()({},e,{title:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_content.title",defaultMessage:"Read content"}),caption:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_content.caption",defaultMessage:"Request to read content."}),icon:o()(O.Z,{checked:Boolean(i.read_content),size:16,onClick:r}),onClick:r}))}},{key:"update_content",action:()=>null,render:e=>{const r=e=>{e.preventDefault(),t({...i,update_content:!i.update_content})};return s.createElement(z.Z,a()({},e,{title:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.update_content.title",defaultMessage:"Update content"}),caption:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.update_content.caption",defaultMessage:"Request to update existing content."}),icon:o()(O.Z,{checked:Boolean(i.update_content),size:16,onClick:r}),onClick:r}))}},{key:"insert_content",action:()=>null,render:e=>{const r=e=>{e.preventDefault(),t({...i,insert_content:!i.insert_content})};return s.createElement(z.Z,a()({},e,{title:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.insert_content.title",defaultMessage:"Insert content"}),caption:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.insert_content.caption",defaultMessage:"Request to create new content."}),icon:o()(O.Z,{checked:Boolean(i.insert_content),size:16,onClick:r}),onClick:r}))}}],render:e=>s.createElement(Y.Z,a()({},e,{title:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.content_capabilities.title",defaultMessage:"Content Capabilities"})}))},{key:"comment_capabilities",items:[{key:"read_comment",action:()=>null,render:e=>{const r=e=>{e.preventDefault(),t({...i,read_comment:!i.read_comment})};return s.createElement(z.Z,a()({},e,{title:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_comment.title",defaultMessage:"Read comments",description:"Label for a check box to enable an integration to read comments."}),caption:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_comment.caption",defaultMessage:"Read comments on blocks and pages.",description:"Description for a check box to enable an integration to read comments."}),icon:o()(O.Z,{checked:Boolean(i.read_comment),size:16,onClick:r}),onClick:r}))}},{key:"insert_comment",action:()=>null,render:e=>{const r=e=>{e.preventDefault(),t({...i,insert_comment:!i.insert_comment})};return s.createElement(z.Z,a()({},e,{title:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.insert_comment.title",defaultMessage:"Insert comments",description:"Label for a check box to enable an integration to insert comments."}),caption:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.insert_comment.caption",defaultMessage:"Create comments on blocks and pages.",description:"Description for a check box to enable an integrations to insert comments."}),icon:o()(O.Z,{checked:Boolean(i.insert_comment),size:16,onClick:r}),onClick:r}))}}],render:e=>s.createElement(Y.Z,a()({},e,{title:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.comment_capabilities.title",defaultMessage:"Comment Capabilities",description:"Header for a section where a developer can configure comment access for an integration."})}))},{key:"user_capabilities",items:[{key:"no_user_capabilities",action:()=>null,render:e=>s.createElement(z.Z,a()({},e,{title:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.no_user_capabilities.title",defaultMessage:"No user information"}),caption:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.no_user_capabilities.caption",defaultMessage:"Do not request any user information access."}),icon:o()(me.Z,{isSelected:!(i.read_user_without_email||i.read_user_with_email)}),onClick:e=>{e.preventDefault(),t({...i,read_user_without_email:!1,read_user_with_email:!1})}}))},{key:"read_user_without_email",action:()=>null,render:e=>s.createElement(z.Z,a()({},e,{title:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_user_without_email.title",defaultMessage:"Read user information without email addresses"}),caption:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_user_without_email.caption",defaultMessage:"Request access to user information, not including email addresses."}),icon:o()(me.Z,{isSelected:i.read_user_without_email&&!i.read_user_with_email}),onClick:e=>{e.preventDefault(),t({...i,read_user_without_email:!0,read_user_with_email:!1})}}))},{key:"read_user_with_email",action:()=>null,render:e=>s.createElement(z.Z,a()({},e,{title:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_user_with_email.title",defaultMessage:"Read user information including email addresses"}),caption:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_user_with_email.caption",defaultMessage:"Request access to user information, including email addresses."}),icon:o()(me.Z,{isSelected:i.read_user_with_email}),onClick:()=>{t({...i,read_user_without_email:!0,read_user_with_email:!0})}}))}],render:e=>s.createElement(Y.Z,a()({},e,{title:o()(S.FormattedMessage,{id:"developerIntegrationForm.capabilities.user_capabilities.title",defaultMessage:"User Capabilities"})}))}])})},developer_name:he,unfurl_url:he,domain:function(e){const{currentValue:t,autoFocus:i,setNewValue:r,formStoreState:a,setErrorValue:n}=e,l=(0,u.O7)(),d=(0,S.useIntl)();if("update-third-party-external-integration"!==a.type&&"update-first-party-external-integration"!==a.type)return null;const{developmentDomain:c,verifiedDomains:m,domainVerifications:b}=t||{developmentDomain:"",verifiedDomains:[],domainVerifications:[]},_=m.map((e=>({domain:e,status:fe.YF.Success,data:{type:"verified",domain:e}}))),h=Date.now(),x=b.filter(B.AS).sort(((e,t)=>e.createdAt-t.createdAt)).map((e=>{const t=h>e.expiresAt||Boolean(e.invalidatedAt);return{domain:e.domain,status:t?fe.YF.Failure:fe.YF.Pending,data:{...e,type:t?"invalid":"unverified"}}})),w=a.startingRecord.value.id,I=async()=>{const e=await k.getIntegrationDomainVerifications(l,{integrationId:w});if("success"===e.type){const t=v.Ak.create(e.data.recordMap),i=f.mF.fromRecordMapWithRole(t),a=e.data.verificationIds.map((e=>i({table:y.Jd,id:e}))).filter(M.$K).map(B.Hs).filter((e=>"verified"!==e.type));r({developmentDomain:c,verifiedDomains:m,domainVerifications:a})}},F=async e=>{if("verified"!==e.type){const t=await k.deleteDomainVerificationCode(l,{id:e.id});"failed"===t.type&&n(t.error.message),await I()}else C.QO({environment:l,integrationId:w,allVerifiedDomains:m,domainToRemove:e.domain})};if("update-third-party-external-integration"===a.type)return o()(ge.ZP,{domains:[..._,...x],domainVerificationStore:a.domainVerificationStore,verificationType:"integration",verificationTargetId:w,refreshDomains:I,onRemoveDomain:F});return s.createElement(s.Fragment,null,o()("div",{style:ye},void 0,o()(S.FormattedMessage,{id:"developerIntegrationForm.domain.developmentDomain.label",defaultMessage:"Development domain",description:"Label for the development domain input of the user's integration. The domain only used by the integration in the development workspace."})),o()(N.Z,{autoFocus:i,style:{background:p.ZP.white,height:32,fontSize:15},value:c,onChange:e=>r({verifiedDomains:m,domainVerifications:b,developmentDomain:e.target.value})}),o()("div",{style:ye},void 0,o()(S.FormattedMessage,{id:"developerIntegrationForm.domain.verifiedDomains.label",defaultMessage:"Verified domain(s)",description:"Label for domain verification input of the user's integration. Includes modals that will go through adding and verifying a domain and the list of verified domains."})),o()(ve.Z,{placeholder:d.formatMessage({id:"domainVerificationInput.domainInput.placeholder",defaultMessage:"No domains configured",description:"Placeholder input for adding new domains."}),value:"",onChange:()=>{},onRemoveLastToken:()=>{},readOnly:!0,tokens:_.map((e=>{let{domain:t,status:i}=e;return o()(fe.ZP,{status:i,showRemoveButton:!1,isSingle:!1,format:g.l.Medium,value:t},t)}))}))},url_matching_and_placeholder:function(e){const{currentValue:t,setNewValue:i,setErrorValue:r}=e;return s.createElement(s.Fragment,null,null==t?void 0:t.map(((e,a)=>o()(le.Z,{currentRule:e,shouldShowDelete:0!==a,onUpdate:e=>{i([...t.slice(0,a),e,...t.slice(a+1)])},onDelete:()=>{0!==a&&i([...t.slice(0,a),...t.slice(a+1)])},onError:r},`regex-rule-${a}`))),o()(K.Z,{style:{display:"flex",alignItems:"center"},isBlue:!0,onClick:e=>{e.preventDefault(),i([...t??[],U.VH])}},void 0,m.Z.plus({width:15,height:15}),o()(S.FormattedMessage,{id:"developerIntegrationsForm.regexPatternRulesInput.addMore.label",defaultMessage:"Add another rule",description:"A button in the 'URL matching and placeholder section. Developers can add multiple rules to match pasted URLs to their Link Preview integration."})))},external_oauth_authorize_url:he,external_oauth_token_url:he,external_client_id:he,external_client_secret:function(e){window.__c="HiddenTextInput";const{autoFocus:t,currentValue:i,setNewValue:r}=e;return o()(N.Z,{type:"password",autoFocus:t,style:{background:p.ZP.white,height:32,fontSize:15},value:i,onChange:e=>r(e.target.value)})},external_oauth_scopes:he,external_deletion_url:he};function he(e){window.__c="BasicTextInput";const{autoFocus:t,currentValue:i,setNewValue:r}=e;return o()(N.Z,{autoFocus:t,style:{background:p.ZP.white,height:32,fontSize:15},value:i,onChange:e=>r(e.target.value)})}const ye={marginTop:15,fontSize:15,fontWeight:I.Z.fontWeight.regular,color:p.ZP.frontTextMedium};function xe(e){window.__c="SpacePicker";const{spaces:t,currentValue:i,setNewValue:r,setErrorValue:a}=e,[n,l]=s.useState(!1);return(0,s.useEffect)((()=>{n||0!==t.length||(l(!0),a(o()(S.FormattedMessage,{id:"developerIntegrationsForm.spacePicker.missingSpacesError",defaultMessage:"You are not an owner of any workspaces. Please <linktonotion>create a new one</linktonotion> or ask your workspace owner to update your access.",values:{linktonotion:e=>o()(G.Z,{href:(0,V.UY)("guides.joinOrCreateWorkspace")},void 0,e)}})))}),[t,a,n]),o()(j.Z,{keyName:"space",items:t,value:i,setValue:r,renderMenuItem:e=>s.createElement(se.Z,e)})}},56200:(e,t,i)=>{i.d(t,{e:()=>p,T:()=>g});var r=i(77094),a=i.n(r),n=i(67294),o=i(16489),l=i(8848),s=i(82990),d=i(81710),u=i(89728);function c(e){return`developer-integration-section-header-${e}`}function p(e){window.__c="DeveloperIntegrationFormSectionHeader";const{keyName:t,integrationFormStore:i}=e,r=(0,o.VK)((()=>(0,d.Le)(i.getState().startingRecord)),[i]),{title:n,subtitle:u}=r[t];return a()("div",{id:c(t),style:{fontSize:30,fontWeight:s.Z.fontWeight.bold,marginTop:24,marginBottom:24}},void 0,n,u&&a()("div",{style:{fontSize:15,color:l.ZP.frontTextLight}},void 0,u))}function g(e){window.__c="DeveloperIntegrationFormSectionSidebar";const{integrationFormStore:t}=e,{type:i}=(0,o.Kw)(t),r=(0,o.VK)((()=>(0,d.Le)(t.getState().startingRecord)),[t]),p=d.cW.filter((e=>r[e].supportedBy[i])),[g,m]=n.useState(),f=g||p[0];return a()("div",{style:{display:"grid",gridTemplate:"none | auto | auto",marginTop:24,position:"sticky",top:16}},void 0,p.map((e=>a()("div",{},e,a()(u.Z,{style:{fontSize:15,height:28,marginTop:4,color:l.ZP.frontTextLight,width:"100%",...f===e&&{color:l.ZP.frontText,fontWeight:s.Z.fontWeight.medium}},onClick:()=>{const t=document.getElementById(c(e));t&&t.scrollIntoView(),m(e)}},void 0,r[e].title)))))}},97042:(e,t,i)=>{i.d(t,{Z:()=>y});var r=i(97464),a=i.n(r),n=i(77094),o=i.n(n),l=i(67294),s=i(8848),d=i(84619),u=i(74181),c=i(95477),p=i(87279),g=i(52275),m=i(78140),f=i(32163),v=i(44532),b=i(72495),_=i(85567),h=i(719);function y(e){window.__c="DeveloperIntegrationsUrlsInput";const{currentValue:t,setNewValue:i,typeaheadTitle:r,style:n}=e,y=t||[],[x,w]=l.useState(""),M=()=>w("");return o()(v.ZP,{popupType:v.ZP.PopupType.Popup,sameWidthAsOrigin:!0,open:x.length>0,onDismiss:M,origin:o()(h.Z,{style:{background:s.ZP.white,minHeight:32,fontSize:15},placeholder:"",value:x,onChange:e=>w(e.target.value),tokens:y.map(((e,t)=>o()(_.Z,{format:d.l.Medium,showRemoveButton:!0,isSingle:!1,shouldWrap:!0,value:e,style:n,onClickRemove:()=>{i(y.filter((t=>t!==e)))}},`${e}-${t}`))),onRemoveLastToken:()=>{y.length>0&&i(y.slice(0,y.length-1))}}),render:()=>{const e=x.trim(),t=(0,u.ue)(c.Z.domainBaseUrl,e).map((e=>({key:e,render:t=>l.createElement(g.Z,a()({},t,{title:e})),action:()=>{M(),i([...y,e])}})));return o()(m.Z,{menuType:p.og.Popup},void 0,o()(f.Z,{type:f.i.Vertical,initialFocus:0,sections:[{key:"valid-url-suggestion",items:t,render:e=>l.createElement(b.Z,a()({},e,{title:r}))}]}))}})}},81710:(e,t,i)=>{i.d(t,{cW:()=>S,Le:()=>F,fY:()=>k,yb:()=>C,x6:()=>T,hl:()=>D,Xk:()=>U,bd:()=>V,tm:()=>P,fP:()=>L,Xr:()=>A});var r=i(77094),a=i.n(r),n=(i(67294),i(33728)),o=i(21202),l=i(9844),s=i(75246),d=i(97880),u=i(44876),c=i(5366),p=i(84823),g=i(42402),m=i(95477),f=i(10161),v=i(81236),b=i(3815),_=i(71935),h=i(70764),y=i(43348),x=i(91996),w=i(65270),M=i(84210),I=i(33665);const S=["secrets","basic","oauth","organization","external_oauth","unfurling"];function F(e){return{secrets:{title:a()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.secrets",defaultMessage:"Secrets"}),supportedBy:{"create-bot":!1,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},fields:["token","client_id","client_secret","authorization_url"]},basic:{title:a()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.basic",defaultMessage:"Basic Information"}),supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},fields:["name","icon","space","developer_space","submission_type","capabilities"]},oauth:{title:a()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.oauth",defaultMessage:"OAuth Domain & URIs"}),supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},fields:["redirect_uris","developer_name","website_url","tagline","privacy_policy_url","terms_of_use_url","email","template_url"]},organization:{title:a()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.links",defaultMessage:"Organization Information"}),supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},fields:["developer_name","website_url","tagline","privacy_policy_url","terms_of_use_url","email"]},external_oauth:{title:a()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.external_oauth",defaultMessage:"External Authorization Setup"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.sectionSubtitle.external_oauth",defaultMessage:"See the <textlink>official IETF spec</textlink> for information on OAuth 2.0.",values:{textlink:e=>a()(g.Z,{href:"https://datatracker.ietf.org/doc/html/rfc6749",external:!0},void 0,e)}}),supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},fields:["external_oauth_authorize_url","external_oauth_token_url","external_client_id","external_client_secret","external_oauth_scopes","external_deletion_url"]},unfurling:{title:a()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.unfurling",defaultMessage:"Unfurling Domain & Patterns"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.sectionCaption.unfurling",defaultMessage:"Visit the <previewlab>Link Preview Lab</previewlab> to plan out unfurling previews and responses.",values:{previewlab:t=>{let i="";return(null==e?void 0:e.table)===l.K2&&(i=p.Pk({table:e.table,id:e.value.id})),a()(g.Z,{href:i,external:!0},void 0,t)}}}),supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},fields:["unfurl_url","domain","url_matching_and_placeholder"]}}}function k(){const e=(0,h.QS)(),t="on"===f.default.getEligibleGroup({experimentId:"oauth_template_duplication",defaultGroup:"control"});return{token:{supportedBy:{"create-bot":!1,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.botToken.label",defaultMessage:"Internal Integration Token"})},client_id:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.integrationClientId.label",defaultMessage:"OAuth client ID"})},client_secret:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.integrationSecret.label",defaultMessage:"OAuth client secret"})},authorization_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.integrationAuthUrl.label",defaultMessage:"Authorization URL",description:"Label in developer integration form for copying a URL that sends users to an authorization page"})},name:{supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.name.label",defaultMessage:"Name"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.name.subtitle",defaultMessage:"Name to identify your integration to users."})},icon:{supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.icon.label",defaultMessage:"Logo"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.icon.subtitle",defaultMessage:"512px x 512px in PNG format is recommended."})},space:{supportedBy:{"create-bot":!0,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!0,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.space.label",defaultMessage:"Associated workspace"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.space.subtitle",defaultMessage:"Select a workspace to install the integration to. You can upgrade the integration to use OAuth later."})},developer_space:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.developerSpace.label",defaultMessage:"Associated workspace"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.developerSpace.subtitle",defaultMessage:"Select a workspace to install the integration to for development. Once approved it will become available to all users."})},submission_type:{supportedBy:{"create-bot":e,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!1,"create-third-party-external-integration":e,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.submissionType.label",defaultMessage:"Integration type"})},redirect_uris:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.redirect_uris.label",defaultMessage:"Redirect URIs"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.redirect_uri.subtitle",defaultMessage:"In the Notion OAuth flow, users will be redirected to this path after they have authenticated with Notion. The path will be appended with the authorization code for access and must have a protocol. It canâ€™t contain URL fragments, relative paths or wildcards, and canâ€™t be a public IP address. It must also be included in the token request."})},website_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.website_url.label",defaultMessage:"Website or homepage"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.website_url.subtitle",defaultMessage:"Used to link to your integrationâ€™s website or homepage in your integration page and authentication screens."})},tagline:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.tagline.label",defaultMessage:"Tagline"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.tagline.subtitle",defaultMessage:"A short description of what the integration does."})},privacy_policy_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.privacy_policy_url.label",defaultMessage:"Privacy policy"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.privacy_policy_url.subtitle",defaultMessage:"Used to link to your integrationâ€™s privacy policy in your integration page and authentication screens."})},terms_of_use_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.terms_of_use_url.label",defaultMessage:"Terms of use"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.terms_of_use_url.subtitle",defaultMessage:"Used to link to your integrationâ€™s terms of use in your integration page and authentication screens."})},template_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":t,"update-guest-integration":t,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.template_url.label",defaultMessage:"Notion URL for optional template",description:"Label for text field where developers input a URL to a public Notion page"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.template_url.subtitle",defaultMessage:"Use this field if you'd like to offer a user a Notion page to duplicate into their workspace during OAuth. URL must be to a public Notion page.",description:"Explains what kind of URL is accepted by the 'Notion template' input field, found in the developer portal integration page."})},email:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.email.label",defaultMessage:"Support email"}),subtitle:a()(c.FormattedMessage,{id:"developerIntegrationForm.email.subtitle",defaultMessage:"Used to link to your integrationâ€™s support email in your integration page and authentication screens."})},capabilities:{supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.capabilities.label",defaultMessage:"Capabilities"}),caption:a()(c.FormattedMessage,{id:"developerIntegrationForm.capabilities.caption",defaultMessage:"These requested capabilities will be displayed to users when they authorize your integration. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:e=>a()(g.Z,{href:"https://developers.notion.com/docs/authorization"},void 0,e)}})},developer_name:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.developerName.label",defaultMessage:"Company name"}),caption:a()(c.FormattedMessage,{id:"developerIntegrationForm.developerName.caption",defaultMessage:"The name of your company or organization. You may use your own name if this does not apply."})},unfurl_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.unfurlUrl.label",defaultMessage:"Unfurl Callback URL"}),caption:a()(c.FormattedMessage,{id:"developerIntegrationForm.unfurlUrl.caption",defaultMessage:"Called with a POST request when an unfurl action occurs and with a DELETE request when unfurl uri preview(s) or mention(s) is deleted."})},domain:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.domain.label",defaultMessage:"Unfurl Url Domain"}),caption:a()(c.FormattedMessage,{id:"developerIntegrationForm.domainVerification.caption",defaultMessage:"Development and verified domains for URLs to unfurl with this integration. Domains must be verified before publishing to users. See the <textlink>Notion documentation</textlink> for more verification process.",description:"Description of the domain field for integrations and the domain verification process.",values:{textlink:e=>a()(g.Z,{href:"https://developers.notion.com/docs/building-a-link-preview#domain-verification",external:!0},void 0,e)}})},url_matching_and_placeholder:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.urlMatchingAndPlaceholder.label",defaultMessage:"URL matching and placeholder",description:"Title for 'URL matching and placeholder' input in developer management site."}),caption:a()(c.FormattedMessage,{id:"developerIntegrationForm.urlMatchingAndPlaceholder.caption",defaultMessage:"When users paste a URL that matches this pattern on your verified domain, they'll have the option to unfurl it as a preview. Any sample URLs are validated against provided patterns.",description:"Caption for 'URL matching and placeholder' input in developer management site."})},external_oauth_authorize_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_authorize_url.label",defaultMessage:"OAuth Authorize URL"}),caption:a()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_authorize_url.caption",defaultMessage:"Used by Notion to initiate user authorization with the integration."})},external_oauth_token_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_token_url.label",defaultMessage:"OAuth Token URL"}),caption:a()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_token_url.caption",defaultMessage:"Called by Notion to retrieve an access token for the unfurl callback URL."})},external_oauth_scopes:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_scopes.label",defaultMessage:"OAuth Scopes (Optional)"}),caption:a()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_scopes.caption",defaultMessage:"Optional scopes string"})},external_client_id:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.external_client_id.label",defaultMessage:"OAuth Client ID"})},external_client_secret:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.external_client_secret.label",defaultMessage:"OAuth Client Secret"})},external_deletion_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:a()(c.FormattedMessage,{id:"developerIntegrationForm.external_deletion_url.label",defaultMessage:"Deleted Token Callback URL (Optional)",description:"Shown in a configuration page for a Notion integration."}),caption:a()(c.FormattedMessage,{id:"developerIntegrationForm.external_deletion_url.caption",defaultMessage:"Called by Notion when a user removes your integration.",description:"Shown in a configuration page for a Notion integration, below the heading 'Deleted Token Callback URL (Optional)'."})}}}const R={value:void 0,error:void 0},C={token:R,client_id:R,client_secret:R,authorization_url:R,name:R,icon:R,space:R,developer_space:R,submission_type:R,tagline:R,email:R,website_url:R,privacy_policy_url:R,terms_of_use_url:R,template_url:R,redirect_uris:R,capabilities:R,developer_name:R,unfurl_url:R,domain:R,url_matching_and_placeholder:R,external_oauth_authorize_url:R,external_oauth_token_url:R,external_client_id:R,external_client_secret:R,external_oauth_scopes:R,external_deletion_url:R};function T(e,t){return"error"in t?{...e,[t.field]:{...e[t.field],error:t.error}}:{...e,[t.field]:{...e[t.field],...t.value&&{error:void 0},value:t.value}}}async function Z(e){const{pageId:t,store:i,environment:r}=e;if(!i||!t)return;const a=b.G.createChildStore(i,{table:o.iU,id:t});return await a.load(),(0,M.Z)({store:a,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=v.Z.getPublicSpaceData(r,a.getSpaceId()))||void 0===e?void 0:e.domain}})}async function D(e){const{userRootStore:t,formStoreState:i,environment:r}=e;if("create-bot"===i.type){return{token:void 0,client_id:void 0,client_secret:void 0,authorization_url:void 0,space:(t?t.getAdminSpaceStores():[])[0],submission_type:i.recordTypeOnSubmission,developer_name:void 0,tagline:void 0,email:void 0,website_url:void 0,privacy_policy_url:void 0,terms_of_use_url:void 0,template_url:void 0,redirect_uris:void 0,capabilities:{read_content:!0,insert_content:!0,update_content:!0,read_comment:!1,insert_comment:!1,read_user_with_email:!0,read_user_without_email:!0,link_preview:!1,synced_database:!1},unfurl_url:void 0,domain:void 0,url_matching_and_placeholder:void 0,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("update-bot"===i.type||"create-guest-integration"===i.type){const e=i.startingRecord.value,r=t&&b.H2.createChildStore(t,{id:e.space_id,table:s.bx});return{token:i.startingRecord,client_id:void 0,client_secret:void 0,authorization_url:void 0,name:e.name,icon:e.icon,space:r,developer_space:void 0,submission_type:i.recordTypeOnSubmission,tagline:void 0,email:void 0,website_url:void 0,privacy_policy_url:void 0,terms_of_use_url:void 0,template_url:void 0,redirect_uris:void 0,capabilities:B(e.capabilities),developer_name:void 0,unfurl_url:void 0,domain:void 0,url_matching_and_placeholder:void 0,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("update-guest-integration"===i.type){const e=i.startingRecord.value;return{token:void 0,client_id:i.startingRecord,client_secret:i.startingRecord,authorization_url:(0,_.LH)({baseUrl:(0,_.k2)(m.Z.env,m.Z.isLocalhost),clientId:i.startingRecord.value.id,redirectUri:i.startingRecord.value.redirect_uris[0]}),name:e.name,icon:e.info.icon,space:void 0,developer_space:void 0,submission_type:i.recordTypeOnSubmission,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,template_url:await Z({pageId:e.info.template_page_id,store:t,environment:r}),redirect_uris:e.redirect_uris,capabilities:B(e.capabilities),developer_name:e.info.developer_name,unfurl_url:void 0,domain:void 0,url_matching_and_placeholder:void 0,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("create-third-party-external-integration"===i.type){return{token:void 0,client_id:void 0,client_secret:void 0,authorization_url:void 0,space:void 0,developer_space:(t?t.getAdminSpaceStores():[])[0],submission_type:i.recordTypeOnSubmission,tagline:void 0,email:void 0,website_url:void 0,privacy_policy_url:void 0,terms_of_use_url:void 0,template_url:void 0,redirect_uris:void 0,capabilities:void 0,developer_name:void 0,unfurl_url:void 0,domain:{developmentDomain:w.nZ,verifiedDomains:[],domainVerifications:[]},url_matching_and_placeholder:[w.VH],external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("update-third-party-external-integration"===i.type){var a,n;const e=i.startingRecord.value,r=null===(a=i.startingAuthRecord)||void 0===a?void 0:a.value,o=i.domainVerifications,l=e.info.developer_space_id,c=l&&t?b.H2.createChildStore(t,{id:l,table:s.bx}):void 0,p=e.info.original_url_patterns||[],g={developmentDomain:(null===(n=e.info.development_url_domains)||void 0===n?void 0:n[0])||"",verifiedDomains:e.info.original_url_domains||[],domainVerifications:o},m=p.map((t=>{var i;if(!0!==(null===(i=t.additional_types)||void 0===i?void 0:i.collection))return{name:(0,y.R)({patternName:t.name,integrationId:e.id}),regex:t.regex,attributes:((null==t?void 0:t.attributes)??[]).map(u.Ah),sampleUrls:(null==t?void 0:t.sample_urls)??[]}})).filter(d.$K);return{token:void 0,client_id:i.startingRecord,client_secret:i.startingRecord,authorization_url:void 0,name:e.name,icon:e.info.icon,space:void 0,developer_space:c,submission_type:i.recordTypeOnSubmission,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,template_url:void 0,redirect_uris:e.redirect_uris,capabilities:void 0,developer_name:e.info.developer_name,domain:g,url_matching_and_placeholder:m,unfurl_url:e.info.unfurl_url,external_oauth_authorize_url:null==r?void 0:r.oauth_authorize_url,external_oauth_token_url:null==r?void 0:r.oauth_token_url,external_client_id:null==r?void 0:r.client_id,external_client_secret:null==r?void 0:r.client_secret,external_oauth_scopes:null==r?void 0:r.scopes,external_deletion_url:null==r?void 0:r.deletion_url}}if("update-first-party-external-integration"===i.type){var o;const e=i.startingRecord.value,r=e.info.developer_space_id,a=r&&t?b.H2.createChildStore(t,{id:r,table:s.bx}):void 0,n=e.info.original_url_patterns||[],l={developmentDomain:(null===(o=e.info.development_url_domains)||void 0===o?void 0:o[0])||"",verifiedDomains:e.info.original_url_domains??[],domainVerifications:[]},c=n.map((t=>{var i;if(!0!==(null===(i=t.additional_types)||void 0===i?void 0:i.collection))return{name:(0,y.R)({patternName:t.name,integrationId:e.id}),regex:t.regex,attributes:((null==t?void 0:t.attributes)??[]).map(u.Ah),sampleUrls:(null==t?void 0:t.sample_urls)??[]}})).filter(d.$K);return{token:void 0,client_id:i.startingRecord,client_secret:i.startingRecord,authorization_url:void 0,name:e.name,icon:e.info.icon,space:void 0,developer_space:a,submission_type:i.recordTypeOnSubmission,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,template_url:void 0,redirect_uris:e.redirect_uris,capabilities:void 0,developer_name:e.info.developer_name,domain:l,url_matching_and_placeholder:c,unfurl_url:e.info.unfurl_url,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}(0,d.t1)(i)}function U(e){const{formData:t,formStateType:i}=e,r=[],a=k();for(const n of(0,d.Yd)(a)){const e=t[n].value;a[n].requiredBy[i]&&!e&&r.push(n)}return r}function V(e){const{formData:t,formStateType:i,templateStore:r}=e,a=[];for(const o of(0,d.Yd)(t)){const e=t[o].value,l=k()[o].supportedBy[i],s=x.tV[o];if(l&&e&&s){const i=s({value:e,formData:t,templateStore:r});var n;if(!i.validated)a.push({fieldName:o,errorMessages:null===(n=i.errorMessages)||void 0===n?void 0:n.map((e=>{let{descriptor:t,values:i}=e;return{descriptor:t,values:i??{}}}))})}}return a}function P(e){const{formData:t,formStateType:i}=e;return(0,d.Yd)(t).some((e=>k()[e].supportedBy[i]&&t[e].error))}const L={read_content:!1,update_content:!1,insert_content:!1,read_user_without_email:!1,read_user_with_email:!1,read_comment:!1,insert_comment:!1,link_preview:!1,synced_database:!1};function B(e){const t={...L};return e&&Object.entries(e).forEach((e=>{let[i,r]=e;r&&(t[i]=!0)})),t}function E(e){if(!e)return;const t={};return Object.entries(e).forEach((e=>{let[i,r]=e;r&&(t[i]=!0)})),t}function A(e){return{token:e.token.value,client_id:e.client_id.value,client_secret:e.client_secret.value,authorization_url:e.authorization_url.value,name:e.name.value,icon:e.icon.value,space:e.space.value,submission_type:e.submission_type.value,redirect_uris:(e.redirect_uris.value||[]).map((e=>x.FR(e))),website_url:x.FR(e.website_url.value),tagline:e.tagline.value,privacy_policy_url:x.FR(e.privacy_policy_url.value),terms_of_use_url:x.FR(e.terms_of_use_url.value),template_page_id:(0,I.K2)(e.template_url.value??"")??null,email:n.H3(e.email.value),capabilities:E(e.capabilities.value),developer_name:e.developer_name.value,developer_space:e.developer_space.value,unfurl_url:e.unfurl_url.value,domain:e.domain.value,url_matching_and_placeholder:e.url_matching_and_placeholder.value,external_oauth_authorize_url:x.FR(e.external_oauth_authorize_url.value),external_oauth_token_url:x.FR(e.external_oauth_token_url.value),external_client_id:e.external_client_id.value,external_client_secret:e.external_client_secret.value,external_oauth_scopes:e.external_oauth_scopes.value,external_deletion_url:x.FR(e.external_deletion_url.value)}}},12982:(e,t,i)=>{i.d(t,{sY:()=>M,mP:()=>S,vb:()=>F,H:()=>k,aP:()=>R,m0:()=>C,Z6:()=>T,Xr:()=>D,tm:()=>U,Qo:()=>V,fP:()=>P,yb:()=>E,x6:()=>A,hl:()=>O,oX:()=>N,w8:()=>q,bK:()=>K,hs:()=>Y});var r=i(77094),a=i.n(r),n=i(96486),o=i.n(n),l=(i(67294),i(33728)),s=i(21202),d=i(75246),u=i(97880),c=i(44876),p=i(5366),g=i(95477),m=i(81236),f=i(3815),v=i(71935),b=i(43348),_=i(91996),h=i(65270),y=i(84210),x=i(33929),w=i(33665);const M=(0,p.defineMessages)({missingValuesError:{id:"developerIntegrationForm.error.missingFieldRequired",defaultMessage:"{ fieldName } is required.",description:"Error message if user did not fill out a required field"},invalidInputError:{id:"developerIntegrationForm.error.invalidInput",defaultMessage:"{ fieldName } is invalid.",description:"Error message if input to this field is invalid"},transactionGenericError:{id:"developerIntegrationAction.error.failedTransaction",defaultMessage:"Something went wrong, please try again",description:"Generic error message when an unexpected error occurs in DeveloperIntegrationAction"},basicSectionTitle:{id:"developerIntegrationForm.sectionHeader.basic",defaultMessage:"Basic Information"},secretSectionTitle:{id:"developerIntegrationForm.sectionHeader.secrets",defaultMessage:"Secrets"},capabilitiesSectionTitle:{id:"developerIntegrationForm.sectionHeader.capabilities",defaultMessage:"Capabilities",description:"Developer form section title for capabilities"},oauthSectionTitle:{id:"developerIntegrationForm.sectionHeader.oauthAndUri",defaultMessage:"OAuth Domain & URIs",description:"Developer form section title for oauth"},organizationSectionTitle:{id:"developerIntegrationForm.sectionHeader.organization",defaultMessage:"Organization Information",description:"Developer form section title for org info"},externalOauthSectionTitle:{id:"developerIntegrationForm.sectionHeader.external_oauth_setup",defaultMessage:"External Authorization Setup",description:"Developer form section title for external oauth"},unfurlingSectionTitle:{id:"developerIntegrationForm.sectionHeader.unfurlingDomains",defaultMessage:"Unfurling Domain & Patterns",description:"Developer form section title for unfurling"},basicPageTitle:{id:"developerIntegrationFormHelpers.pageTitle.basic",defaultMessage:"Basic Information",description:"Title label for basic information page"},secretPageTitle:{id:"developerIntegrationFormHelpers.pageTitle.secrets",defaultMessage:"Secrets",description:"Title label for secrets page"},capabilitiesPageTitle:{id:"developerIntegrationFormHelpers.pageTitle.capabilities",defaultMessage:"Capabilities",description:"Title label capabilities page"},distributionPageTitle:{id:"developerIntegrationFormHelpers.pageTitle.distribution",defaultMessage:"Distribution",description:"Title label for distribution page"},linkPreviewPageTitle:{id:"developerIntegrationFormHelpers.pageTitle.unfurling",defaultMessage:"Link Preview",description:"Title label for link preview page"},distributionSwitcherLabel:{id:"developerIntegrationFormDistributionView.switcher.label",defaultMessage:"Do you want to make this integration public?",description:"Developer form section switcher on distribution page"},distributionSwitcherSubtitle:{id:"developerIntegrationFormDistributionView.switcher.subtitle",defaultMessage:"A public integration is available to any Notion user. Requires OAuth implementation and additional developer information. ",description:"Developer form section switcher subtitle on distribution page"},unfurlingSwitcherLabel:{id:"developerIntegrationFormUnfurlingView.switcher.label",defaultMessage:"Do you want to enable link preview for this integration?",description:"Developer form section switcher on unfurling page"},unfurlingSwitcherSubtitle:{id:"developerIntegrationFormUnfurlingView.switcher.subtitle",defaultMessage:"Unfurl external data inside Notion. Requires additional fields to configure the matching URL pattern and interface.",description:"Developer form section switcher subtitle on unfurling page"},nameLabel:{id:"developerIntegrationFormBasicView.name.label",defaultMessage:"Name",description:"Label for name field"},nameSubtitle:{id:"developerIntegrationFormBasicView.name.subtitle",defaultMessage:"Name to identify your integration to users.",description:"Subtitle for name field"},iconLabel:{id:"developerIntegrationFormBasicView.icon.label",defaultMessage:"Logo",description:"Label for logo field"},iconSubtitle:{id:"developerIntegrationFormBasicView.icon.subtitle",defaultMessage:"512px x 512px in PNG format is recommended.",description:"Subtitle for name field"},spaceLabel:{id:"developerIntegrationFormBasicView.space.label",defaultMessage:"Associated workspace",description:"Label for space field"},spaceSubtitle:{id:"developerIntegrationFormBasicView.space.subtitle",defaultMessage:"Select a workspace to install the integration to. You can upgrade the integration to use OAuth later.",description:"Subtitle for space field"},tokenLabel:{id:"developerIntegrationFormSecretView.token.label",defaultMessage:"Internal Integration Token",description:"Label for the token field if user has an internal integration"},authorizationUrlLabel:{id:"developerIntegrationFormSecretView.integrationAuthUrl.label",defaultMessage:"Authorization URL",description:"Label in developer integration form for copying a URL that sends users to an authorization page"},clientIdLabel:{id:"developerIntegrationFormSecretView.clientId.label",defaultMessage:"OAuth client ID",description:"Label for the client id field if user has set up OAuth"},clientSecretLabel:{id:"developerIntegrationFormSecretView.clientSecret.label",defaultMessage:"OAuth client secret",description:"Label for the client secret field if user has set up OAuth"},capabilitiesLabel:{id:"developerIntegrationFormCapabilitiesView.capabilities.label",defaultMessage:"Capabilities",description:"Label for capabilities field"},redirectUrisLabel:{id:"developerIntegrationFormDistributionView.redirect_uris.label",defaultMessage:"Redirect URIs",description:"Label for redirect URIs field"},redirectUrisSubtitle:{id:"developerIntegrationFormDistributionView.redirect_uri.subtitle",defaultMessage:"If you are creating a integration that includes link preview, fill in notion.so. Without link preview, fill in the path users will be redirected after they have authenticated with Notion. The path will be appended with the authorization code for access and must have a protocol. It canâ€™t contain URL fragments, relative paths or wildcards, and canâ€™t be a public IP address. It must also be included in the token request.",description:"Subtitle for redirect URIs field"},websiteUrlLabel:{id:"developerIntegrationFormDistributionView.website_url.label",defaultMessage:"Website or homepage",description:"Label for website field"},websiteUrlSubtitle:{id:"developerIntegrationFormDistributionView.website_url.subtitle",defaultMessage:"Used to link to your integrationâ€™s website or homepage in your integration page and authentication screens.",description:"Subtitle for website field"},taglineLabel:{id:"developerIntegrationFormDistributionView.tagline.label",defaultMessage:"Tagline",description:"Label for tagline field"},taglineSubtitle:{id:"developerIntegrationFormDistributionView.tagline.subtitle",defaultMessage:"A short description of what the integration does.",description:"Subtitle for tagline field"},privacyPolicyUrlLabel:{id:"developerIntegrationFormDistributionView.privacy_policy_url.label",defaultMessage:"Privacy policy",description:"Label for privacy field"},privacyPolicyUrlSubtitle:{id:"developerIntegrationFormDistributionView.privacy_policy_url.subtitle",defaultMessage:"Used to link to your integrationâ€™s privacy policy in your integration page and authentication screens.",description:"Subtitle for privacy field"},termOfUseLabel:{id:"developerIntegrationFormDistributionView.term_of_use.label",defaultMessage:"Terms of use",description:"Label for term of use field"},termOfUseSubtitle:{id:"developerIntegrationFormDistributionView.term_of_use.subtitle",defaultMessage:"Used to link to your integrationâ€™s terms of use in your integration page and authentication screens.",description:"Subtitle for term of use field"},emailLabel:{id:"developerIntegrationFormDistributionView.email.label",defaultMessage:"Support email",description:"Label for email field"},emailSubtitle:{id:"developerIntegrationFormDistributionView.email.subtitle",defaultMessage:"Used to link to your integrationâ€™s support email in your integration page and authentication screens.",description:"Subtitle for email field"},developerNameLabel:{id:"developerIntegrationFormDistributionView.developer_name.label",defaultMessage:"Company name",description:"Label for developer name field"},developerNameSubtitle:{id:"developerIntegrationFormDistributionView.developer_name.subtitle",defaultMessage:"The name of your company or organization. You may use your own name if this does not apply.",description:"Subtitle for developer name field"},templateLabel:{id:"developerIntegrationFormDistributionView.template.label",defaultMessage:"Notion URL for optional template",description:"Label for template field"},templateSubtitle:{id:"developerIntegrationFormDistributionView.template.subtitle",defaultMessage:"Use this field if you'd like to offer a user a Notion page to duplicate into their workspace during OAuth. URL must be to a public Notion page.",description:"Explains what kind of URL is accepted by the 'Notion template' input field, found in the developer portal integration page."},unfurlUrlLabel:{id:"developerIntegrationFormUnfurlingView.unfurlUrl.label",defaultMessage:"Unfurl Callback URL",description:"Label for unfurl url field"},unfurlUrlCaption:{id:"developerIntegrationFormUnfurlingView.unfurlUrl.caption",defaultMessage:"Called with a POST request when an unfurl action occurs and with a DELETE request when unfurl url preview(s) or mention(s) is deleted.",description:"Caption for unfurl url field"},domainLabel:{id:"developerIntegrationFormUnfurlingView.domain.label",defaultMessage:"Unfurl Url Domain",description:"Label for unfurl domain field"},urlMatchingAndPlaceholderLabel:{id:"developerIntegrationFormUnfurlingView.urlmatching.label",defaultMessage:"URL matching and placeholder",description:"Title for 'URL matching and placeholder' input in developer management site."},urlMatchingAndPlaceholderCaption:{id:"developerIntegrationFormUnfurlingView.urlmatching.caption",defaultMessage:"When users paste a URL that matches this pattern on your verified domain, they'll have the option to unfurl it as a preview. Any sample URLs are validated against provided patterns.",description:"Caption for 'URL matching and placeholder' input in developer management site."},externalOauthAuthorizeUrlLabel:{id:"developerIntegrationFormUnfurlingView.externalOauthAuthorizeUrl.label",defaultMessage:"OAuth Authorize URL",description:"Label for external oauth auth url field"},externalOauthAuthorizeUrlCaption:{id:"developerIntegrationFormUnfurlingView.externalOauthAuthorizeUrl.caption",defaultMessage:"Used by Notion to initiate user authorization with the integration.",description:"Caption for external oauth auth url field"},externalOauthTokenUrlLabel:{id:"developerIntegrationFormUnfurlingView.externalOauthTokenUrl.label",defaultMessage:"OAuth Token URL",description:"Label for external oauth token url field"},externalOauthTokenUrlCaption:{id:"developerIntegrationFormUnfurlingView.externalOauthTokenUrl.caption",defaultMessage:"Called by Notion to retrieve an access token for the unfurl callback URL.",description:"Caption for external oauth token url field"},externalOauthScopesLabel:{id:"developerIntegrationFormUnfurlingView.externalOauthScopes.label",defaultMessage:"OAuth Scopes",description:"Label for external oauth scopes field"},externalOauthScopesCaption:{id:"developerIntegrationFormUnfurlingView.externalOauthScopes.caption",defaultMessage:"Optional scopes string",description:"Caption for external oauth scopes field"},externalDeletionUrlLabel:{id:"developerIntegrationFormUnfurlingView.externalDeletionUrl.label",defaultMessage:"Deleted Token Callback URL ",description:"Shown in a configuration page for a Notion integration."},externalDeletionUrlCaption:{id:"developerIntegrationFormUnfurlingView.externalDeletionUrl.caption",defaultMessage:"Called by Notion when a user removes your integration",description:"Shown in a configuration page for a Notion integration, below the heading 'Deleted Token Callback URL (Optional)"},externalClientIdLabel:{id:"developerIntegrationFormUnfurlingView.externalClientId.label",defaultMessage:"OAuth Client ID",description:"Label for external oauth client id field"},externalClientSecretLabel:{id:"developerIntegrationFormUnfurlingView.externalClientSecret.label",defaultMessage:"OAuth Client Secret",description:"Label for external client id field"}});function I(e){return`${o().camelCase(e)}Label`}const S=(0,u.AO)((e=>"distribution"===e||"secrets"===e||"basic"===e||"linkPreview"===e||"capabilities"===e?{true:e}:{false:e})),F={basic:{key:"basic",title:x.default.formatMessage(M.basicPageTitle),subsections:[]},secrets:{key:"secrets",title:x.default.formatMessage(M.secretPageTitle),subsections:[]},capabilities:{key:"capabilities",title:x.default.formatMessage(M.capabilitiesPageTitle),subsections:[]},distribution:{key:"distribution",title:x.default.formatMessage(M.distributionPageTitle),subsections:[{key:"organization",title:x.default.formatMessage(M.organizationSectionTitle)},{key:"oauth",title:x.default.formatMessage(M.oauthSectionTitle)}]},linkPreview:{key:"linkPreview",title:x.default.formatMessage(M.linkPreviewPageTitle),subsections:[{key:"external_oauth",title:x.default.formatMessage(M.externalOauthSectionTitle)},{key:"unfurling",title:x.default.formatMessage(M.unfurlingSectionTitle)}]}},k=(e,t)=>{const i=["basic","secrets","capabilities","distribution"];switch(t&&i.push("linkPreview"),e){case"create-bot":return["basic"];case"update-bot":case"create-guest-integration":case"update-first-party-external-integration":return["basic","secrets","capabilities","distribution"];case"update-guest-integration":default:return i}},R={name:{supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0}},icon:{supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0}},space:{supportedBy:{"create-bot":!0,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!0,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},capabilities:{supportedBy:{"create-bot":!1,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},token:{supportedBy:{"create-bot":!1,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},client_id:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},client_secret:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},authorization_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},redirect_uris:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},template_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},developer_name:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0}},website_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0}},tagline:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},privacy_policy_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0}},terms_of_use_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0}},email:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0}},unfurl_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},domain:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0}},url_matching_and_placeholder:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0}},external_oauth_authorize_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},external_oauth_token_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},external_oauth_scopes:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},external_client_id:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}},external_client_secret:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1}},external_deletion_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1}}};function C(e){const{formData:t,setFormData:i,formStateType:r,currentFieldNames:a}=e,n=function(e){const{formData:t,formStateType:i,currentFieldNames:r}=e;return r.filter((e=>{const r=t[e].value;return R[e].requiredBy[i]&&!r}))}({formData:t,formStateType:r,currentFieldNames:a});return n.forEach((e=>{const t=I(e);i({field:e,error:x.default.formatMessage(M.missingValuesError,{fieldName:x.default.formatMessage(M[t])})})})),n}function T(e){const{formData:t,formStateType:i,templateStore:r,setFormData:n,currentFieldNames:o}=e,l=function(e){const{formData:t,formStateType:i,templateStore:r,currentFieldNames:a}=e,n=[];return a.forEach((e=>{const a=t[e].value,o=R[e].supportedBy[i],l=_.tV[e];if(o&&a&&l){const i=l({value:a,formData:t,templateStore:r});var s;i.validated||n.push({fieldName:e,errorMessages:null===(s=i.errorMessages)||void 0===s?void 0:s.map((e=>{let{descriptor:t,values:i}=e;return{descriptor:t,values:i??{}}}))})}})),n}({formData:t,formStateType:i,templateStore:r,currentFieldNames:o});return l.forEach((e=>{n({field:e.fieldName,error:e.errorMessages?e.errorMessages.map(((e,t)=>{let{descriptor:i,values:r}=e;return a()("div",{},`validation-error-${t}`,x.default.formatMessage(i,r))})):x.default.formatMessage(M.invalidInputError,{fieldName:M[I(e.fieldName)]})})})),l}function Z(e){if(!e)return;const t={};return Object.entries(e).forEach((e=>{let[i,r]=e;r&&(t[i]=!0)})),t}function D(e){return{token:e.token.value,client_id:e.client_id.value,client_secret:e.client_secret.value,authorization_url:e.authorization_url.value,name:e.name.value,icon:e.icon.value,space:e.space.value,redirect_uris:(e.redirect_uris.value||[]).map((e=>_.FR(e))),website_url:_.FR(e.website_url.value),tagline:e.tagline.value,privacy_policy_url:_.FR(e.privacy_policy_url.value),terms_of_use_url:_.FR(e.terms_of_use_url.value),template_page_id:(0,w.K2)(e.template_url.value??"")??null,email:l.H3(e.email.value),capabilities:Z(e.capabilities.value),developer_name:e.developer_name.value,unfurl_url:e.unfurl_url.value,domain:e.domain.value,url_matching_and_placeholder:e.url_matching_and_placeholder.value,external_oauth_authorize_url:_.FR(e.external_oauth_authorize_url.value),external_oauth_token_url:_.FR(e.external_oauth_token_url.value),external_client_id:e.external_client_id.value,external_client_secret:e.external_client_secret.value,external_oauth_scopes:e.external_oauth_scopes.value,external_deletion_url:_.FR(e.external_deletion_url.value)}}function U(e){const{formData:t,formStateType:i,currentFieldNames:r}=e;return r.some((e=>R[e].supportedBy[i]&&t[e].error))}const V=e=>e.flatMap((e=>e.fields)),P={read_content:!1,update_content:!1,insert_content:!1,read_user_without_email:!1,read_user_with_email:!1,read_comment:!1,insert_comment:!1,link_preview:!1,synced_database:!1};function L(e){const t={...P};return e&&Object.entries(e).forEach((e=>{let[i,r]=e;r&&(t[i]=!0)})),t}const B={value:void 0,error:void 0},E={name:B,icon:B,space:B,capabilities:B,token:B,authorization_url:B,client_secret:B,client_id:B,tagline:B,email:B,website_url:B,privacy_policy_url:B,terms_of_use_url:B,template_url:B,redirect_uris:B,developer_name:B,external_oauth_authorize_url:B,external_oauth_token_url:B,external_client_id:B,external_client_secret:B,external_oauth_scopes:B,external_deletion_url:B,unfurl_url:B,domain:B,url_matching_and_placeholder:B};function A(e,t){return"error"in t?{...e,[t.field]:{...e[t.field],error:t.error}}:{...e,[t.field]:{...e[t.field],...t.value&&{error:void 0},value:t.value}}}async function z(e){const{pageId:t,store:i,environment:r}=e;if(!i||!t)return;const a=f.G.createChildStore(i,{table:s.iU,id:t});return await a.load(),(0,y.Z)({store:a,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=m.Z.getPublicSpaceData(r,a.getSpaceId()))||void 0===e?void 0:e.domain}})}async function O(e){const{userRootStore:t,formStoreState:i,environment:r}=e;if("create-bot"===i.type){return{token:void 0,client_id:void 0,client_secret:void 0,authorization_url:void 0,space:(t?t.getAdminSpaceStores():[])[0],developer_name:void 0,tagline:void 0,email:void 0,website_url:void 0,privacy_policy_url:void 0,terms_of_use_url:void 0,template_url:void 0,redirect_uris:void 0,capabilities:{read_content:!0,insert_content:!0,update_content:!0,read_comment:!1,insert_comment:!1,read_user_with_email:!0,read_user_without_email:!0,link_preview:!1,synced_database:!1},unfurl_url:void 0,domain:void 0,url_matching_and_placeholder:void 0,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("update-bot"===i.type||"create-guest-integration"===i.type){const e=i.startingRecord.value,r=t&&f.H2.createChildStore(t,{id:e.space_id,table:d.bx});return{token:i.startingRecord,client_id:void 0,client_secret:void 0,authorization_url:void 0,name:e.name,icon:e.icon,space:r,tagline:void 0,email:void 0,website_url:void 0,privacy_policy_url:void 0,terms_of_use_url:void 0,template_url:void 0,redirect_uris:void 0,capabilities:L(e.capabilities),developer_name:void 0,unfurl_url:void 0,domain:void 0,url_matching_and_placeholder:void 0,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("update-guest-integration"===i.type){const e=i.startingRecord.value;return{token:void 0,client_id:i.startingRecord,client_secret:i.startingRecord,authorization_url:(0,v.LH)({baseUrl:(0,v.k2)(g.Z.env,g.Z.isLocalhost),clientId:i.startingRecord.value.id,redirectUri:i.startingRecord.value.redirect_uris[0]}),name:e.name,icon:e.info.icon,space:void 0,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,template_url:await z({pageId:e.info.template_page_id,store:t,environment:r}),redirect_uris:e.redirect_uris,capabilities:L(e.capabilities),developer_name:e.info.developer_name,unfurl_url:void 0,domain:void 0,url_matching_and_placeholder:void 0,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("create-third-party-external-integration"===i.type){const e=i.startingRecord.value;return{token:void 0,client_id:i.startingRecord,client_secret:i.startingRecord,authorization_url:(0,v.LH)({baseUrl:(0,v.k2)(g.Z.env,g.Z.isLocalhost),clientId:i.startingRecord.value.id,redirectUri:i.startingRecord.value.redirect_uris[0]}),name:e.name,icon:e.info.icon,space:void 0,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,template_url:await z({pageId:e.info.template_page_id,store:t,environment:r}),redirect_uris:void 0,capabilities:L(e.capabilities),developer_name:e.info.developer_name,unfurl_url:void 0,domain:{developmentDomain:h.nZ,verifiedDomains:[],domainVerifications:[]},url_matching_and_placeholder:[h.VH],external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("update-third-party-external-integration"===i.type){var a,n;const e=i.startingRecord.value,t=null===(a=i.startingAuthRecord)||void 0===a?void 0:a.value,r=i.domainVerifications,o=e.info.original_url_patterns||[],l={developmentDomain:(null===(n=e.info.development_url_domains)||void 0===n?void 0:n[0])||"",verifiedDomains:e.info.original_url_domains||[],domainVerifications:r},s=o.map((t=>{var i;if(!0!==(null===(i=t.additional_types)||void 0===i?void 0:i.collection))return{name:(0,b.R)({patternName:t.name,integrationId:e.id}),regex:t.regex,attributes:((null==t?void 0:t.attributes)??[]).map(c.Ah),sampleUrls:(null==t?void 0:t.sample_urls)??[]}})).filter(u.$K);return{token:void 0,client_id:i.startingRecord,client_secret:i.startingRecord,authorization_url:(0,v.LH)({baseUrl:(0,v.k2)(g.Z.env,g.Z.isLocalhost),clientId:i.startingRecord.value.id,redirectUri:i.startingRecord.value.redirect_uris[0]}),name:e.name,icon:e.info.icon,space:void 0,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,template_url:void 0,redirect_uris:e.redirect_uris,capabilities:L(e.capabilities),developer_name:e.info.developer_name,domain:l,url_matching_and_placeholder:s,unfurl_url:e.info.unfurl_url,external_oauth_authorize_url:null==t?void 0:t.oauth_authorize_url,external_oauth_token_url:null==t?void 0:t.oauth_token_url,external_client_id:null==t?void 0:t.client_id,external_client_secret:null==t?void 0:t.client_secret,external_oauth_scopes:null==t?void 0:t.scopes,external_deletion_url:null==t?void 0:t.deletion_url}}if("update-first-party-external-integration"===i.type){var o;const e=i.startingRecord.value,t=e.info.original_url_patterns||[],r={developmentDomain:(null===(o=e.info.development_url_domains)||void 0===o?void 0:o[0])||"",verifiedDomains:e.info.original_url_domains??[],domainVerifications:[]},a=t.map((t=>{var i;if(!0!==(null===(i=t.additional_types)||void 0===i?void 0:i.collection))return{name:(0,b.R)({patternName:t.name,integrationId:e.id}),regex:t.regex,attributes:((null==t?void 0:t.attributes)??[]).map(c.Ah),sampleUrls:(null==t?void 0:t.sample_urls)??[]}})).filter(u.$K);return{token:void 0,client_id:i.startingRecord,client_secret:i.startingRecord,authorization_url:void 0,name:e.name,icon:e.info.icon,space:void 0,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,template_url:void 0,redirect_uris:e.redirect_uris,capabilities:L(e.capabilities),developer_name:e.info.developer_name,domain:r,url_matching_and_placeholder:a,unfurl_url:e.info.unfurl_url,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}(0,u.t1)(i)}function N(e){return"create-bot"===e||"create-guest-integration"===e||"create-third-party-external-integration"===e}function q(e){return"create-third-party-external-integration"===e}function K(e){return`developer-integration-section-header-${e}`}function Y(e,t){return!("secrets"===e)&&!("distribution"===e&&"update-bot"===t)&&!("linkPreview"===e&&"update-guest-integration"===t)}},91996:(e,t,i)=>{i.d(t,{Jv:()=>b,FR:()=>w,tV:()=>S});var r=i(33728),a=i(20270),n=i(74181),o=i(89602),l=i(97880),s=i(44876),d=i(64002),u=i(63143),c=i(36054),p=i(5366),g=i(95477),m=i(67669),f=i(33665);const v=(0,p.defineMessages)({capabilityErrorMessage:{id:"developerIntegrationsCreate.error.capabilities.invalidContent2",defaultMessage:"At least one capability must be requested.",description:"Error message that a developer should request at least one capability for their integration"},regexPatternErrorMessage:{id:"developerIntegrationFormValidator.urlMatchingAndPlaceholder.regex.error",defaultMessage:"{value} regex pattern is invalid.",description:"Value will be the developer named link preview pattern. (e.g. github_pull_request pattern is invalid."},regexAttributesErrorMessage:{id:"developerIntegrationFormValidator.urlMatchingAndPlaceholder.attributes.error",defaultMessage:"{value} attributes JSON does not match request schema.",description:"Value will be the developer named link preview pattern. (e.g. github_pull_request attributes JSON does not match request schema."},sampleUrlMissingDomain:{id:"developerIntegrationFormValidator.sampleUrls.sampleUrlMissingDomain.error",defaultMessage:'URL "{value}" is missing a domain.',description:"Value will be a developer configured URL. Error appears if URL is misconfigured."},sampleUrlDoesNotMatchProvidedDomain:{id:"developerIntegrationFormValidator.sampleUrls.sampleUrlDoesNotMatchProvidedDomain.error",defaultMessage:'URL "{value}" does not match a provided domain.',description:"Value will be a developer configured URL. Error appears if URL doesn't match the configured domain (e.g. google.com)"},sampleUrlDoesNotMatchProvidedRegexes:{id:"developerIntegrationFormValidator.sampleUrls.sampleUrlDoesNotMatchProvidedRegexes.error",defaultMessage:'URL "{value}" does not match a provided regex pattern.',description:"Value will be a developer configured URL. Error appears if URL doesn't match a configured regex pattern."},templateUrlIsNotNotionPage:{id:"developerIntegrationFormValidator.templateUrl.templateUrlIsNotNotionPage.error",defaultMessage:"URL must direct to a public Notion template.",description:"Error appears if URL directs to anywhere that's not a public Notion template."},templateUrlCannotBeDuplicated:{id:"developerIntegrationFormValidator.templateUrl.templateUrlCannotBeDuplicated.error",defaultMessage:"Linked template must be public.",description:"Error appears if URL directs to Notion page that can't be duplicated."}});function b(e){let t;try{t=JSON.parse(e)}catch(i){t=void 0}return t}function _(e){const{value:t}=e,i=d.yn(t);if(!i)return{validated:!1};return d.Qc(i).hostname?{validated:!0}:{validated:!1}}function h(e){try{return new RegExp(e),{validated:!0}}catch{return{validated:!1}}}function y(e){if((0,c.Gu)(o.$1,e))return{validated:!1};for(const t of e){const e=(0,s.GY)(t);if(!(0,a.nj)(e))return{validated:!1}}return{validated:!0}}function x(e){const{domains:t,regex:i,urls:r}=e;if(0===r.length)return[];const a=[];for(const n of r){const e=(0,s.XR)({url:n,domains:t,regex:new RegExp(i)});"invalid_url"===e.type?a.push({descriptor:v.sampleUrlMissingDomain,value:n}):"url_does_not_match_domain"===e.type?a.push({descriptor:v.sampleUrlDoesNotMatchProvidedDomain,value:n}):"url_does_not_match_regex"===e.type?a.push({descriptor:v.sampleUrlDoesNotMatchProvidedRegexes,value:n}):"success"===e.type||(0,l.t1)(e)}return a}function w(e){const t=d.yn(e);if(!t||!e)return;const i=t[t.length-1],r=e[e.length-1];return"/"===i&&"/"!==r?t.slice(0,t.length-1):t}const M={insert_comment:!0,insert_content:!0,read_comment:!0,read_content:!0,update_content:!0,link_preview:!0,synced_database:!0,read_user_with_email:!1,read_user_without_email:!1},I=(0,l.Yd)(M).filter((e=>M[e]));const S={email:function(e){const{value:t}=e,i=r.H3(t);return i?{validated:r.oH(i).valueOf()}:{validated:!1}},redirect_uris:function(e){const{value:t}=e;return{validated:t.every((e=>(0,n.mb)(g.Z.domainBaseUrl,e)))}},website_url:_,privacy_policy_url:_,terms_of_use_url:_,template_url:function(e){const{value:t,templateStore:i}=e;return d.yn(t)?(0,f.K2)(t)?i&&(0,m.Oc)(i)?{validated:!0}:{validated:!1,errorMessages:[{descriptor:v.templateUrlCannotBeDuplicated}]}:{validated:!1,errorMessages:[{descriptor:v.templateUrlIsNotNotionPage}]}:{validated:!1}},capabilities:function(e){const{value:t}=e;return I.some((e=>t[e]))?{validated:!0}:{validated:!1,errorMessages:[{descriptor:v.capabilityErrorMessage}]}},unfurl_url:_,url_matching_and_placeholder:function(e){const{value:t,formData:i}=e,r=[];for(const o of t){if(h(o.regex).validated){var a;const e=x({domains:(n=null===(a=i.domain)||void 0===a?void 0:a.value,n?(0,u.jj)([...n.developmentDomain&&[n.developmentDomain],...n.domainVerifications.map((e=>{let{domain:t}=e;return t})),...n.verifiedDomains]):[]),regex:o.regex,urls:o.sampleUrls});r.push(...e)}else r.push({descriptor:v.regexPatternErrorMessage,value:o.name});y(o.attributes).validated||r.push({descriptor:v.regexAttributesErrorMessage,value:o.name})}var n;return r.length>0?{validated:!1,errorMessages:r.map((e=>{let{descriptor:t,value:i}=e;return{descriptor:t,values:{value:i}}}))}:{validated:!0}},external_oauth_authorize_url:_,external_oauth_token_url:_,external_deletion_url:_}},65270:(e,t,i)=>{i.d(t,{TG:()=>m,rn:()=>f,C:()=>v,Az:()=>b,nZ:()=>_,e_:()=>h,P4:()=>y,VH:()=>x,SV:()=>w,VR:()=>S,Hx:()=>F});var r=i(26263),a=i(41432),n=i(20270),o=i(4615),l=i(21202),s=i(19889),d=i(70203),u=i(97880),c=i(44876),p=i(63143),g=i(3815);function m(e){return(0,p.jj)(e.flatMap((e=>{if("relation"===e.type)return e.relation.uri})).filter(u.$K))}function f(e){const{environment:t,integration:i,rootUrl:u,rootAttributes:p,relatedUrisToAttributes:m}=e,f=(0,o.ZP)(),v=t.currentUser.id,b=new r.Z,_=[],h={};for(const[r,a]of Object.entries(m)){const e=(0,o.ZP)();_.push({id:e,uri:r,attributes:a}),h[r]=e}const y=[{id:"rootInstanceId",original_url:u,attributes:p,related_external_object_uris_to_instance_ids:h},..._].map((e=>{const t=[];for(const i of e.attributes){const e=(0,c.GY)(i);(0,n.nj)(e)&&t.push(e)}return{...e,attributes:t}}));if("success"!==(0,c.ny)({url:u,integrations:[i],currentSpaceId:f}).type)return{error:"Sample URL does not match provided integration regex."};const x={table:l.iU,id:(0,o.ZP)(),spaceId:f};let w;for(const r of y){const e={table:l.iU,id:r.id,spaceId:f},t={...r,domain:"test"},i={id:r.id,type:a.ZP.externalObjectInstance,version:0,created_at:0,created_by_table:s.KJ,created_by_id:(0,o.ZP)(),last_edited_time:0,last_edited_by_table:s.KJ,last_edited_by_id:(0,o.ZP)(),parent_table:l.iU,parent_id:(0,o.ZP)(),space_id:f,alive:!0,domain:"",format:t};if(b.setRecord({pointer:e,userId:v},{role:"editor",value:i}),r===y[0]){const r={...i,format:{...t,attributes:void 0}};b.setRecord({pointer:x,userId:v},{role:"editor",value:r}),w=e}}if(!w)return{error:"Root external object was not defined."};const M=new g.G(t,x,{inMemoryRecordCache:b}),I=new g.G(t,w,{inMemoryRecordCache:b}),S={table:l.iU,id:(0,o.ZP)(),spaceId:f},F=new g.G(t,S,{inMemoryRecordCache:b}),k={id:S.id,type:"text",version:0,space_id:f,parent_id:(0,o.ZP)(),parent_table:l.iU,alive:!0,properties:{title:[(0,d.YC)((0,d.x3)(x.id))]}};b.setRecord({pointer:S,userId:v},{role:"editor",value:k});const R={table:l.iU,id:(0,o.ZP)(),spaceId:f},C=new g.G(t,R,{inMemoryRecordCache:b}),T={id:R.id,type:"text",version:0,space_id:f,parent_id:(0,o.ZP)(),parent_table:l.iU,alive:!0,properties:{title:[(0,d.YC)((0,d.x3)(y[0].id))]}};return b.setRecord({pointer:R,userId:v},{role:"editor",value:T}),{emptyInstanceBlockStore:M,previewBlockStore:I,emptyInlineBlockStore:F,inlineBlockStore:C}}const v=(0,o.ZP)(),b="https://acme.com/items/23487",_="acme.com",h="^(?<site>https\\:\\/\\/acme\\.com)\\/items\\/(?<itemNo>\\d+)$",y=[{id:"title",name:"Title",type:"inline",inline:{title:{value:"Acme Item #$<itemNo>",section:"title"}}},{id:"itemId",name:"Item Id",type:"inline",inline:{plain_text:{value:"#$<itemNo>",section:"identifier"}}},{id:"site",name:"Site",type:"inline",inline:{plain_text:{value:"$<site>",section:"secondary"}}}],x={name:"item",regex:h,attributes:y,sampleUrls:[b]},w=[{id:"title",name:"Title",type:"inline",inline:{title:{value:"Feature Request: Link Previews",section:"title"}}},{id:"state",name:"State",type:"relation",relation:{uri:"acme:item_state/open",mention:{section:"primary"}}},{id:"itemId",name:"Item Id",type:"inline",inline:{plain_text:{value:"#23487",section:"identifier"}}},{id:"itemIcon",name:"Item Icon",type:"inline",inline:{color:{value:{r:247,g:247,b:42},section:"entity"}}},{id:"user",name:"User",type:"relation",relation:{uri:"https://acme.com/fig-ment",extension:[{id:"title",section:"secondary"},{id:"avatar_url",section:"avatar"}]}},{id:"description",name:"Description",type:"inline",inline:{plain_text:{value:"Would love to be able to preview some Acme resources in Notion!\n Maybe an open item?",section:"body"}}},{id:"updated_at",name:"Updated At",type:"inline",inline:{datetime:{value:"2022-01-11T19:53:18.829Z",section:"secondary"}}},{id:"label",name:"Label",type:"inline",inline:{enum:{value:"ðŸ”¨ Ready to Build",color:{r:100,g:100,b:100},section:"primary"}}}],M={uri:"https://acme.com/fig-ment",attributes:[{id:"title",name:"User Name",type:"inline",inline:{title:{value:"fig"}}},{id:"avatar_url",name:"Avatar URL",type:"embed",embed:{src_url:"https://avatars.githubusercontent.com/u/93556354?s=88&u=4967f0be0900684b6963a953ca7fe0ff2268746f&v=4",image:{}}}]},I={uri:"acme:item_state/open",attributes:[{id:"title",name:"Title",type:"inline",inline:{title:{value:"Open",section:"title"}}},{id:"icon",name:"Icon",type:"embed",embed:{src_url:"/images/external_integrations/acme-icon.png",image:{section:"avatar"}}},{id:"color",name:"Color",type:"inline",inline:{color:{value:{r:235,g:64,b:52},section:"background"}}}]};function S(){const e=[M,I],t=m(w),i={};for(const r of t){const t=e.find((e=>e.uri===r));t&&(i[r]=t.attributes)}return i}function F(e){const{domain:t,regex:i,currentIntegration:r}=e,a={...r.info,original_url_domains:[t],original_url_patterns:[{name:"acme-issue",regex:i,attributes:e.attributes.map((e=>{const t=(0,c.GY)(e);if((0,n.nj)(t))return t})).filter(u.$K)}]};return{...r,info:a}}},22230:(e,t,i)=>{i.d(t,{Z:()=>p});var r=i(49085),a=i(74181),n=i(77420),o=i(9844),l=i(5500),s=i(97880),d=i(95477),u=i(52507);class c extends r.Z{getInitialState(){return{type:"create-bot",startingRecord:void 0,recordTypeOnSubmission:"internal",status:"unpublished"}}updateRecordTypeOnSwitch(e){if("update-bot"===this.state.type){if("public"!==e)return;this.setState({type:"create-guest-integration",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"})}else if("create-guest-integration"===this.state.type){if("internal"!==e)return;this.setState({type:"update-bot",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"})}else if("update-guest-integration"===this.state.type){if("unfurling"!==e)return;this.setState({type:"create-third-party-external-integration",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,startingAuthRecord:void 0,status:"unpublished"})}else if("create-third-party-external-integration"===this.state.type){if("public"!==e)return;this.setState({type:"update-guest-integration",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"})}else"create-bot"===this.state.type||"update-third-party-external-integration"===this.state.type||"update-first-party-external-integration"===this.state.type||(0,s.t1)(this.state)}initializeNewForm(e,t,i){if(e.table===n.cZ)this.setState({type:"update-bot",startingRecord:e,recordTypeOnSubmission:"internal",status:"unpublished"});else if(e.table===o.K2)if((0,a.VM)(e.value))if((0,l.BP)({integrationId:e.value.id,env:d.Z.env}))this.setState({type:"update-first-party-external-integration",startingRecord:{table:e.table,value:e.value},recordTypeOnSubmission:"unfurling",status:e.value.status});else{if(!t)return;const r=i.map((e=>({type:e.verified_at?"verified":"unverified",id:e.id,domain:e.domain,verificationCode:e.verification_code,createdAt:e.created_at,expiresAt:e.expires_at,alive:e.alive})));this.setState({type:"update-third-party-external-integration",startingRecord:{table:e.table,value:e.value},startingAuthRecord:t,recordTypeOnSubmission:"unfurling",status:e.value.status,domainVerifications:r,domainVerificationStore:"update-third-party-external-integration"===this.state.type?this.state.domainVerificationStore:new u.ZP})}else"guest"===e.value.type&&this.setState({type:"update-guest-integration",startingRecord:{table:e.table,value:e.value},recordTypeOnSubmission:"public",status:e.value.status});else(0,s.t1)(e)}}const p=c},85227:(e,t,i)=>{i.d(t,{Z:()=>p});var r=i(49085),a=i(74181),n=i(77420),o=i(9844),l=i(5500),s=i(97880),d=i(95477),u=i(52507);class c extends r.Z{getInitialState(){return{type:"create-bot",startingRecord:void 0,recordTypeOnSubmission:"internal",status:"unpublished"}}updateRecordTypeOnSubmission(e){"create-bot"===this.state.type?"unfurling"===e&&this.setState({type:"create-third-party-external-integration",startingRecord:this.state.startingRecord,startingAuthRecord:void 0,recordTypeOnSubmission:e,status:"unpublished"}):"update-bot"===this.state.type?"public"===e&&this.setState({type:"create-guest-integration",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"}):"create-guest-integration"===this.state.type?"internal"===e&&this.setState({type:"update-bot",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"}):"update-guest-integration"===this.state.type||("create-third-party-external-integration"===this.state.type?"internal"===e&&this.setState({type:"create-bot",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"}):"update-third-party-external-integration"===this.state.type||"update-first-party-external-integration"===this.state.type||(0,s.t1)(this.state))}initializeNewForm(e,t,i){if(e.table===n.cZ)this.setState({type:"update-bot",startingRecord:e,recordTypeOnSubmission:"internal",status:"unpublished"});else if(e.table===o.K2)if((0,a.VM)(e.value))if((0,l.BP)({integrationId:e.value.id,env:d.Z.env}))this.setState({type:"update-first-party-external-integration",startingRecord:{table:e.table,value:e.value},recordTypeOnSubmission:"unfurling",status:e.value.status});else{if(!t)return;const r=i.map(u.Hs);this.setState({type:"update-third-party-external-integration",startingRecord:{table:e.table,value:e.value},startingAuthRecord:t,recordTypeOnSubmission:"unfurling",status:e.value.status,domainVerifications:r,domainVerificationStore:"update-third-party-external-integration"===this.state.type?this.state.domainVerificationStore:new u.ZP})}else this.setState({type:"update-guest-integration",startingRecord:{table:e.table,value:e.value},recordTypeOnSubmission:"public",status:e.value.status});else(0,s.t1)(e)}}const p=c},89602:(e,t,i)=>{i.d(t,{$1:()=>C});var r=i(14710),a=i(74487);const n=a.object({required:{r:a.lte(a.gte(a.integer(),0),255),g:a.lte(a.gte(a.integer(),0),255),b:a.lte(a.gte(a.integer(),0),255)},optional:{}}),o=a.object({required:{value:a.union([a.string(),a.nonEmpty(a.array(a.string()))])},optional:{section:a.literals(r.kE.avatar,r.kE.identifier,r.kE.primary,r.kE.secondary,r.kE.body)}}),l=a.object({required:{value:a.union([a.boolean(),a.nonEmpty(a.array(a.boolean()))])},optional:{}}),s=a.object({required:{value:a.union([a.number(),a.nonEmpty(a.array(a.number()))])},optional:{}}),d=a.object({required:{value:a.union([a.string(),a.nonEmpty(a.array(a.string()))])},optional:{color:n,section:a.literals(r.kE.primary)}}),u=a.object({required:{value:a.union([a.string(),a.tuple([a.string()])])},optional:{color:n,section:a.literal(r.kE.title)}}),c=a.object({required:{value:a.union([n,a.nonEmpty(a.array(n))])},optional:{section:a.literals(r.kE.entity,r.kE.background)}}),p=a.object({required:{value:a.union([a.dateString(),a.nonEmpty(a.array(a.dateString()))])},optional:{section:a.literals(r.kE.primary,r.kE.secondary)}}),g=a.object({required:{value:a.union([a.dateString(),a.nonEmpty(a.array(a.dateString()))])},optional:{section:a.literals(r.kE.primary,r.kE.secondary)}}),m=a.object({required:{value:a.union([a.dateString(),a.tuple([a.dateString()])])},optional:{section:a.literals(r.kE.primary,r.kE.secondary)}}),f=a.object({required:{value:a.union([a.dateString(),a.tuple([a.dateString()])])},optional:{section:a.literals(r.kE.primary,r.kE.secondary)}}),v=a.union([a.object({required:{plain_text:o},optional:{type:a.literal("plain_text")}}),a.object({required:{boolean:l},optional:{type:a.literal("boolean")}}),a.object({required:{number:s},optional:{type:a.literal("number")}}),a.object({required:{enum:d},optional:{type:a.literal("enum")}}),a.object({required:{title:u},optional:{type:a.literal("title")}}),a.object({required:{color:c},optional:{type:a.literal("color")}}),a.object({required:{date:p},optional:{type:a.literal("date")}}),a.object({required:{datetime:g},optional:{type:a.literal("datetime")}}),a.object({required:{created_datetime:m},optional:{type:a.literal("created_datetime")}}),a.object({required:{last_edited_datetime:f},optional:{type:a.literal("last_edited_datetime")}})]),b=a.object({required:{},optional:{section:a.literal(r.kE.embed)}}),_=a.object({required:{},optional:{section:a.literal(r.kE.embed)}}),h=a.object({required:{},optional:{section:a.literal(r.kE.embed)}}),y=a.object({required:{},optional:{section:a.literal(r.kE.embed)}}),x=a.object({required:{},optional:{format:a.nullable(a.literals("icon")),section:a.literals(r.kE.avatar,r.kE.entity,r.kE.embed)}}),w=a.intersection([a.object({required:{src_url:a.union([a.string(),a.nonEmpty(a.array(a.string()))])},optional:{default_height:a.number(),default_width:a.number()}}),a.union([a.object({required:{html:b},optional:{type:a.literal("html")}}),a.object({required:{pdf:_},optional:{type:a.literal("pdf")}}),a.object({required:{audio:h},optional:{type:a.literal("audio")}}),a.object({required:{video:y},optional:{type:a.literal("video")}}),a.object({required:{image:x},optional:{type:a.literal("image")}})])]),M=a.union([a.string(),a.nonEmpty(a.array(a.string()))]),I=a.object({required:{uri:M},optional:{type:a.literal("mention"),mention:a.object({required:{},optional:{section:a.literal(r.kE.primary)}}),extension:a.isNull()}}),S=a.object({required:{uri:M},optional:{type:a.literal("extension"),extension:a.nonEmpty(a.array(a.object({required:{id:a.string()},optional:{section:a.literals(r.kE.avatar,r.kE.embed,r.kE.primary,r.kE.secondary)}}))),mention:a.isNull()}}),F=a.union([I,S]),k=a.object({required:{uri:M},optional:{}}),R=a.intersection([a.object({required:{id:a.string(),name:a.string()},optional:{}}),a.union([a.object({required:{inline:v},optional:{type:a.literal("inline")}}),a.object({required:{embed:w},optional:{type:a.literal("embed")}}),a.object({required:{relation:F},optional:{type:a.literal("relation")}}),a.object({required:{people:k},optional:{type:a.literal("people")}})])]),C=a.array(R)}}]);