"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1471],{48298:(e,t,i)=>{i.d(t,{kn:()=>p,kj:()=>g,Tr:()=>m});var o=i(58129),r=i(75246),s=i(19889),n=i(50906),a=i(54642),d=i(10279),h=i(9953),c=i(30149),l=i(3815),u=i(98905);const p=async e=>{const{environment:t,store:i,accessRequestStore:o,forActor:r,status:a,from:l}=e,u=t.currentUser.id;if("approved"===a){const e={type:"existingUser",value:r,spaceRole:"read_and_write"};if(!(await d.n_({environment:t,store:i,inviteTargets:[e],inviteRole:"read_and_write",isOnboarding:!1,invite:{inviteOrigin:"membership_request"}})).success)return}c.createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,perform:e=>{h.sW({store:o,transaction:e,data:{granted_time:Date.now(),granted_by_table:s.KJ,granted_by_id:u,resolved_time:Date.now(),resolved_by_table:s.KJ,resolved_by_id:u,status:a}})}}),n.trackResolveMembershipRequest(t,{status:a,request_id:o.id,from:l,for_actor_id:r.id,space_role:i.getRole()})};async function g(e){if(u.Z.reset(),!e.canAdmin)return;const{environment:t,spaceId:i}=e,o=await a.getUnreadAccessRequestCount(t,{parentTable:r.bx,parentId:i,size:1});"success"===o.type&&u.Z.setState({spaceId:i,count:o.data.count})}function m(e,t){const i=new Map;for(const r of t){const t=(0,l.Kv)(e,{table:o.J8,id:r}),n=t.getValue();if(!n)continue;if(n.for_actor_table!==s.KJ||n.created_by_table!==s.KJ)continue;const a=(0,l.Kv)(e,{table:n.for_actor_table,id:n.for_actor_id}).getValue();if(!a)continue;const d=(0,l.Kv)(e,{table:n.created_by_table,id:n.created_by_id}).getValue();if(d)if(i.has(n.for_actor_id)){const e=i.get(n.for_actor_id);if(!e)continue;n.created_time>e.latestRequestTime?i.set(n.for_actor_id,{...e,createdByActorsWithReason:[{actor:d,reason:n.message},...e.createdByActorsWithReason],accessRequest:n,accessRequestStore:t,latestRequestTime:n.created_time}):i.set(n.for_actor_id,{...e,createdByActorsWithReason:[...e.createdByActorsWithReason,{actor:d,reason:n.message}]})}else i.set(n.for_actor_id,{forActor:a,createdByActorsWithReason:[{actor:d,reason:n.message}],accessRequest:n,accessRequestStore:t,latestRequestTime:n.created_time})}return Array.from(i.values())}},35846:(e,t,i)=>{i.r(t),i.d(t,{default:()=>mt});var o=i(97464),r=i.n(o),s=i(77094),n=i.n(s),a=i(96486),d=i.n(a),h=i(67294),c=i(83355),l=i(40902),u=i(66897),p=i(15145),g=i(17215),m=i(41432),v=i(80951),f=i(8848),b=i(39068),y=i(55061),S=i(98459),A=i(89101),k=i(58129),_=i(21202),M=i(77420),T=i(6287),O=i(13493),w=i(70279),R=i(33709),D=i(84683),B=i(75246),J=i(29369),C=i(19889),I=i(94044),P=i(54584),N=i(99108),x=i(70203),Z=i(97880),L=i(82990),q=i(64002),E=i(63143),U=i(5366),F=i(50906),V=i(19719),W=i(17659),G=i(4083),H=i(38363),K=i(30149),z=i(4708),$=i(14976),j=i(17731),Y=i(33929),X=i(98165),Q=i(67669),ee=i(16402),te=i(3815),ie=i(62820),oe=(i(41892),i(24211)),re=i(61784),se=i(76725),ne=i(63306);class ae extends h.PureComponent{render(){const{href:e}=this.props;return n()("a",{href:(0,q.Nm)({str:e,allowNoProtocol:!0}),style:this.getStyle(),className:"notion-email-button-hover"},void 0,this.props.children)}getStyle(){return{display:this.props.inline?"inline":"block",color:f.ZP.inherit,textDecoration:"none",cursor:"pointer",...this.props.style}}}const de=ae;class he extends h.PureComponent{render(){const e=this.getPathWithoutDomain();return e.length>0?n()("div",{},void 0,this.props.left,(0,se.Z)(e,(e=>n()("span",{style:{paddingLeft:4,paddingRight:4}},`slash:${e}`,"/"))),this.props.right):null}getPathWithoutDomain(){const{getRecordValue:e,blockId:t,intl:i}=this.props,o=ne.uJ({table:"block",id:t},e);return d().initial(o.reverse()).map((t=>{const o=g.T5({table:"block",value:t,getRecordValue:e,userTimeZone:this.props.userTimeZone,intl:i})||i.formatMessage({id:"recordPath.untitledBlock.placeholder",defaultMessage:"Untitled"}),r=g.Om({table:"block",value:t,getRecordValue:e});return n()(de,{href:`${this.props.baseUrl}${r}`,style:{display:"inline-block",maxWidth:120,verticalAlign:"top",...L.Z.textOverflowStyle}},t.id,o)}))}}const ce=(0,U.injectIntl)(he);i(43593),i(17755),i(58102);h.PureComponent;class le extends h.PureComponent{constructor(){super(...arguments),this.theme=(0,f.gh)({theme:"light"})}render(){const{children:e}=this.props;return n()("table",{style:{paddingTop:12,paddingBottom:e?0:8,borderSpacing:0,width:"100%",borderCollapse:"separate"}},void 0,n()("tr",{},void 0,n()("td",{style:{verticalAlign:"top",width:le.avatarSize+6,minWidth:le.avatarSize+6,paddingTop:2}},void 0,this.props.icon),n()("td",{},void 0,this.renderHeader())),n()("tr",{},void 0,n()("td",{}),n()("td",{style:{maxWidth:400}},void 0,e&&this.renderChildren())),this.renderDivider())}renderDivider(){const{isLast:e}=this.props;if(!e)return n()("tr",{},void 0,n()("td",{colSpan:2},void 0,n()("div",{style:this.getBorderBottomStyle()})))}renderHeader(){const{timestamp:e,header:t,intl:i}=this.props,o=(0,re.Yx)(Math.min(e,Date.now()),"medium_with_time",(0,oe.E2)(i),this.props.userTimeZone);return n()("div",{style:le.headerStyle},void 0,n()("div",{},void 0,t),n()("table",{style:{...this.getPathAndTimeStyle(),marginTop:4,marginBottom:this.props.children?8:4,borderSpacing:0}},void 0,n()("tr",{},void 0,n()("td",{},void 0,o),n()("td",{},void 0,this.props.navigableBlockId&&n()(ce,{getRecordValue:this.props.getRecordValue,blockId:this.props.navigableBlockId,baseUrl:this.props.baseUrl,left:n()("span",{style:this.getDotStyle()},void 0,"Â·"),userTimeZone:this.props.userTimeZone})))))}renderChildren(){return n()("div",{},void 0,this.props.children)}getBorderBottomStyle(){return{borderBottom:`1px solid ${this.props.theme.regularDividerColor}`,marginBottom:4}}getPathAndTimeStyle(){return{fontSize:12,color:this.theme.lightTextColor,whiteSpace:"nowrap"}}getDotStyle(){return{color:this.theme.lightTextColor,marginLeft:4,marginRight:4}}}le.avatarSize=28,le.headerStyle={fontSize:14,lineHeight:1.4};const ue={fontWeight:L.Z.fontWeight.semibold};(0,U.injectIntl)(le);var pe=i(3779),ge=i(51118),me=i(43250),ve=i(12534),fe=i(4761),be=i(12318),ye=i(73063),Se=i(86176),Ae=i(58032),ke=i(70301),_e=i(45653),Me=i(67706),Te=i(480),Oe=i(24405);function we(e){let{notification:t,rootStore:i,onArchiveClicked:o,onMarkAsReadClicked:s,onMarkAsUnreadClicked:a}=e;window.__c="InboxActionsMenu";const d=(0,Te.O7)(),c=(0,h.useCallback)((e=>{t&&(0,ve.ZP)({event:e,context:ve.Af.NotificationClick,callback:()=>{o(),K.createAndCommit({userAction:"InboxActionsMenu.handleArchive",environment:d,perform:e=>{W.aZ({notification:t,rootStore:i,transaction:e})}})}})}),[d,t,o,i]),l=(0,h.useCallback)((e=>{t&&(0,ve.ZP)({event:e,context:ve.Af.NotificationClick,callback:()=>{t.read?a():s("mark_as_read_button"),K.createAndCommit({userAction:"InboxActionsMenu.toggleNotificationReadStatus",environment:d,perform:e=>{W.$h({notification:t,rootStore:i,transaction:e,read:!t.read})}})}})}),[d,t,s,a,i]),{isMobile:u}=d.device,p=(0,Oe.yK)((e=>({container:{display:"flex",height:"min-content",background:e.buttonGroupBackground,boxShadow:e.lightBoxShadow,borderRadius:4,padding:2},button:{height:u?30:26,width:u?30:26},iconStyle:{fill:e.mediumTextColor,padding:2},readIcon:{width:u?21:19,height:u?22:20},archiveIcon:{width:u?24:23,height:u?24:23}})),[u]);return t?n()("div",{style:p.container},void 0,n()(Ae.Z,{renderTooltip:()=>t.read?n()(U.FormattedMessage,{defaultMessage:"Mark this notification as unread",id:"inboxActionsMenu.markNotificationAsUnread.tooltipMessage",description:"Tooltip message for the icon button to mark a notification as unread. The icon is an image of an empty speech bubble."}):n()(U.FormattedMessage,{defaultMessage:"Mark this notification as read",id:"inboxActionsMenu.markNotificationAsRead.tooltipMessage",description:"Tooltip message for the icon button to mark a notification as read. The icon is an image of a speech bubble with a checkmark in it."}),render:e=>h.createElement(ye.Z,r()({style:p.button,icon:t.read?pe.Z.notificationUnread:pe.Z.notificationRead,iconStyle:{...p.iconStyle,...p.readIcon},onClick:l},e))}),n()(Ae.Z,{renderTooltip:()=>n()(U.FormattedMessage,{defaultMessage:"Archive this notification",id:"inboxActionsMenu.handleArchive.tooltipMessage",description:"Tooltip message for the icon button to archive a notification. The icon is an image of a storage file box."}),render:e=>h.createElement(ye.Z,r()({style:p.button,icon:pe.Z.archive,iconStyle:{...p.iconStyle,...p.archiveIcon},onClick:c},e))})):null}const Re=h.memo(we);var De=i(32469),Be=i(93963);class Je extends c.Z{constructor(){super(...arguments),this.storeTypes={hovered:be.default.of(!1),hoveredOverInboxActionsMenu:be.default.of(!1)},this.handleMouseOver=()=>{this.stores.hovered.set(!0)},this.handleMouseLeave=()=>{this.stores.hovered.set(!1)},this.handleMouseEnterInboxActions=()=>{this.stores.hoveredOverInboxActionsMenu.set(!0)},this.handleMouseLeaveInboxActions=()=>{this.stores.hoveredOverInboxActionsMenu.set(!1)},this.handleArchive=()=>{const{notification:e,rootStore:t,onArchiveClicked:i}=this.props;i(),e&&K.createAndCommit({userAction:"ActivitySection.handleArchive",environment:this.environment,perform:i=>{W.aZ({notification:e,rootStore:t,transaction:i})}})},this.handleMarkAsRead=e=>{const{notification:t,rootStore:i,onMarkAsReadClicked:o}=this.props;t&&!t.read&&(this.stores.hoveredOverInboxActionsMenu.get()||(0,ve.ZP)({event:e,context:ve.Af.NotificationClick,callback:()=>{o("notification_body"),K.createAndCommit({userAction:"ActivitySection.handleMarkAsRead",environment:this.environment,perform:e=>{W.$h({notification:t,rootStore:i,transaction:e,read:!0})}})}}))},this.handleOpenSnapshot=()=>{if(this.props.navigableBlockId){const e=te.G.createChildStore(this.props.rootStore,{table:_.iU,id:this.props.navigableBlockId});ge.jN({environment:this.environment,blockStore:e,openSnapshotNearTimestamp:this.props.timestamp.toString(),from:"activity"})}}}renderComponent(){const{children:e}=this.props,t="mentions"===fe.Z.state.currentTab;return n()("div",{onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,onClick:this.handleMarkAsRead},void 0,this.renderInboxActions(),n()("div",{style:{...Je.wrapStyle,paddingBottom:e?12:8,paddingLeft:this.environment.device.isMobile?this.environment.WindowSizeStore.state.paddingLeftCSS:0,paddingRight:this.environment.device.isMobile?this.environment.WindowSizeStore.state.paddingRightCSS:0,...this.shouldShowReadNotificationStyle()&&{opacity:.7}}},void 0,n()("div",{style:this.getHeaderAndAvatarStyle()},void 0,n()("div",{className:me.FoE,style:this.avatarAndStatusDotStyle()},void 0,n()("div",{style:{marginRight:4}},void 0,t&&n()("div",{style:{marginRight:this.environment.device.isMobile?3:2}},void 0,this.renderStatusDot({opacity:1}))),this.props.icon),this.renderHeader(),this.renderSnapshotButton(),this.renderPrivate()),e&&this.renderChildren()),this.renderDivider())}renderDivider(){const{isLast:e}=this.props;if(!e)return n()("div",{style:this.getBorderBottomStyle()})}renderHeader(){const{timestamp:e,header:t}=this.props,i=(0,ee.IS)(e),o=(0,ee.uy)(e);return n()("div",{style:Je.headerStyle},void 0,n()("div",{className:me.NFf},void 0,t),n()("div",{style:{display:"flex",marginTop:4,marginBottom:this.props.children?8:4}},void 0,n()("div",{style:this.getTimeStyle(),className:me.CZG},void 0,n()(Me.Z,{text:i,tooltipText:o,icon:pe.Z.calendar})),this.props.navigableBlockId&&this.props.rootStore&&n()(Se.Z,{isLink:!0,innerStyle:this.getPathStyle(),store:te.G.createChildStore(this.props.rootStore,{table:_.iU,id:this.props.navigableBlockId}),left:n()("div",{style:this.getSeparatorDotStyle()},void 0,"Â·"),onClick:this.props.onBacklinkClicked})))}renderSnapshotButton(){if(this.props.showSnapshotButton&&!(this.props.timestamp<new Date("2018-10-26").getTime()))return this.props.navigableBlockId?n()(Ae.Z,{renderTooltip:()=>n()(U.FormattedMessage,{defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"}),render:e=>h.createElement(ye.Z,r()({onClick:this.handleOpenSnapshot,icon:pe.Z.versionHistoryThick},e))}):void 0}renderInboxActions(){const{notification:e,rootStore:t,onArchiveClicked:i,onMarkAsReadClicked:o,onMarkAsUnreadClicked:r}=this.props,{currentTab:s}=fe.Z.state;if("mentions"===s&&e&&!e.visited)return n()("div",{style:this.getStatusLabelContainerStyle(),onMouseEnter:this.handleMouseEnterInboxActions,onMouseLeave:this.handleMouseLeaveInboxActions},void 0,n()("div",{style:this.getInboxActionsStyle()},void 0,n()(Re,{notification:e,rootStore:t,onArchiveClicked:i,onMarkAsReadClicked:o,onMarkAsUnreadClicked:r})))}renderStatusDot(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!this.isSeen()&&n()(Be.z,{style:{...this.getStatusDotStyle(),...e}})}renderPrivate(){if(this.props.isPrivate&&!this.props.notification)return n()(De.Z,{style:{marginTop:1,marginBottom:4,marginLeft:8}})}renderChildren(){return n()("div",{className:me.nU_},void 0,this.props.children)}isSeen(){const{notification:e}=this.props;return!e||e.read}shouldShowReadNotificationStyle(){const{currentTab:e}=fe.Z.state;return this.isSeen()&&"mentions"===e&&!this.props.showSnapshotButton&&this.props.notification}avatarAndStatusDotStyle(){return{display:"flex",alignItems:"flex-start",position:"relative"}}getHeaderAndAvatarStyle(){return{display:"flex",paddingLeft:16,paddingRight:16+("mentions"!==fe.Z.state.currentTab||this.props.showSnapshotButton?0:69)}}getBorderBottomStyle(){return{borderBottom:`1px solid ${this.theme.regularDividerColor}`}}getPathStyle(){return{fontSize:12,color:this.theme.lightTextColor}}getTimeStyle(){return{fontSize:12,color:this.theme.lightTextColor,whiteSpace:"nowrap"}}getSeparatorDotStyle(){return{fontSize:12,color:this.theme.lightTextColor,marginLeft:4,marginRight:4}}getStatusLabelContainerStyle(){return{display:"flex",alignItems:"flex-start",marginTop:1,marginBottom:4,position:"relative",marginLeft:this.environment.device.isMobile?23:8}}getStatusDotStyle(){return{position:"absolute",opacity:this.stores.hovered.get()?0:1,left:-7,top:10}}getInboxActionsStyle(){const{isMobile:e}=this.environment.device;return{transition:"opacity 100ms ease-out",opacity:e||this.stores.hovered.get()?1:0,position:"absolute",right:16,top:12,zIndex:1}}}Je.displayName="ActivitySection",Je.wrapStyle={paddingTop:12},Je.headerStyle={fontSize:14,lineHeight:1.4,flexGrow:1,minWidth:0};const Ce={marginTop:2,marginRight:8,flexShrink:0};function Ie(e){const{authors:t}=e,i=t[0];return i&&(0,u.z8)(i)?n()(ke.Z,{botValue:i.value,style:Ce,size:24}):n()(_e.Z,{userValue:i&&i.value,style:Ce,size:24,avatarShouldShowShadow:!0})}function Pe(){return window.__c="ReminderIcon",n()("div",{style:{display:"flex",backgroundColor:f.ZP.red,height:28,width:28,borderRadius:"100%",...Ce}},void 0,pe.Z.alarmClock({height:16,width:16,fill:f.ZP.white,marginLeft:6,marginTop:5}))}function Ne(){return window.__c="VerificationIcon",n()("div",{style:{height:25,width:25,...Ce}},void 0,pe.Z.typesVerification({height:25,width:25}))}function xe(e){return function(e,t){const i=t.map((t=>(0,u.$4)(e,t)));if(1===i.length)return n()("span",{},void 0,n()(U.FormattedMessage,{defaultMessage:"<b>{author}</b>",id:"activitySection.authorPhrase.forOneAuthor.label",description:"Bolded string for showing the single author that generated an activity update notification.",values:{author:i[0],b:e=>n()("span",{style:ue},void 0,e)}}));if(2===i.length)return n()("span",{},void 0,n()(U.FormattedMessage,{defaultMessage:"<b>{firstAuthor}</b> and <b>{secondAuthor}</b>",id:"activitySection.authorPhrase.forTwoAuthors.label",description:"Bolded string for listing two authors in an activity update notification.",values:{firstAuthor:i[0],secondAuthor:i[1],b:e=>n()("span",{style:ue},void 0,e)}}));if(i.length>2){const e=n()(U.FormattedMessage,{defaultMessage:"{numberOfOtherAuthors, plural, one {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, and {numberOfOtherAuthors} other} other {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, and {numberOfOtherAuthors} others}}",id:"activitySection.authorPhrase.forMoreThanTwoAuthors.label",description:"Bolded string for showing multiple authors that generated an activity update notification.",values:{numberOfOtherAuthors:i.length-2,firstAuthor:i[0],secondAuthor:i[1],b:e=>n()("span",{style:ue},void 0,e)}});return n()("span",{},void 0,e)}return n()("span",{style:ue},void 0,n()(U.FormattedMessage,{defaultMessage:"Nobody",description:"Default text when there's an activity update with no users attached",id:"activitySection.authorPhrase.forNoAuthors.label"}))}(Y.default.getIntl(),e)}const Ze=Je;var Le=i(48298),qe=i(91376),Ee=i(64404),Ue=i(61519),Fe=i(62385),Ve=i(64369);class We extends c.Z{constructor(){super(...arguments),this.storeTypes={role:be.default.of(void 0)}}renderComponent(){const{accessRequestStore:e}=this.props;if(e.isDefined()){if(e.isResolvedSpaceMembershipRequest())return this.renderResolvedSpaceMembershipRequest();if(this.canResolveMembershipRequests())return n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()(Fe.Z,{onClick:()=>this.resolveMembershipRequest("approved"),style:this.getButtonStyle(!1)},void 0,n()(U.FormattedMessage,{defaultMessage:"Approve",id:"approveSpaceMembershipActivityAction.approveButton.label",description:"Button in notification to approve a membership request."})),n()(Fe.Z,{onClick:()=>this.resolveMembershipRequest("rejected"),style:{height:26,paddingLeft:8,paddingRight:8}},void 0,n()(U.FormattedMessage,{defaultMessage:"Decline",id:"approveSpaceMembershipActivityAction.declineButton.label",description:"Decline space membership request button in notification."})),!this.environment.device.isMobile&&h.createElement(h.Fragment,null,n()(Ue.Z,{size:1,vertical:!0,style:{height:26,paddingLeft:8,paddingRight:8}}),n()(Fe.Z,{onClick:()=>{F.trackClickViewAllRequests(this.environment,{disable_membership_requests:this.props.spaceStore.getDisableMembershipRequests()}),this.handleOpenSettingsMembersRequests()},style:{height:26,paddingLeft:8,paddingRight:8}},void 0,n()(U.FormattedMessage,{defaultMessage:"View all requests",id:"approveSpaceMembershipActivityAction.viewAllRequests.label",description:"Button that takes user to the settings modal members requests tab to see all existing requests."}))))}}renderResolvedSpaceMembershipRequest(){const{accessRequestStore:e}=this.props;if(!e.isDefined())return;const t=e.isResolvedSpaceMembershipRequest()&&this.renderActor(e.getResolvedByPointer());return h.createElement(h.Fragment,null,n()(Ve.Z,{isSecondaryColor:!0},void 0,"approved"===e.getStatus()?n()(U.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"approveSpaceMembershipActivityAction.requestApproved.title",values:{grantedBy:t},description:"Message showing that space membership request has been approved."}):n()(U.FormattedMessage,{defaultMessage:"Declined by {grantedBy}",id:"approveSpaceMembershipActivityAction.requestDeclined.title",values:{grantedBy:t},description:"Message showing that space membership request has been declined."})),n()(Ve.Z,{isSmall:!0,isSecondaryColor:!0},void 0,(0,re.Yx)(Math.min(e.getResolvedTime(),Date.now()),"medium_with_time",(0,oe.E2)(this.props.intl))))}handleOpenSettingsMembersRequests(){qe.r({currentTab:"members",subtab:Ee.Q.Requests})}canResolveMembershipRequests(){return this.props.spaceStore.canEditMembership()}renderActor(e){const{table:t,id:i}=e;return xe(d().compact([this.getActor(t,i)]))}getActor(e,t){if(e===C.KJ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,u.dp)(i)}if(e===M.cZ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,u.D$)(i)}}get rootStore(){return this.props.accessRequestStore}async resolveMembershipRequest(e){if(!this.canResolveMembershipRequests())return;const t=this.environment,{spaceStore:i,accessRequestStore:o}=this.props;if(!o.isDefined())return;const r=this.getActor(C.KJ,o.getForActorId());r&&r.table===C.KJ&&await Le.kn({environment:t,store:i,accessRequestStore:o,forActor:r.value,status:e,from:"notification"})}getButtonStyle(e){const t={height:26,paddingLeft:8,paddingRight:8,boxShadow:this.theme.plainButtonBoxShadow,fontSize:12,marginRight:10};return e?t:{...t,color:this.theme.regularTextColor,fontWeight:500}}}We.displayName="ApproveSpaceMembershipActivityAction";const Ge=(0,U.injectIntl)(We);var He=i(1136),Ke=i(45669),ze=i(84076),$e=i(31278),je=i(76798),Ye=i(79931),Xe=i(13991),Qe=i(27006),et=i(10279),tt=i(9953),it=i(21115),ot=i(78291),rt=i(7567);class st extends c.Z{constructor(){super(...arguments),this.storeTypes={role:be.default.of(void 0)},this.handleApproveMembershipRequest=async()=>{},this.handleGrantPageAccess=async()=>{const{targetBlockStore:e,accessRequestStore:t}=this.props,i=this.getInviteTargetWithNewPermissionItem();if(!("permissionItem"in i))return;const o=this.environment.currentUser.id;if(!o)return;if("type"in i){let t;if("existingUser"===i.type){t=(await et.n_({environment:this.environment,store:e,inviteTargets:[i],inviteRole:i.permissionItem.role,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else if("bot"===i.type){t=(await et.n_({environment:this.environment,store:e,inviteTargets:[i],inviteRole:void 0,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else(0,Z.t1)(i);if(!t)return}K.createAndCommit({userAction:"GrantPageAccessActivityAction.handleGrantPageAccess",environment:this.environment,perform:r=>{"type"in i||et.ep({environment:this.environment,transaction:r,store:e,permissionItems:[i.permissionItem]}),tt.sW({store:t,transaction:r,data:{granted_time:Date.now(),granted_by_table:C.KJ,granted_by_id:o,resolved_time:Date.now(),resolved_by_table:C.KJ,resolved_by_id:o,status:"approved"}})}});const r=t.getValue(),s=r&&r.created_time&&r.granted_time?r.granted_time-r.created_time:void 0;F.trackGrantAccess(this.environment,{requestId:r&&r.id,timeElapsedSinceRequest:s,newAccessLevel:i.permissionItem.role,...this.getGrantOrIgnoreAccessArgs()})},this.handleRoleChange=e=>{const t=this.props.accessRequestStore.id,i=this.stores.role.state;this.stores.role.setState(e),F.trackChangeGrantAccessLevel(this.environment,{requestId:t,previousAccessLevel:i,newAccessLevel:e,...this.getGrantOrIgnoreAccessArgs()})},this.handleArchive=()=>{const{notification:e}=this.props;e&&(K.createAndCommit({userAction:"GrantPageAccessActivityAction.handleArchive",environment:this.environment,perform:t=>{W.aZ({notification:e,rootStore:this.props.accessRequestStore,transaction:t})}}),F.trackIgnoreAccessRequest(this.environment,this.getGrantOrIgnoreAccessArgs()))}}renderComponent(){const e=this.props.accessRequestStore.getValue();if(!e)return;if((0,k.Kc)(e))return this.renderGrantedAccessRequest(e);if(!this.canGrantAccess())return;const t=e.parent_table===B.bx,i=this.getCurrentPermissionItem();if(i&&!t){const t=this.renderActor(e.for_actor_table,e.for_actor_id),o=i.role===this.getRole();return h.createElement(h.Fragment,null,n()(Ve.Z,{isSecondaryColor:!0,style:{marginBottom:6}},void 0,n()(U.FormattedMessage,{defaultMessage:"{requestingUser} already has access.",id:"grantPageAccessActivityAction.alreadyHasAccess.label",description:"Shown if the user who requested access already has access",values:{requestingUser:t}})),n()(rt.Z,{upgradeButtonName:"user_permission_item",role:this.getRole(),table:_.iU,blockType:this.props.targetBlockStore.getType(),type:e.for_actor_table===C.KJ?"user_permission":"bot_permission",onChange:this.handleRoleChange,isInvite:!0,buttonStyle:this.getButtonStyle(!0)}),n()(Fe.Z,{onClick:this.handleGrantPageAccess,style:this.getButtonStyle(o)},void 0,n()(U.FormattedMessage,{defaultMessage:"Change",id:"grantPageAccessActivityAction.changePermissionButton.label",description:"Change permission button for page access requests in notification."})),this.renderArchiveButton())}return h.createElement(h.Fragment,null,n()(rt.Z,{upgradeButtonName:"user_permission_item",role:this.getRole(),table:_.iU,blockType:this.props.targetBlockStore.getType(),type:e.for_actor_table===C.KJ?"user_permission":"bot_permission",onChange:this.handleRoleChange,isInvite:!0,buttonStyle:this.getButtonStyle(!1)}),n()(Fe.Z,{onClick:this.handleGrantPageAccess,style:this.getButtonStyle(!1)},void 0,n()(U.FormattedMessage,{defaultMessage:"Grant access",id:"grantPageAccessActivityAction.grantAccessButton.label",description:"Button in notification to grant access to a page access request."})),this.renderArchiveButton())}renderGrantedAccessRequest(e){const t=this.renderActor(e.granted_by_table,e.granted_by_id),i=(0,re.$b)(Math.min(e.granted_time,Date.now()),Xe.SP,Y.default.getIntl());return h.createElement(h.Fragment,null,n()(Ve.Z,{isSecondaryColor:!0},void 0,n()(U.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"grantPageAccessActivityAction.accessGranted.title",description:"Approval message for page access requests in notification.",values:{grantedBy:t,time:i}})),n()(Ve.Z,{isSmall:!0,isSecondaryColor:!0},void 0,i))}renderArchiveButton(){const{notification:e}=this.props;if(e&&!e.visited)return n()(Fe.Z,{onClick:this.handleArchive,style:{height:26,paddingLeft:8,paddingRight:8}},void 0,n()(U.FormattedMessage,{defaultMessage:"Ignore",id:"grantPageAccessActivityAction.ignoreButton.label",description:"Ignore page access request button in notification."}))}getRole(){const e=this.getCurrentPermissionItem(),t=e&&e.role;return this.stores.role.state||t||this.props.initialRole}getNewPermissionItem(){const e=this.props.accessRequestStore.getValue();if(e)return e.for_actor_table===C.KJ?{type:"user_permission",user_id:e.for_actor_id,role:this.getRole()}:{type:"bot_permission",bot_id:e.for_actor_id,role:this.getRole()}}getInviteTargetWithNewPermissionItem(){const e=this.getNewPermissionItem();if(!e)return{};if(this.getCurrentPermissionItem())return{permissionItem:e};const{data:t}=ot.default.state;if("user_permission"===e.type){const i=this.rootStore.getRecordValue({table:C.KJ,id:e.user_id}),o=t?it.CM(t):[],r=o&&o.some((t=>t.userId===e.user_id));return i&&!r?{type:"existingUser",value:i,permissionItem:e}:{permissionItem:e}}if("bot_permission"===e.type){const i=this.rootStore.getRecordValue({table:M.cZ,id:e.bot_id}),o=(t?it.NM(t):[]).some((t=>t.botId===e.bot_id));return i&&!o?{type:"bot",value:i,permissionItem:e}:{permissionItem:e}}(0,Z.t1)(e)}getCurrentPermissionItem(){const e=this.props.accessRequestStore.getValue();if(!e)return;const t=this.props.targetBlockStore.getPermissionItems();for(const i of t){if(e.for_actor_table===C.KJ&&(0,Qe.jg)(i)&&i.user_id===e.for_actor_id)return i;if(e.for_actor_table===M.cZ&&(0,Qe.FB)(i)&&i.bot_id===e.for_actor_id)return i}}canGrantAccess(){return this.props.targetBlockStore.canAdmin()}renderActor(e,t){return xe(d().compact([this.getActor(e,t)]))}getActor(e,t){if(e===C.KJ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,u.dp)(i)}if(e===M.cZ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,u.D$)(i)}}get rootStore(){return this.props.accessRequestStore}getButtonStyle(e){const t={height:26,paddingLeft:8,paddingRight:8,boxShadow:this.theme.plainButtonBoxShadow,fontSize:12,marginRight:10};return e?t:{...t,color:this.theme.regularTextColor,fontWeight:500}}getGrantOrIgnoreAccessArgs(){const{notification:e}=this.props;return{tab:V.Jn(),activityId:null==e?void 0:e.activity_id,notificationId:null==e?void 0:e.id}}}st.displayName="GrantPageAccessActivityAction";const nt=st;var at=i(16489),dt=i(18698);const ht=function(e){window.__c="ApproveTeamMembershipActivityButton";const{accessRequestStore:t,teamStore:i}=e,o=(0,Te.O7)(),r=(0,U.useIntl)(),{isRequestResolved:s,resolvedStatus:a,resolvedTime:d}=(0,at.VK)((()=>({isRequestResolved:t.isResolvedTeamMembershipRequest(),resolvedStatus:t.getStatus(),resolvedTime:t.getResolvedTime()})),[t]),h=(0,at.VK)((()=>{const e=t.getResolvedById();if(!e)return;const i=te.U6.createChildStore(t,{table:C.KJ,id:e});return i?i.getDisplayName(r):void 0}),[t,r]),c=async e=>{await dt.ow({environment:o,teamStore:i,accessRequestStore:t,status:e})},l=(0,Oe.yK)((e=>({container:{display:"flex",alignItems:"center"},button:{height:26,paddingLeft:8,paddingRight:8,fontSize:12,marginRight:10,fontWeight:500,boxShadow:e.plainButtonBoxShadow}})),[]);return n()("div",{style:l.container},void 0,s?n()("div",{},void 0,n()(Ve.Z,{isSecondaryColor:!0},void 0,n()(U.FormattedMessage,"approved"===a?{defaultMessage:"Approved by {grantedBy}",id:"approveTeamMembershipActivityButton.requestApproved.title",values:{grantedBy:h},description:"Message showing that a team membership request has been approved."}:{defaultMessage:"Declined by {grantedBy}",id:"approveTeamMembershipActivityButton.requestDeclined.title",values:{grantedBy:h},description:"Message showing that a team membership request has been declined."})),n()(Ve.Z,{isSmall:!0,isSecondaryColor:!0},void 0,(0,re.Yx)(Math.min(d,Date.now()),"medium_with_time",(0,oe.E2)(r)))):n()("div",{},void 0,n()(Fe.Z,{style:l.button,onClick:()=>c("approved")},void 0,n()(U.FormattedMessage,{defaultMessage:"Approve",id:"approveTeamMembershipActivityButton.approveButton.label",description:"Button in notification to approve a team membership request."})),n()(Fe.Z,{onClick:()=>c("rejected")},void 0,n()(U.FormattedMessage,{defaultMessage:"Decline",id:"approveTeamMembershipActivityButton.declineButton.label",description:"Decline team membership request button in notification."}))))};var ct=i(64921);class lt extends c.Z{constructor(){super(...arguments),this.storeTypes={open:be.default.of(!1)},this.handleOpen=()=>{this.stores.open.set(!0)}}renderComponent(){return this.stores.open.get()||this.props.items.length<=this.props.visible?n()("div",{},void 0,this.props.items):n()("div",{},void 0,this.props.items.slice(0,this.props.visible),n()(ct.Z,{onClick:this.handleOpen,style:this.getStyle()},void 0,n()(U.FormattedMessage,{defaultMessage:"View {moreCount} more",id:"activity.viewMoreButton.label",values:{moreCount:this.props.items.length-this.props.visible}})))}getStyle(){return{display:"flex",alignItems:"center",height:28,fontSize:12,color:this.theme.lightTextColor,padding:0,paddingLeft:52,paddingRight:16}}}lt.displayName="ViewMore";const ut=lt,pt=n()("div",{style:{width:5,display:"inline-block"}});class gt extends c.Z{constructor(e){super(e),this.renderBlockEdit=(e,t,i)=>{let o=this.getRecordValue({table:_.iU,id:e.block_id});o&&o.type===m.ZP.tableRow&&(o=this.getRecordValue({table:_.iU,id:o.parent_id}));const r=o?this.getRecordUrlWithoutDomainWithPageVisitSource({table:"block",value:o,getRecordValue:this.getRecordValue}):A._j.root;return"block-deleted"===e.type?e.block_data.block_value.type===m.ZP.page?n()(ze.Z,{href:r,onClick:()=>this.track("block_edit"),innerStyle:this.getEditButtonStyle()},t,n()(Ye.Z,{edit:e,rootStore:this.props.rootStore})):n()("div",{style:this.getEditButtonStyle()},t,n()(Ye.Z,{edit:e,rootStore:this.props.rootStore})):n()(ze.Z,{href:r,onClick:()=>this.track("block_edit"),innerStyle:this.getEditButtonStyle()},t,n()(Ye.Z,{edit:e,rootStore:this.props.rootStore}))},this.renderBlockPropertyEdit=(e,t,i)=>{let o=this.getRecordValue({table:_.iU,id:e.block_id});o&&o.type===m.ZP.tableRow&&(o=this.getRecordValue({table:_.iU,id:o.parent_id}));const r=o?(0,g.Om)({table:"block",value:o,getRecordValue:this.getRecordValue}):A._j.root;return n()(ze.Z,{href:r,onClick:()=>this.track("block_edit"),innerStyle:this.getEditButtonStyle()},t,n()(Ye.Z,{edit:e,rootStore:this.props.rootStore}))},this.renderCollectionPropertyEdit=(e,t)=>{if("collection-property-changed"===e.type)return n()(ze.Z,{href:t,innerStyle:this.getEditButtonStyle()},void 0,n()(Ye.Z,{edit:e,rootStore:this.props.rootStore}))},this.handleUnarchive=()=>{const{notification:e,rootStore:t}=this.props;e&&(K.createAndCommit({userAction:"Activity.handleUnarchive",environment:this.environment,perform:i=>{W.E1({notificationId:e.id,visited:!1,rootStore:t,transaction:i})}}),V.F5(this.getBaseNotificationArgs()))},this.getRecordStore=e=>this.props.rootStore.getRecordStore(this.props.rootStore,e),this.getUserValue=e=>te.U6.createChildStore(this.props.rootStore,{table:C.KJ,id:e}).getValue(),this.getBotValue=e=>(0,te.Kv)(this.props.rootStore,{table:M.cZ,id:e}).getValue(),this.getAuthorActor=e=>{if(e.table===C.KJ){const t=this.getUserValue(e.id);if(t)return(0,u.dp)(t)}else{const t=this.getBotValue(e.id);if(t)return(0,u.D$)(t)}},this.getSpaceStore=e=>te.H2.createChildStore(this.props.rootStore,{table:B.bx,id:e}),this.getTeamStore=e=>te.zX.createChildStore(this.props.rootStore,{table:J.e0,id:e}),this.handleMarkAsReadClicked=e=>{V.cC({...this.getBaseNotificationArgs(),from:e})},this.handleMarkAsUnreadClicked=()=>{V.u_(this.getBaseNotificationArgs())},this.getDiscussionLocation=e=>{let{forReplyMenu:t}=e;const{source:i}=this.props;if("updates_sidebar"===i)return t?"reply_menu_updates_sidebar":"updates_sidebar";return`${t?"reply_menu_":"updates_menu_"}${V.Jn()}`},this.getDiscussionContextAndId=()=>{const{activity:e}=this.props;if("commented"!==e.type)return;const t=this.getRecordValue({table:R.qF,id:e.discussion_id,spaceId:e.space_id});if(!t)return;if(!t.context)return;const i=(0,x.VP)(t.context,(e=>!(0,x.xw)(e)||(0,x.h1)(e)===t.id));return{id:t.id,context:i}},this.getDiscussionContext=()=>{const e=this.getDiscussionContextAndId();if(e)return e.context},this.handleTrackBacklinkClick=this.handleTrackBacklinkClick.bind(this),this.handleTrackArchiveClicked=this.handleTrackArchiveClicked.bind(this)}willMountOrUpdate(){this.warmCommentData(),this.environment.KatexStore.loadIfNeeded(this.getDiscussionContext)}warmCommentData(){if("commented"===this.props.activity.type){const e=this.getRecordStore({table:R.qF,id:this.props.activity.discussion_id,spaceId:this.props.activity.space_id});if(e.isDefined()){const t=e.getCommentStores();for(const e of t)if(e.isDefined()&&e.getCreatedByTable()&&e.getCreatedById()){this.getRecordStore(e.getCreatedByPointer()).load()}}}}renderComponent(){const{activity:e}=this.props;switch(e.type){case"block-edited":return this.renderBlockEditActivity(e);case"block-property-edited":return this.renderBlockPropertyEditActivity(e);case"collection-row-created":case"collection-row-deleted":return this.renderCollectionRowActivity(e);case"top-level-block-created":case"top-level-block-deleted":return this.renderTopLevelBlockActivity(e);case"permissions-edited":return this.renderPermissionsActivity(e);case"permission-group-edited":return this.renderPermissionGroupActivity(e);case"user-mentioned":return this.renderMentionActivity(e);case"commented":return this.renderCommentActivity(e);case"user-invited":return this.renderUserInvitedActivity(e);case"collection-edited":return this.renderCollectionEdited(e);case"collection-view-edited":return this.renderCollectionViewEdited(e);case"collection-property-edited":return this.renderCollectionPropertyEdited(e);case"reminder":return this.renderReminderActivity(e);case"page-locked":case"page-unlocked":return this.renderPageLockActivity(e);case"email-edited":return this.renderEmailEdited(e);case"access-requested":return this.renderAccessRequested(e);case"page-deleted":case"page-restored":case"page-permanently-deleted":return this.renderPageDeleteOrRestoreActivity(e);case"team-membership-edited":return this.renderTeamMembershipEditedActivity(e);case"private-content-transferred":return this.renderPrivateContentTransferredActivity(e);case"permission-group-mentioned":return this.renderGroupMentionedActivity(e);case"verification-expired":return this.renderVerificationExpiredActivity(e);default:(0,Z.t1)(e)}}getRecordUrlWithoutDomainWithPageVisitSource(e){return(0,q.SK)((0,g.Om)(e),{[p.$X]:p.tY.Notification})}renderBlockEditActivity(e){if(!e.edits)return;const t=(0,N.hI)(e.edits).filter((e=>{const{block_value:t}="block-changed"===e.type?e.block_data.after:e.block_data;return t.parent_table!==w.x_}));if(0===t.length)return;const i=this.getBlockStore(t[0].navigable_block_id);if(!i.isDefined())return;const o=this.getAuthors(t),s=xe(o),a=this.renderTitle("block",i);return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {pageTitle}} other {{authorOrAuthors} edited {pageTitle}}}",id:"activity.blockEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)",values:{numberOfAuthors:o.length,authorOrAuthors:s,pageTitle:a}})),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.notification,icon:n()(Ie,{authors:o}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),n()(ut,{visible:5,items:t.map(this.renderBlockEdit)}),this.renderNotificationActions())}renderBlockPropertyEditActivity(e){if(!e.edits)return;const t=(0,N.hI)(e.edits);if(0===t.length)return;const i=this.getBlockStore(t[0].navigable_block_id);if(!i.isDefined())return;const o=this.getAuthors(t),s=xe(o),a=this.renderTitle("block",i);return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {pageTitle}} other {{authorOrAuthors} edited {pageTitle}}}",id:"activity.blockEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)",values:{numberOfAuthors:o.length,authorOrAuthors:s,pageTitle:a}})),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.notification,icon:n()(Ie,{authors:o}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),n()(ut,{visible:5,items:t.map(this.renderBlockPropertyEdit)}),this.renderNotificationActions())}renderCollectionRowActivity(e){if(!e.edits)return;const t=e.edits[0],i=this.getBlockStore(e.collection_row_id);if(!i.isDefined())return;if(!i.getProperties())return;const o=this.getAuthors(e.edits),s=xe(o),a=this.renderTitle("block",i),d="collection-row-created"===t.type?n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created {pageTitle}} other {{authorOrAuthors} created {pageTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:s,pageTitle:a},id:"activity.collectionRowCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted {pageTitle}} other {{authorOrAuthors} deleted {pageTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:s,pageTitle:a},id:"activity.collectionRowDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,d),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.notification,icon:n()(Ie,{authors:o}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),this.renderNotificationActions())}renderTopLevelBlockActivity(e){if(!e.edits)return;const t=e.edits[0],i=this.getBlockStore(e.top_level_block_id);if(!i.isDefined())return;const o=i.hasSpacePermission(),s=this.getAuthors(e.edits),a=xe(s),d=this.renderTitle("block",i);let c;return c=o?"top-level-block-created"===t.type?n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created workspace page {pageTitle}} other {{authorOrAuthors} created workspace page {pageTitle}}}",values:{numberOfAuthors:s.length,authorOrAuthors:a,pageTitle:d},id:"activity.topLevelBlockWorkspaceCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted workspace page {pageTitle}} other {{authorOrAuthors} deleted workspace page {pageTitle}}}",values:{numberOfAuthors:s.length,authorOrAuthors:a,pageTitle:d},id:"activity.topLevelBlockWorkspaceDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"top-level-block-created"===t.type?n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created private page {pageTitle}} other {{authorOrAuthors} created private page {pageTitle}}}",values:{numberOfAuthors:s.length,authorOrAuthors:a,pageTitle:d},id:"activity.topLevelBlockPrivateCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted private page {pageTitle}} other {{authorOrAuthors} deleted private page {pageTitle}}}",values:{numberOfAuthors:s.length,authorOrAuthors:a,pageTitle:d},id:"activity.topLevelBlockPrivateDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,c),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,notification:this.props.notification,icon:n()(Ie,{authors:s}),showSnapshotButton:!1},this.getActivitySectionHandlers()))}renderPermissionsActivity(e){if(!e.edits)return;const t=(0,N.hI)(e.edits);if(0===t.length)return;let i,o;const s=t[0];if(s.navigable_block_id){const e=this.getBlockStore(s.navigable_block_id);if(!e.isDefined())return;o=this.renderTitle("block",e),i=this.getIsRecordPrivateToUser(e.id,"block")}else{const e=this.getSpaceStore(s.space_id);if(!e.isDefined())return;o=this.renderTitle("space",e),i=this.getIsRecordPrivateToUser(s.space_id,"space")}const{autojoinEdits:a,inheritanceEdits:d,otherEdits:c}=l.md(e.edits),u=[];a.forEach(((e,t)=>{const s=this.getAuthors([e]),a=xe(s);u.push(h.createElement(Ze,r()({key:`autojoin-${t}`,timestamp:e.timestamp,header:n()("span",{},void 0,n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} joined {pageOrSpaceName}} other {{authorOrAuthors} joined {pageOrSpaceName}}}",values:{numberOfAuthors:s.length,authorOrAuthors:a,pageOrSpaceName:o},id:"activity.permissionsActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:this.props.isLast,isPrivate:i,rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:n()(Ie,{authors:s}),showSnapshotButton:!1},this.getActivitySectionHandlers())))})),d.forEach(((t,s)=>{const a=this.getAuthors([t]),d=xe(a);let c;"permission-restriction-created"===t.type?c=n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restricted access for {pageOrSpaceName}} other {{authorOrAuthors} restricted access for {pageOrSpaceName}}}{inSudoMode, select, true { using administrator privileges} other {}}",values:{numberOfAuthors:a.length,authorOrAuthors:d,pageOrSpaceName:o,inSudoMode:t.inSudoMode},id:"activity.restrictPermissionsForActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"permission-restriction-deleted"===t.type&&(c=n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restored inherited access for {pageOrSpaceName}} other {{authorOrAuthors} restored inherited access for {pageOrSpaceName}}}{inSudoMode, select, true { using administrator privileges} other {}}",values:{numberOfAuthors:a.length,authorOrAuthors:d,pageOrSpaceName:o,inSudoMode:t.inSudoMode},id:"activity.restorePermissionsForActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),u.push(h.createElement(Ze,r()({key:`inheritance-${s}`,timestamp:parseInt(e.end_time),header:n()("span",{},void 0,c),isLast:this.props.isLast,isPrivate:i,rootStore:this.props.rootStore,navigableBlockId:t.navigable_block_id,notification:this.props.notification,icon:n()(Ie,{authors:a}),showSnapshotButton:!1},this.getActivitySectionHandlers()),n()("div",{style:this.getEditButtonStyle()},void 0,n()(Ye.Z,{edit:t,rootStore:this.props.rootStore})),this.renderNotificationActions()))}));const p=(t,o,a)=>{if(t.length>0){const d=this.getAuthors(t);u.push(h.createElement(Ze,r()({key:o,timestamp:parseInt(e.end_time),header:a,isLast:this.props.isLast,isPrivate:i,rootStore:this.props.rootStore,navigableBlockId:s.navigable_block_id,notification:this.props.notification,icon:n()(Ie,{authors:d}),showSnapshotButton:!1},this.getActivitySectionHandlers()),t.map(((e,t,i)=>n()("div",{style:this.getEditButtonStyle()},t,n()(Ye.Z,{edit:e,rootStore:this.props.rootStore},t)))),this.renderNotificationActions()))}},g=c.filter((e=>!e.inSudoMode));if(g.length>0){const e=this.getAuthors(g),t=xe(e);p(g,"other",n()("span",{},void 0,n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated permission for {pageOrSpaceName}} other {{authorOrAuthors} updated permission for {pageOrSpaceName}}}",values:{numberOfAuthors:e.length,authorOrAuthors:t,pageOrSpaceName:o},id:"activity.updatedPermissionsForActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})))}const m=c.filter((e=>e.inSudoMode));if(m.length>0){const e=this.getAuthors(m),t=xe(e);p(m,"other-sudo",n()("span",{},void 0,n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated permission for {pageOrSpaceName}} other {{authorOrAuthors} updated permission for {pageOrSpaceName}}} using administrator privileges",values:{numberOfAuthors:e.length,authorOrAuthors:t,pageOrSpaceName:o},id:"activity.updatedPermissionsForActivityInSudoMode.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})))}return u}renderPermissionGroupActivity(e){if(!e.edits)return;const t=(0,N.hI)(e.edits)[0];if(!t)return;const i=this.getSpaceStore(t.space_id);if(!i.isDefined())return;const o=this.getRecordUrlWithoutDomainWithPageVisitSource({table:"space",model:i.getModel(),getRecordModel:this.getRecordModel}),s=this.renderPermissionGroupTitle((0,y.c_)({activity:e,getRecordValue:this.getRecordValue}),e.space_id),a=this.getAuthors(e.edits);return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,this.renderPermissionGroupEditedHeader({activity:e,authors:a,groupName:s})),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.space_id,"space"),rootStore:this.props.rootStore,notification:this.props.notification,icon:n()(Ie,{authors:a}),showSnapshotButton:!1},this.getActivitySectionHandlers()),n()(ze.Z,{href:o,onClick:()=>this.track("group_edit"),innerStyle:this.getEditButtonStyle()},void 0,n()(Ye.Z,{edit:t,rootStore:this.props.rootStore})),this.renderNotificationActions())}renderMentionActivity(e){if(!e.edits)return;const t=e.edits[0],i=this.getBlockStore(t.navigable_block_id);if(!i.isDefined())return;const o=this.getBlockStore(e.mentioned_block_id);if(!o.isDefined())return;const s=this.getRecordUrlWithoutDomainWithPageVisitSource({table:"block",model:o.getModel(),getRecordModel:this.getRecordModel}),a=this.getAuthors(e.edits),d=xe(a);return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in {pageName}} other {{authorOrAuthors} mentioned you in {pageName}}}",values:{numberOfAuthors:a.length,authorOrAuthors:d,pageName:this.renderTitle("block",i)},id:"activity.mentionActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.notification,icon:n()(Ie,{authors:a}),showSnapshotButton:!1},this.getActivitySectionHandlers()),n()(ze.Z,{href:s,onClick:()=>this.track("mention_edit"),innerStyle:this.getEditButtonStyle()},void 0,n()(Ye.Z,{edit:t,rootStore:this.props.rootStore})),this.renderNotificationActions())}renderGroupMentionedActivity(e){if(!e.edits)return;const t=e.edits[0],i=this.getBlockStore(t.navigable_block_id);if(!i)return;const o=this.getBlockStore(e.mentioned_block_id);if(!o.isDefined())return;const s=this.getRecordUrlWithoutDomainWithPageVisitSource({table:"block",model:o.getModel(),getRecordModel:this.getRecordModel}),a=this.getSpaceStore(e.space_id).getValue(),d=(0,P.mX)(Y.default.getIntl(),a,e.mentioned_group_id),c=this.getAuthors(e.edits),l=xe(c);return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,n()(U.FormattedMessage,{defaultMessage:"{authorOrAuthors} mentioned {groupName} in {pageName}",values:{authorOrAuthors:l,pageName:this.renderTitle("block",i),groupName:d},id:"activity.groupMentionActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.notification,icon:n()(Ie,{authors:c}),showSnapshotButton:!1},this.getActivitySectionHandlers()),n()(ze.Z,{href:s,onClick:()=>this.track("mention_edit"),innerStyle:this.getEditButtonStyle()},void 0,n()(Ye.Z,{edit:t,rootStore:this.props.rootStore})),this.renderNotificationActions())}renderCommentActivity(e){if(!e.edits)return;let t=e.edits.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":return!0;default:(0,Z.t1)(e)}}));if(0===t.length&&0!==e.edits.length&&"updates_sidebar"!==this.props.source&&(t=e.edits),0===t.length)return;const i=this.getRecordStore({table:R.qF,id:e.discussion_id,spaceId:e.space_id});if(!i.isDefined())return;const o=te.G.createChildStore(this.props.rootStore,i.getParentPointer()),s=(0,X.qA)(o),a=(0,X.fl)(s);if(!o.isDefined())return;const d=this.getBlockStore(e.navigable_block_id);if(!d.isDefined())return;const c=a?this.getRecordUrlWithoutDomainWithPageVisitSource({table:"block",model:o.getModel(),getRecordModel:this.getRecordModel,discussionId:e.discussion_id}):void 0,l=this.getAuthors(t),u=xe(l),p=t=>{if(this.track("comment_edit"),!a){var r;const s=t.target;G.oK({environment:this.environment,discussionStore:i,rect:s.getBoundingClientRect(),blockStore:o,discussionLocation:this.getDiscussionLocation({forReplyMenu:!0}),activityId:e.id,notificationId:null===(r=this.props.notification)||void 0===r?void 0:r.id})}};return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented in {blockName}} other {{authorOrAuthors} commented in {blockName}}}",values:{numberOfAuthors:l.length,authorOrAuthors:u,blockName:this.renderTitle("block",d)},id:"activity.commentActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.navigable_block_id,"block"),rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:n()(Ie,{authors:l}),showSnapshotButton:!1},this.getActivitySectionHandlers()),this.renderCommentContext({activity:e,url:c,onClick:p}),n()(ut,{visible:5,items:t.map(((e,t,i)=>n()(ze.Z,{onClick:p,href:c,innerStyle:this.getEditButtonStyle()},t,n()(Ye.Z,{edit:e,rootStore:this.props.rootStore,type:"comment-edit",discussionLocation:this.getDiscussionLocation({forReplyMenu:!1})}))))}),this.getCommentActions(e))}renderCommentContext(e){const{url:t,onClick:i}=e,o=this.getDiscussionContextAndId();if(!o)return;const{id:r,context:s}=o,a=0===(0,x.ll)(s).length,d=(0,$.IY)({environment:this.environment,textValue:{value:s,spaceId:this.props.activity.space_id},parentStore:this.props.rootStore,disableHover:!0,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,highlightDiscussionId:r,theme:this.theme,emojiType:(0,j.e)(this.environment),katex:this.environment.KatexStore.getKatex(),formulaValueTypes:[]});return n()(ze.Z,{href:t,onClick:i,innerStyle:{...this.getEditButtonStyle(),display:"flex",alignItems:"flex-start",fontSize:14,...a&&{color:this.theme.mediumTextColor},paddingTop:2,paddingBottom:6,marginBottom:0}},void 0,a&&n()("div",{style:{flexShrink:0,alignSelf:"center",width:3,borderRadius:3,marginLeft:2,marginRight:8,height:20,background:f.DB}}),n()("div",{style:{...L.Z.textOverflowStyle}},void 0,d))}getCommentActions(e){const t=this.getRecordValue({table:R.qF,id:e.discussion_id,spaceId:e.space_id});if(!t)return;const i=te.t1.createChildStore(this.props.rootStore,{table:R.qF,id:t.id,spaceId:(0,S.CG)(this.props.rootStore.pointer.spaceId)}),o=te.G.createChildStore(this.props.rootStore,{table:_.iU,id:t.parent_id});return n()("div",{style:{paddingLeft:this.getActivityContentLeftPadding(),paddingTop:12,paddingBottom:4}},void 0,n()(Fe.Z,{onClick:t=>{var r;const s=t.target;G.oK({environment:this.environment,discussionStore:i,rect:s.getBoundingClientRect(),blockStore:o,discussionLocation:this.getDiscussionLocation({forReplyMenu:!0}),activityId:e.id,notificationId:null===(r=this.props.notification)||void 0===r?void 0:r.id})},style:this.getActionButtonStyle()},void 0,n()(U.FormattedMessage,{defaultMessage:"Reply",id:"activity.replyButton.label"})),this.canUnarchive()&&h.createElement(h.Fragment,null,pt,this.renderUnarchiveButton()))}renderAccessRequestedActions(e){const{rootStore:t}=this.props;if(!(e.edits||[])[0])return;const i=this.getRecordStore({table:k.J8,id:e.access_request_id});if(!i.isDefined())return;const o=i.getParentTable(),r=i.getParentId();switch(o){case _.iU:const e=te.G.createChildStore(t,{table:o,id:r});if(!e.canAdmin())return;return n()("div",{style:this.getActionPrimaryContainerStyle()},void 0,n()(nt,{accessRequestStore:i,targetBlockStore:e,initialRole:"reader",buttonStyle:this.getActionButtonStyle(),notification:this.props.notification}));case B.bx:const s=te.H2.createChildStore(t,{table:o,id:r});return n()("div",{style:this.getActionPrimaryContainerStyle()},void 0,n()(Ge,{accessRequestStore:i,spaceStore:s,initialRole:"reader",buttonStyle:this.getActionButtonStyle(),notification:this.props.notification}));case J.e0:const a=te.zX.createChildStore(t,{table:o,id:r});return n()("div",{style:this.getActionPrimaryContainerStyle()},void 0,n()(ht,{accessRequestStore:i,teamStore:a}));default:(0,Z.t1)(o)}}renderUnarchiveButton(){return n()(Fe.Z,{onClick:this.handleUnarchive,style:this.getActionSecondaryButtonStyle()},void 0,n()(U.FormattedMessage,{defaultMessage:"Unarchive",id:"activity.actions.unarchiveButton.label"}))}renderNotificationActions(){if(this.canUnarchive())return n()("div",{style:this.getActionContainerStyle()},void 0,this.renderUnarchiveButton())}renderUserInvitedActivity(e){if(!e.edits)return;let t,i,o;const s=this.getAuthors(e.edits),a=xe(s),d=0===s.filter(u.uC).length,c=parseInt(e.end_time),l=e.edits[0];if(l.navigable_block_id){const r=this.getBlockStore(l.navigable_block_id);if(!r.isDefined())return;const h=this.renderTitle("block",r),u=(0,I.$e)(r.getModel(),e);if(u){const t=this.getRecordValue({table:D.Tu,id:u,spaceId:e.space_id});t&&t.message&&t.created_time<=c+5*E.hM&&(o={message:null==t?void 0:t.message,url:this.getRecordUrlWithoutDomainWithPageVisitSource({table:_.iU,model:r.getModel(),getRecordModel:this.getRecordModel})})}i=n()(U.FormattedMessage,d?{defaultMessage:"You have been invited to {blockName}",values:{blockName:h},id:"activity.userInvitedActivityNavigableBlockByBot.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to {blockName}} other {{authorOrAuthors} invited you to {blockName}}}",values:{numberOfAuthors:s.length,authorOrAuthors:a,blockName:h},id:"activity.userInvitedActivityNavigableBlock.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),t=this.getIsRecordPrivateToUser(r.id,"block")}else if(l.permission_group_id){const e=(0,y.Bg)({spaceId:l.space_id,permissionGroupId:l.permission_group_id,getRecordValue:this.getRecordValue}),o=this.renderPermissionGroupTitle(e,l.space_id);i=n()(U.FormattedMessage,d?{defaultMessage:"You have been added to group {groupName}",values:{groupName:o},id:"activity.userInvitedActivityGroupIdByBot.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to group {groupName}} other {{authorOrAuthors} added you to group {groupName}}}",values:{numberOfAuthors:s.length,authorOrAuthors:a,groupName:o},id:"activity.userInvitedActivityGroupId.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),t=this.getIsRecordPrivateToUser(l.space_id,"space")}else{const e=this.getSpaceStore(l.space_id);if(!e)return;const o=this.renderTitle("space",e);i=n()(U.FormattedMessage,d?{defaultMessage:"You have been invited to {spaceName}",values:{spaceName:o},id:"activity.userInvitedActivityOtherInviteByBot.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to {spaceName}} other {{authorOrAuthors} invited you to {spaceName}}}",values:{numberOfAuthors:s.length,authorOrAuthors:a,spaceName:o},id:"activity.userInvitedActivityOtherInvite.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),t=this.getIsRecordPrivateToUser(l.space_id,"space")}const p=d?void 0:n()(Ie,{authors:s});return h.createElement(Ze,r()({timestamp:c,header:n()("span",{},void 0,i),isLast:this.props.isLast,isPrivate:t,rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:p,showSnapshotButton:!1},this.getActivitySectionHandlers()),o&&n()(ze.Z,{href:o.url,onClick:()=>this.track("click_user_invited"),innerStyle:this.getInviteMessageStyle()},void 0,o.message))}renderTeamMembershipEditedActivity(e){if(!e.edits)return;const t=this.getAuthors(e.edits),i=xe(t),o=e.edits[0],s=this.getTeamStore(o.team_id);if(!s.isDefined())return;const a=this.renderTeamTitle("team",s),d=n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to teamspace {teamName}} other {{authorOrAuthors} invited you to {teamName}}}",values:{numberOfAuthors:t.length,authorOrAuthors:i,teamName:a},id:"activity.userInvitedToTeamActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,d),isLast:this.props.isLast,isPrivate:!1,rootStore:this.props.rootStore,notification:this.props.notification,icon:n()(Ie,{authors:t}),showSnapshotButton:!1},this.getActivitySectionHandlers()))}renderPrivateContentTransferredActivity(e){if(!e.edits)return;const t=e.edits[0],i=t.from_user_id,o=this.getRecordValue({table:C.KJ,id:i});if(!o)return;const s=t.to_user_id;if(!this.getRecordValue({table:C.KJ,id:s}))return;const a=this.getBlockStore(e.navigable_block_id);if(!a.isDefined())return;const d=(0,u.$4)(Y.default.getIntl(),{table:C.KJ,value:o}),c=this.getAuthors(e.edits),l=xe(c),p=n()(U.FormattedMessage,{defaultMessage:"{authorPhrase} transferred private content from {fromUserName} to you: {pageName}",values:{authorPhrase:l,fromUserName:d,pageName:this.renderTitle("block",a)},id:"activity.privateContentTransferred.header",description:"Notification header for when private content is transferred from one user to another."});return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:p,isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(a.id,"block"),rootStore:this.props.rootStore,notification:this.props.notification,icon:n()(Ie,{authors:c}),showSnapshotButton:!1},this.getActivitySectionHandlers()))}renderVerificationExpiredActivity(e){const t=this.getBlockStore(e.navigable_block_id);if(!t.isDefined())return;const i=this.getRecordStore({table:T.v,id:e.collection_id,spaceId:e.space_id});if(!i.isDefined())return;const o=n()(U.FormattedMessage,{defaultMessage:"Verification expired for <boldtext>{pageTitle}</boldtext>",values:{pageTitle:this.renderTitle("block",t),boldtext:e=>n()("span",{style:{fontWeight:500}},void 0,e)},id:"activity.verificationExpired.header",description:"Notification header for when verification for a page has expired."});let s=n()(U.FormattedMessage,{id:"Activity.author.unknown",defaultMessage:"Unknown",description:"Label for a user when the user info is unknown for some reason"});const a=i.getSchema(),d=Object.keys(a).find((e=>{var t;return"verification"===(null===(t=a[e])||void 0===t?void 0:t.type)}));if(d){const e=t.getPropertyValue(d),i=v._w(e);if(i){const e=i[0],t=(0,u.Hl)({pointer:e,getRecordValue:this.getRecordValue});t.value&&(s=xe([t]))}}const c=parseInt(e.start_time),l=parseInt(e.end_time);return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:o,isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(t.id,"block"),rootStore:i,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:n()(Ne,{}),showSnapshotButton:!1},this.getActivitySectionHandlers()),n()("div",{style:{fontSize:14,...this.getEditButtonStyle()}},void 0,n()(U.FormattedMessage,c&&l?{defaultMessage:"Last verified by {person} from {startDate} to {endDate}",values:{person:s,startDate:(0,ee.gs)(parseInt(e.start_time)),endDate:(0,ee.gs)(parseInt(e.end_time))},id:"activity.verificationExpired.contentWithTimestamp",description:"Notification content for when verification for a page has expired, to show who last verified it and when."}:{defaultMessage:"Last verified by {person}",values:{person:s},id:"activity.verificationExpired.contentWithoutTimestamp",description:"Notification content for when verification for a page has expired, to show who last verified it."})),n()("div",{style:this.getActionContainerStyle()},void 0,this.canUnarchive()&&this.renderUnarchiveButton()))}renderCollectionEdited(e){if(!e.edits)return;const t=this.getRecordStore({table:T.v,id:e.collection_id,spaceId:e.space_id});if(!t.isDefined())return;const i=e.edits[0];if(!i)return;const o=this.getRecordUrlWithoutDomainWithPageVisitSource({table:T.v,model:t.getModel(),getRecordModel:this.getRecordModel}),s=this.getAuthors(e.edits),a=xe(s),d=this.renderTitle("collection",t),c="collection-created"===i.type?n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created {collectionTitle}} other {{authorOrAuthors} created {collectionTitle}}}",values:{numberOfAuthors:s.length,authorOrAuthors:a,collectionTitle:d},id:"activity.collectionCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {collectionTitle}} other {{authorOrAuthors} edited {collectionTitle}}}",values:{numberOfAuthors:s.length,authorOrAuthors:a,collectionTitle:d},id:"activity.collectionEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,c),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.collection_id,"collection"),rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:n()(Ie,{authors:s}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),l.OC(i)&&this.renderCollectionDescriptionEdit(i,o),this.renderNotificationActions())}renderCollectionDescriptionEdit(e,t){return n()(ze.Z,{href:t,innerStyle:this.getEditButtonStyle()},void 0,n()(Ye.Z,{edit:e,rootStore:this.props.rootStore}))}renderCollectionViewEdited(e){if(!e.edits)return;const t=this.getRecordStore({table:T.v,id:e.collection_id,spaceId:e.space_id});if(!t.isDefined())return;const i=this.getRecordStore({table:O.n,id:e.collection_view_id,spaceId:e.space_id});if(!i.isDefined())return;const o=(0,N.hI)(e.edits)[0];if(!o)return;const s=this.renderCollectionViewTitle(i),a=this.renderTitle("collection",t),d=this.getAuthors(e.edits),c=xe(d);let l;return l="collection-view-created"===o.type?n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} created view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:c,collectionTitle:a,collectionViewTitle:s},id:"activity.collectionViewCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"collection-view-deleted"===o.type?n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} deleted view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:c,collectionTitle:a,collectionViewTitle:s},id:"activity.collectionViewDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} edited view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:c,collectionTitle:a,collectionViewTitle:s},id:"activity.collectionViewEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,l),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.collection_id,"collection"),rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:n()(Ie,{authors:d}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),this.renderNotificationActions())}renderCollectionPropertyEdited(e){if(!e.edits)return;const t=(0,N.hI)(e.edits),i=t[0];if(!i)return;const o=this.getRecordStore({table:T.v,id:e.collection_id,spaceId:e.space_id});if(!o.isDefined())return;const s=this.getRecordUrlWithoutDomainWithPageVisitSource({table:T.v,model:o.getModel(),getRecordModel:this.getRecordModel}),a="collection-property-changed"===i.type?i.collection_property_data.after:i.collection_property_data,d=this.getAuthors(e.edits),c=xe(d),l=this.renderTitle("collection",o),u=this.renderCollectionPropertyTitle(a);let p;return p="collection-property-created"===i.type?n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} created property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:c,collectionTitle:l,collectionPropertyTitle:u},id:"activity.collectionPropertyCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"collection-property-deleted"===i.type?n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} deleted property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:c,collectionTitle:l,collectionPropertyTitle:u},id:"activity.collectionPropertyDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} edited property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:c,collectionTitle:l,collectionPropertyTitle:u},id:"activity.collectionPropertyEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,p),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.collection_id,"collection"),rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:n()(Ie,{authors:d}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),n()(ut,{visible:5,items:t.map((e=>this.renderCollectionPropertyEdit(e,s)))}),this.renderNotificationActions())}renderReminderActivity(e){if(!e.edits)return;const t=e.edits[0],i=this.getBlockStore(t.navigable_block_id);if(!i.isDefined())return;const o=this.getBlockStore(e.reminder_block_id);if(!o.isDefined())return;const s=this.getRecordUrlWithoutDomainWithPageVisitSource({table:"block",model:o.getModel(),getRecordModel:this.getRecordModel});return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,n()(U.FormattedMessage,{defaultMessage:"Reminder in {pageTitle}",id:"activity.reminderInActivity.header",values:{pageTitle:this.renderTitle("block",i)}})),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.notification,icon:n()(Pe,{}),showSnapshotButton:!1},this.getActivitySectionHandlers()),n()(ze.Z,{href:s,onClick:()=>this.track("reminder_edit"),innerStyle:this.getEditButtonStyle()},void 0,n()(Ye.Z,{edit:t,rootStore:this.props.rootStore})),this.renderNotificationActions())}renderPageLockActivity(e){if(!e.edits)return;const t=e.edits[0],i=this.getBlockStore(t.navigable_block_id);if(!i.isDefined())return;const o=this.getAuthors(e.edits),s=xe(o),a=this.renderTitle("block",i),d="page-locked"===e.type?n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} locked {blockTitle}} other {{authorOrAuthors} locked {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:s,blockTitle:a},id:"activity.pageLocked.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} unlocked {blockTitle}} other {{authorOrAuthors} unlocked {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:s,blockTitle:a},id:"activity.pageUnlocked.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,d),isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),isLast:this.props.isLast,rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.notification,icon:n()(Ie,{authors:o}),showSnapshotButton:!1},this.getActivitySectionHandlers()),this.renderNotificationActions())}renderEmailEdited(e){if(!e.edits)return;const t=e.edits[0];if(!t)return;const i=this.getAuthors(e.edits),o=xe(i);return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} changed email from {oldEmail} to {newEmail}} other {{authorOrAuthors} changed email from {oldEmail} to {newEmail}}}",values:{numberOfAuthors:i.length,authorOrAuthors:o,oldEmail:t.old_email,newEmail:t.new_email},id:"activity.emailEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:this.props.isLast,isPrivate:!1,rootStore:this.props.rootStore,notification:this.props.notification,icon:n()(Ie,{authors:i}),showSnapshotButton:!1},this.getActivitySectionHandlers()))}getAccessRequestHeader(e,t){const i=t.parent_table;switch(i){case B.bx:return this.renderMembershipRequestHeader(e);case J.e0:return this.renderTeamMembershipRequestHeader(e);case _.iU:return this.renderAccessRequestedHeader(e);default:(0,Z.t1)(i)}}renderTeamMembershipRequestHeader(e){if(!e.edits||!e.team_id)return;const t=xe(this.getAuthors(e.edits)),i=this.getTeamStore(e.team_id);return n()(U.FormattedMessage,{defaultMessage:"{user} requested to become a member of {teamName}",values:{user:n()("span",{style:{fontWeight:L.Z.fontWeight.semibold}},void 0,t),teamName:n()("span",{style:{fontWeight:L.Z.fontWeight.semibold}},void 0,i.getName())},id:"activity.teamAccessRequest.header",description:"Notification header describing that a user created a team access request."})}renderMembershipRequestHeader(e){if(!e.edits)return;const t=this.getRecordValue({table:k.J8,id:e.access_request_id});if(!t||t.for_actor_table!==C.KJ)return;const i=this.getRecordValue({table:t.for_actor_table,id:t.for_actor_id});if(!i)return;if(t.for_actor_id===t.created_by_id){const e=i.name?`${i.name} (${i.email})`:i.email;return n()(U.FormattedMessage,{defaultMessage:"{invitee} requested to become a workspace member",values:{invitee:n()("span",{style:{fontWeight:L.Z.fontWeight.semibold}},void 0,e)},id:"activity.accessRequestedMembershipFromGuest.header",description:"Notification header describing that a user created a membership request for themself."})}const o=this.getAuthors(e.edits),r=xe(o);return n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested {invitee} to become a workspace member} other {{authorOrAuthors} requested {invitee} to become a workspace member}}",values:{numberOfAuthors:o.length,authorOrAuthors:r,invitee:n()("span",{style:{fontWeight:L.Z.fontWeight.semibold}},void 0,i.email)},id:"activity.accessRequestedMembership.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}renderAccessRequestedHeader(e){if(!e.edits)return;if(!e.navigable_block_id)return;const t=this.getBlockStore(e.navigable_block_id);if(!t.isDefined())return;const i=this.getAuthors(e.edits),o=xe(i);return n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested access to {pageName}} other {{authorOrAuthors} requested access to {pageName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:o,pageName:this.renderTitle(_.iU,t)},id:"activity.accessRequested.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}renderAccessRequested(e){if(!e.edits)return;const t=e.edits[0];if(!t)return;const i=this.getRecordValue({table:k.J8,id:e.access_request_id});if(!i)return;if(i.parent_table===B.bx&&!(0,z.p1)())return;const o=this.getAccessRequestHeader(e,i),{message:s}=t,a=this.getAuthors(e.edits),d=xe(a);return h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,o),isLast:this.props.isLast,isPrivate:!1,rootStore:this.props.rootStore,notification:this.props.notification,icon:n()(Ie,{authors:a}),showSnapshotButton:!1},this.getActivitySectionHandlers()),s&&n()("div",{style:{paddingLeft:this.getActivityContentLeftPadding(),paddingRight:16,marginTop:8,marginBottom:8}},void 0,n()(Ve.Z,{isSmall:!0},void 0,n()(U.FormattedMessage,{id:"activity.accessRequested.messageLabel",defaultMessage:"Message from {author}",values:{author:d}})),n()(Ve.Z,{isMultiline:!0,style:{whiteSpace:"pre-wrap"}},void 0,s)),this.renderAccessRequestedActions(e),this.renderNotificationActions())}renderPageDeleteOrRestoreActivity(e){if(!e.edits)return;const t=e.edits[0];if(!t)return;const i=this.getRecordStore({table:_.iU,id:t.navigable_block_id,spaceId:t.space_id});if(!i.isDefined())return;const o=this.getAuthors(e.edits),s=xe(o),a=this.renderTitle(_.iU,i);let d;return"page-deleted"===e.type?d=n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted {blockTitle}} other {{authorOrAuthors} deleted {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:s,blockTitle:a},id:"emailActivity.pageDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"page-restored"===e.type?d=n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restored {blockTitle}} other {{authorOrAuthors} restored {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:s,blockTitle:a},id:"emailActivity.pageRestored.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"page-permanently-deleted"===e.type?d=n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} permanently deleted {blockTitle}} other {{authorOrAuthors} permanently deleted {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:s,blockTitle:a},id:"emailActivity.pagePermanentlyDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):(0,Z.t1)(e),h.createElement(Ze,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,d),isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),isLast:this.props.isLast,rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.notification,icon:n()(Ie,{authors:o}),showSnapshotButton:!1},this.getActivitySectionHandlers()),this.renderNotificationActions())}renderCollectionPropertyTitle(e){const{theme:t}=this;return n()("span",{style:{...gt.boldStyle,whiteSpace:"nowrap"}},void 0,n()(b.ZP,{icon:e.icon,type:e.type,size:12,style:gt.svgIconStyle,theme:t}),e.name)}renderCollectionViewTitle(e){if(!e.isDefined())return;const t=(0,g.WE)({collectionView:e.getModel(),getRecordModel:this.getRecordModel});return n()(ze.Z,{href:t,onClick:()=>this.track("click_title"),external:!1,innerStyle:{...gt.pageLinkStyle,...gt.boldStyle},inline:!0},void 0,n()(He.F,{collectionViewStore:e,color:"light",style:{display:"inline-block",verticalAlign:"middle",marginRight:4,marginBottom:2},size:12}),n()(Ke.Z,{collectionViewName:e.getName(),collectionViewType:e.getType()}))}renderTitle(e,t){const i=t.getModel();if(!i)return;const o=(0,g.Al)({table:e,model:i,getRecordModel:this.getRecordModel}),r=this.getRecordUrlWithoutDomainWithPageVisitSource({table:e,model:i,getRecordModel:this.getRecordModel});return n()(ze.Z,{href:r,onClick:()=>this.track("click_title"),external:!1,innerStyle:gt.pageLinkStyle,inline:!0},void 0,o&&h.createElement(h.Fragment,null,n()($e.Z,{disabled:!0,icon:o,isEmptyPage:!1,size:18,style:gt.recordIconStyle}),n()("span",{},void 0," ")),n()(je.Z,{store:t,style:this.getActivityTitleStyle(void 0!==o)}))}renderTeamTitle(e,t){if(!t.isDefined())return;const i=(0,g.Al)({table:e,model:t.getModel(),getRecordModel:this.getRecordModel});return n()(ze.Z,{onClick:e=>{this.track("click_user_invited_to_team"),H.hI({environment:this.environment,teamStore:t,shouldScroll:!0}),ie.Z.setState({...ie.Z.state,open:!1})},external:!1,innerStyle:gt.pageLinkStyle,inline:!0},void 0,i&&h.createElement(h.Fragment,null,n()($e.Z,{disabled:!0,icon:i,isEmptyPage:!1,size:18,style:gt.recordIconStyle}),n()("span",{},void 0," ")),n()(je.Z,{store:t,style:this.getActivityTitleStyle(void 0!==i)}))}renderPermissionGroupTitle(e,t){let i,o;return e?(i=e.icon,o=e.name||n()(U.FormattedMessage,{defaultMessage:"Untitled group",id:"activity.permissionGroupTitles.untitledGroup"})):o=n()(U.FormattedMessage,{defaultMessage:"Deleted group",id:"activity.permissionGroupTitles.deletedGroup"}),n()("span",{},void 0,i&&n()($e.Z,{disabled:!0,icon:{icon:i,pointer:{table:"space",id:t}},isEmptyPage:!1,size:18,style:gt.recordIconStyle}),n()("span",{style:this.getActivityTitleStyle(void 0!==i)},void 0,o))}renderPermissionGroupEditedHeader(e){const{activity:t,authors:i,groupName:o}=e,r=xe(i),s=(0,N.hI)(t.edits||[])[0];return s?"permission-group-created"===s.type?n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created group {groupName}} other {{authorOrAuthors} created group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:r,groupName:n()("span",{style:gt.boldStyle},void 0,o)},id:"activity.updatedPermissionGroupCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"permission-group-deleted"===s.type?n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted group {groupName}} other {{authorOrAuthors} deleted group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:r,groupName:n()("span",{style:gt.boldStyle},void 0,o)},id:"activity.updatedPermissionGroupDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited group {groupName}} other {{authorOrAuthors} edited group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:r,groupName:n()("span",{style:gt.boldStyle},void 0,o)},id:"activity.updatedPermissionGroupEditedDefault.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(U.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited group {groupName}} other {{authorOrAuthors} edited group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:r,groupName:n()("span",{style:gt.boldStyle},void 0,o)},id:"activity.updatedPermissionGroupEdit.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}canUnarchive(){const{notification:e}=this.props;return!!e&&!!e.visited}get getRecordValue(){return this.props.rootStore.getRecordValue}get getRecordModel(){return this.props.rootStore.getRecordModel}getBlockStore(e){return te.G.createChildStore(this.props.rootStore,{table:_.iU,id:e})}getAuthors(e){const t=d().uniqWith(d().flatten(e.map((e=>e.authors||[]))),d().isEqual);return d().compact(t.map(this.getAuthorActor))}handleTrackBacklinkClick(e){V.EQ({...this.getBaseNotificationArgs(),backlinkPageId:e})}handleTrackArchiveClicked(){V._b(this.getBaseNotificationArgs())}getBaseNotificationArgs(){const{notification:e,analyticsContext:t,activity:i}=this.props;return{environment:this.environment,activity:i,activityContext:t,notificationId:null==e?void 0:e.id}}getActivitySectionHandlers(){return{onBacklinkClicked:this.handleTrackBacklinkClick,onArchiveClicked:this.handleTrackArchiveClicked,onMarkAsReadClicked:this.handleMarkAsReadClicked,onMarkAsUnreadClicked:this.handleMarkAsUnreadClicked}}track(e){var t;V.pw({environment:this.environment,target:e}),F.trackActivityAction(this.environment,this.props.analyticsContext,{target:e,type:l.Fb(this.props.activity),activity_id:this.props.activity.id,notification_id:null===(t=this.props.notification)||void 0===t?void 0:t.id})}getIsRecordPrivateToUser(e,t){const{source:i}=this.props;if("notifications_tab_all"===i){if(!e)return!1;let i;return i="block"===t?te.G.createChildStore(this.props.rootStore,{table:_.iU,id:e}):"collection"===t?te.NW.createChildStore(this.props.rootStore,{table:T.v,id:e}):te.H2.createChildStore(this.props.rootStore,{table:B.bx,id:e}),(0,Q.yi)(this.environment,i)}return!1}getActionContainerStyle(){return{paddingLeft:this.getActivityContentLeftPadding()-8,paddingTop:4}}getActionPrimaryContainerStyle(){return{paddingLeft:this.getActivityContentLeftPadding(),paddingTop:12,paddingBottom:8}}getEditButtonStyle(){return{padding:0,paddingLeft:this.getActivityContentLeftPadding(),paddingRight:16,...gt.canSelectStyle}}getActivityContentLeftPadding(){return"notifications_tab_inbox"===this.props.source?52+(this.environment.device.isMobile?3:2):52}getActionButtonStyle(){return{boxShadow:this.theme.plainButtonBoxShadow,height:26,paddingLeft:8,paddingRight:8,fontWeight:500,color:this.theme.regularTextColor}}getActionSecondaryButtonStyle(){return{height:26,paddingLeft:8,paddingRight:8,color:this.theme.mediumTextColor}}getInviteMessageStyle(){return{paddingLeft:this.getActivityContentLeftPadding(),paddingTop:8,paddingBottom:8,paddingRight:12,fontSize:14}}getActivityTitleStyle(e){return{display:"inline",whiteSpace:"normal",marginRight:e?3:0,wordBreak:"break-word",...gt.boldStyle}}}gt.displayName="Activity",gt.canSelectStyle={userSelect:"text",WebkitUserSelect:"text"},gt.boldStyle={fontWeight:L.Z.fontWeight.semibold},gt.pageLinkStyle={padding:1,...gt.canSelectStyle},gt.recordIconStyle={display:"inline-flex",marginRight:2,verticalAlign:"text-top"},gt.svgIconStyle={width:12,height:12,display:"inline-block",verticalAlign:"middle",marginBottom:2,marginRight:4};const mt=gt},98905:(e,t,i)=>{i.d(t,{Z:()=>s});var o=i(49085);class r extends o.Z{getInitialState(){return{count:0}}}const s=new r}}]);