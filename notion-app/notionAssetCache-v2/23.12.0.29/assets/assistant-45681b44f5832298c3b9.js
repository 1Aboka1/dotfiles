"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8721],{11462:(t,e,o)=>{o.d(e,{cz:()=>Z,G6:()=>D,vR:()=>j,CU:()=>A,mA:()=>R});var r=o(96486),n=o.n(r),i=o(26263),a=o(1302);function s(t){const e=[[/"/,'"'],[/'/,"'",/(^|[^\p{L}\p{M}])/],[/`/,"`"],[/\(/,")"],[/\[/,"]"],[/\{/,"}"],[/\\\*/,"*/"],[/<([a-z0-9-]+)( [a-z0-9-]+="[^"]*")*>/,"</$1>"]].map((t=>{let[{source:e},o,{source:r}={source:!1}]=t;return[new RegExp(`^${e}[^]*`,"u"),o,r&&new RegExp(`${r}$`,"u")]})),o=[];let r=0;t:for(;r<t.length;){const n=t.slice(r),i=o.at(-1);if(i&&n.startsWith(i))o.pop(),r+=i.length;else{for(const[i,a,s]of e)if(i.test(n)&&(!s||s.test(t.slice(0,r)))){o.push(n.replace(i,a)),r+=1;continue t}r+=1}}return t+o.reverse().join("")}var l=o(78395);class c{constructor(t){this.state=void 0,this.state=t}async eval(t){const{input:e,commit:o}=t,r=this.cloneState(),n=[];try{const t=this.state.parse(e);for(const e of t)if("element"===e.type)if(l.Mc[e.tagName]){const t=l.Mc[e.tagName]({attributes:e.attributes||{},children:e.children||[],state:r});t&&n.push(t)}else{if(!l.LI[e.tagName])throw new Error(`Unknown API: ${e.tagName}`);{const t=await l.LI[e.tagName]({attributes:e.attributes,children:e.children,state:r});t&&n.push(t)}}return o&&(this.state=r),{type:"success",out:n.join("\n")}}catch(i){return{type:"error",error:`${i.name}: ${i.message}`}}}cloneState(){return{...this.state,selection:this.state.selection?n().cloneDeep(this.state.selection):void 0,blockIdMap:d(this.state.blockIdMap)}}}function d(t){const e={};for(const o in t)p({block:t[o],oldMap:t,newMap:e});return e}function p(t){const{block:e,oldMap:o,newMap:r}=t;if(r[e.id])return r[e.id];const i={type:"block",id:e.id,tagName:e.tagName,attributes:{...e.attributes},persisted:e.persisted,parent:void 0,children:[],text:n().cloneDeep(e.text),properties:n().cloneDeep(e.properties)};return r[e.id]=i,i.children=e.children.map((t=>p({block:t,oldMap:o,newMap:r}))),e.parent&&(i.parent=p({block:e.parent,oldMap:o,newMap:r})),e.parent,i}class u{constructor(t){this.transcript=[],this.codeEvaluator=void 0,this.counter=0,this.streamInference=void 0,this.streamInference=t.streamInference,this.codeEvaluator=new c(t)}getTranscript(){return this.transcript}async*sampleNextStep(){const t=this.streamInference(this.getTranscript()),e=this.counter++;let o="";for await(const r of t)o+=r,yield{type:"assistant",id:e,value:o}}async simulateStep(t){if("assistant"===t.type||"human"===t.type){return await this.evaluateStep(t,!1)}}async commitStep(t){if(this.transcript=[...this.transcript,t],"assistant"===t.type||"human"===t.type){const e=await this.evaluateStep(t,!0);return e&&(this.transcript=[...this.transcript,e]),e}}createAssistantStep(t){return{id:this.counter++,type:"assistant",value:t}}createHumanStep(t){return{id:this.counter++,type:"human",value:t}}async evaluateStep(t,e){const o=await this.codeEvaluator.eval({input:t.value,commit:e});return"success"!==o.type?{type:"observation",id:this.counter++,observationType:"error",value:o.error}:o.out?{type:"observation",id:this.counter++,observationType:"output",value:o.out}:void 0}}function m(t){let e="";for(let o=0;o<t.length;o++){const r=t[o],n=t[o-1];if("human"===r.type)e+=`\n\nHuman: ${r.value.trim()}`;else if("observation"===r.type)if("output"===r.observationType)e+=`\n<stdout>\n${r.value.trim()}\n</stdout>`;else{if("error"!==r.observationType)throw new Error("Unknown observation type");e+=`\n<stderr>\n${r.value.trim()}\n</stderr>`}else{if("assistant"!==r.type)throw new Error("Unknown step type");e+=!n||"human"===n.type?`\n\nAssistant: ${r.value.trim()}`:`\n${r.value.trim()}`}}return e.trim()}function h(t){throw new Error(`Expected value to never occur: ${JSON.stringify(t)}`)}class b{constructor(){this.counter=0,this.uuidToCounterMap=new Map,this.counterToUUidMap=new Map}mapUUIDToCounter(t){if(!this.uuidToCounterMap.has(t)){const e=this.counter.toString();this.uuidToCounterMap.set(t,e),this.counterToUUidMap.set(e,t),this.counter++}return this.uuidToCounterMap.get(t)}mapNodeUUIDToCounter(t){const e={...t};return"block"===e.type?(e.id=this.mapUUIDToCounter(e.id),e.attributes=this.mapNodeAttributesUUIDToCounter(e.attributes),e.children=e.children.map((t=>{const o=this.mapNodeUUIDToCounter(t);return o.parent=e,o})),e):"property"===e.type||"inline"===e.type?(e.attributes=this.mapNodeAttributesUUIDToCounter(e.attributes),e.children=e.children.map((t=>this.mapNodeUUIDToCounter(t))),e):"text"===e.type?e:void h(e)}mapNodeAttributesUUIDToCounter(t){if(!t)return t;const e={...t};for(const o of b.attributesToMap)e[o]&&(e[o]=this.mapUUIDToCounter(e[o]));return e}mapCounterToUUID(t){const e=this.counterToUUidMap.get(t);if(!e)throw new Error(`Tried to map invalid id: ${t}`);return e}mapNodeCounterToUUID(t){const e={...t};return"block"===e.type?(e.id=this.mapCounterToUUID(e.id),e.attributes=this.mapNodeAttributesCounterToUUID(e.attributes),e.children=e.children.map((t=>{const o=this.mapNodeCounterToUUID(t);return o.parent=e,o})),e):"property"===e.type||"inline"===e.type?(e.attributes=this.mapNodeAttributesCounterToUUID(e.attributes),e.children=e.children.map((t=>this.mapNodeCounterToUUID(t))),e):"text"===e.type?e:"move"===e.type?(e.attributes=this.mapNodeAttributesCounterToUUID(e.attributes),e):void h(e)}mapNodeAttributesCounterToUUID(t){if(!t)return t;const e={...t};return null!=e&&e.id&&(e.id=this.mapCounterToUUID(e.id)),e}mapAssistantOperationCounterToUUID(t){if("createBlock"===t.command){const e=t.blockNode;return{...t,blockNode:{...e,id:this.mapCounterToUUID(e.id),text:e.text.map((t=>this.mapNodeCounterToUUID(t))),children:e.children.map((t=>this.mapNodeCounterToUUID(t))),attributes:this.mapNodeAttributesCounterToUUID(e.attributes),parent:e.parent&&this.mapNodeCounterToUUID(e.parent)}}}return"removeBlock"===t.command?{...t,parentId:this.mapCounterToUUID(t.parentId),removeId:this.mapCounterToUUID(t.removeId)}:"insertBlockBefore"===t.command?{...t,parentId:this.mapCounterToUUID(t.parentId),insertId:this.mapCounterToUUID(t.insertId),beforeId:t.beforeId?this.mapCounterToUUID(t.beforeId):void 0}:"insertBlockAfter"===t.command?{...t,parentId:this.mapCounterToUUID(t.parentId),insertId:this.mapCounterToUUID(t.insertId),afterId:t.afterId?this.mapCounterToUUID(t.afterId):void 0}:"setBlockText"===t.command||"setBlockAttribute"===t.command||"setBlockTagName"===t.command?{...t,id:this.mapCounterToUUID(t.id)}:"setBlockProperty"===t.command?{...t,blockId:this.mapCounterToUUID(t.blockId),parentBlockId:this.mapCounterToUUID(t.parentBlockId),property:this.mapNodeCounterToUUID(t.property)}:"insertOrMoveTableColumns"===t.command?{...t,blockId:this.mapCounterToUUID(t.blockId),insertOrMoves:t.insertOrMoves.map((t=>this.mapNodeCounterToUUID(t)))}:"removeTableColumn"===t.command?{...t,blockId:this.mapCounterToUUID(t.blockId)}:void h(t)}}b.attributesToMap=["id","page-id","database-id","person-id"];var f=o(88891),w=o(24993),v=o(65917),g=o(74229),y=o(4615),k=o(21202),I=o(19889),E=o(95477),C=o(33929),N=o(95802),U=o(79315),_=o(3815),x=(o(12318),o(50906)),S=o(54642),O=o(73928),T=o(47307),M=o(61045),$=o(24677),B=o(30149);async function A(t){var e;const{environment:o,store:r}=t;null!==(e=r.state)&&void 0!==e&&e.temporaryCache&&r.state.temporaryCache.clearCache(),r.set({sessionId:(0,y.ZP)(),clientSteps:[],sampledSteps:[],previewingStep:void 0,previewingStepIndex:void 0,previewingStepObservation:void 0,evaluator:new u({selection:void 0,blockIdMap:{},streamInference:async function*(t){const{currentSpaceStore:e}=U.default.state;if(!e)throw new Error("No current space.");const n=await S.getCompletion(o,{id:(0,y.ZP)(),context:{type:"assistant",transcript:t},model:"anthropic-2",spaceId:e.id,isSpacePermission:!1,debugOverrides:{returnDebugInfo:!0,ignoreRateLimit:!0}});if("success"!==n.type)return T.showError(n),{type:"error_modal_shown"};if(g.H1.is(n.data))for await(const o of n.data)if("success"===o.type){if(o.debugRenderedPrompt){if(!r.state)return;r.set({...r.state,samplingPrompt:o.debugRenderedPrompt})}yield o.completion}else if("error"===o.type)throw new Error(o.message)},parse:t=>(0,w.P5)(t),addOperation:t=>{if(!r.state)throw new Error("No state");const e=r.state.idMapper.mapAssistantOperationCounterToUUID(t),n=o.currentUser.id;if(!n)throw new Error("No current user.");const i={table:I.KJ,id:n},{inMemoryRecordCache:a}=o.defaultRecordCache;if(!r.state)throw new Error("No state");const{temporaryCache:s,committing:l,transaction:c}=r.state;if(!c)throw new Error("No transaction.");const d=!l?s:a,p=(0,f.N)({assistantOperation:e,actorPointer:i,getRecordValue:d.makeGetRecordValueFn(n)});r.set({...r.state,temporaryOperations:r.state.temporaryOperations.concat(p),temporaryAssistantOperations:r.state.temporaryAssistantOperations.concat(e)});for(const r of p){const t=new _.ST({environment:o,pointer:r.pointer,path:r.path,inMemoryRecordCache:d});B.applyOperation({store:t,operation:r,transaction:c})}},randomID:()=>{if(!r.state)throw new Error("No state");const t=(0,y.ZP)();return r.state.idMapper.mapUUIDToCounter(t)},loadPage:async t=>{if(!r.state)throw new Error("No state");const{mainEditorCurrentBlockStore:e}=U.default.state;if(!e)throw new Error("No current block store");const o={table:k.iU,id:r.state.idMapper.mapCounterToUUID(t),spaceId:e.getSpaceId()},n=await(0,w.IT)({pointer:o,loadRecordValue:e.loadRecordValue,baseUrl:E.Z.domainBaseUrl,publicDomainName:E.Z.publicDomainName,intl:C.default.getIntl()});return r.state.idMapper.mapNodeUUIDToCounter(n)},chat:(t,e)=>{const o=r.state;if(!o)throw new Error("No state");const n={blockIds:t.map((t=>o.idMapper.mapCounterToUUID(t))),operations:e.map((t=>o.idMapper.mapAssistantOperationCounterToUUID(t)))};r.set({...r.state,temporaryClientSteps:[...r.state.temporaryClientSteps,{type:"assistantChat",blockIds:n.blockIds,operations:n.operations}]})}}),initialSteps:[],temporaryOperations:[],temporaryCache:new i.Z,loading:!1,temporaryClientSteps:[],temporaryAssistantOperations:[],samplingPrompt:void 0,idMapper:new b,committing:!1,transaction:void 0});const a=U.default.state.mainEditorCurrentBlockStore;if(a){if(!r.state)throw new Error("No state");const t=r.state.idMapper.mapUUIDToCounter(a.id),e=r.state.evaluator.createHumanStep("I'm currently viewing page ID: '0'."),i=await R({environment:o,store:r,step:e,commit:!0,isStreaming:!1});"error"===(null==i?void 0:i.observationType)&&T.showMessage({message:i.value});const s=r.state.evaluator.createAssistantStep(`<load-page id="${t}"/>`),l=await R({environment:o,store:r,step:s,commit:!0,isStreaming:!1});"error"===(null==l?void 0:l.observationType)&&T.showMessage({message:l.value}),r.set({...r.state,initialSteps:n().compact([e,s,l])})}}async function D(t){const{environment:e,store:o,message:r}=t;if(!o.state)throw new Error("No state");const{evaluator:n}=o.state;o.set({...o.state,clientSteps:[...o.state.clientSteps,{type:"human",value:r}]});const i=n.createHumanStep(r);await R({environment:e,store:o,step:i,commit:!0,isStreaming:!1}),o.set({...o.state,clientSteps:[...o.state.clientSteps,...o.state.temporaryClientSteps],sampledSteps:[],previewingStep:void 0,previewingStepIndex:void 0,previewingStepObservation:void 0,temporaryOperations:[],temporaryClientSteps:[],temporaryAssistantOperations:[]}),r.includes("<js>")||await P({environment:e,store:o})}async function P(t){const{environment:e,store:o}=t;if(!o.state)throw new Error("No state");const{evaluator:r}=o.state,i=n().range(2);o.set({...o.state,loading:!0,sampledSteps:i.map((t=>({id:t,type:"assistant",value:""})))});const a=i[Math.floor(Math.random()*i.length)],s=n().throttle((async()=>{const t=o.state;if(!t)return;const r=t.sampledSteps[a];await R({environment:e,store:o,step:r,commit:!1,isStreaming:!0})}),O.Z1);try{await Promise.all(i.map((async t=>{const e=r.sampleNextStep();for await(const r of e){if(!o.state)throw new Error("No state");const e=o.state.sampledSteps.map(((e,o)=>o===t?r:e));o.setState({...o.state,sampledSteps:e}),t===a&&s()}})))}catch(l){const t=l.message||JSON.stringify(l)||"Unknown error";T.showMessage({message:t})}o.set({...o.state,loading:!1})}async function j(t){const{environment:e,store:o}=t;if(!o.state)throw new Error("No state");const{sampledSteps:r,previewingStep:n,samplingPrompt:i,evaluator:a}=o.state,{currentSpaceStore:s,currentUserStore:l}=U.default.state;if(!n)throw new Error("No previewing step");if(!i)throw new Error("No sampling prompt");if(!s)throw new Error("No current space");if(!l)throw new Error("No current user");const c=m(a.getTranscript()),d=await R({environment:e,store:o,step:n,commit:!0,isStreaming:!1});x.trackAssistantFeedback(e,{prompt:i,transcript:c,option_a:r[0].value,option_b:r[1].value,selected_option:n.id===r[0].id?"a":"b",observation:null==d?void 0:d.value}),S.saveAssistantFeedback(e,{id:(0,y.ZP)(),type:"assistant_feedback",prompt:i,transcript:c,option_a:r[0].value,option_b:r[1].value,selected_option:n.id===r[0].id?"a":"b",observation:null==d?void 0:d.value,space_id:s.id,user_id:l.id,client_version:3,timestamp:Date.now()}),o.set({...o.state,clientSteps:[...o.state.clientSteps,...o.state.temporaryClientSteps],sampledSteps:[],previewingStep:void 0,previewingStepIndex:void 0,previewingStepObservation:void 0,temporaryOperations:[],temporaryClientSteps:[],temporaryAssistantOperations:[]}),d&&await P(t)}function Z(t){const{store:e}=t;if(!e.state)throw new Error("No state");const{temporaryCache:o}=e.state;o.clearCache(),e.set({...e.state,temporaryOperations:[],temporaryClientSteps:[],temporaryAssistantOperations:[],previewingStep:void 0,previewingStepIndex:void 0,previewingStepObservation:void 0})}async function R(t){const{environment:e,store:o,step:r,commit:i,isStreaming:l}=t,c=e.currentUser.id;if(!c)throw new Error("No current user.");if(!o.state)throw new Error("No state");const{evaluator:d,temporaryCache:p}=o.state,{inMemoryRecordCache:u}=e.defaultRecordCache;p.clearCache(),p.cacheUsingThisInstanceAsAnOverride||u.addCacheOverride(p),o.set({...o.state,temporaryOperations:[],temporaryClientSteps:[],temporaryAssistantOperations:[],committing:i});const{performResult:h}=await B.createAndCommitAsync({environment:e,async perform(t){if(!o.state)throw new Error("No state.");o.set({...o.state,transaction:t});return await(i?d.commitStep(r):d.simulateStep({...r,value:s(r.value)}))},waitForServerCommit:!1,userAction:"assistantActions.simulateOrCommitStep",userId:c}),b="error"===(null==h?void 0:h.observationType);if(b&&o.state.temporaryCache.clearCache(),b&&!l){const t=m(d.getTranscript());v.log({level:"error",from:"assistantActions",type:"assistantStepError",data:{miscDataToConvertToString:{step:r,transcript:t,observation:h}}})}return i||"assistant"!==r.type||o.setState({...o.state,previewingStep:r,previewingStepIndex:o.state.sampledSteps.indexOf(r),previewingStepObservation:h}),!b&&o.state.temporaryAssistantOperations.length>0&&o.set({...o.state,temporaryClientSteps:[...o.state.temporaryClientSteps,{type:"assistantTransaction",operations:o.state.temporaryAssistantOperations}]}),b||a.default.afterNextFlush((()=>{var t;const r=n().compact(null===(t=o.state)||void 0===t?void 0:t.temporaryOperations.map((t=>{let{pointer:e}=t;return e.table===k.iU?e.id:void 0}))),i=N.C.findScrollToSelectablesFromIds(r).map((t=>t.props.store));$.Z5({environment:e,stores:i}),M.hl(r,!1)})),h}},16336:(t,e,o)=>{o.r(e),o.d(e,{AssistantButton:()=>z});var r=o(77094),n=o.n(r),i=o(67294),a=o(480),s=o(16489),l=o(24405),c=o(3779),d=o(11462),p=o(80863),u=o(64921),m=o(44532),h=o(82990),b=o(34859),f=o(61519),w=o(1743),v=o(74194),g=o(18647),y=o(72495),k=o(62385),I=o(18466),E=o(26263),C=o(88891),N=o(21202),U=o(19889),_=o(42925),x=o(30149),S=o(3815),O=o(49065),T=o(61134),M=o(17748);function $(t){window.__c="AssistantChatMessageRenderer";const{clientStep:e}=t,o=(0,a.O7)(),r=(0,i.useMemo)((()=>I.Z.withListenerIgnored((()=>{const t=new E.Z,r=o.currentUser.id;if(!r)throw new Error("No current user.");const n={table:U.KJ,id:r},i=x.createAndCommit({userAction:"AssistantChatMessageRenderer.temporaryListStore",environment:o,perform:i=>{for(const s of e.operations){const e=(0,C.N)({assistantOperation:s,actorPointer:n,getRecordValue:t.makeGetRecordValueFn(r)});for(const r of e){const e=new O.ST({environment:o,pointer:r.pointer,path:r.path,inMemoryRecordCache:t});x.applyOperation({store:e,operation:r,transaction:i})}}const a=e.blockIds.map((e=>new S.G(o,{table:N.iU,id:e},{inMemoryRecordCache:t})));return _.Lh({environment:o,stores:a,inMemoryRecordCache:t,transaction:i})}}).performResult;return t.addCacheFallback(o.defaultRecordCache.inMemoryRecordCache),i}))),[o,e]);return n()(T.O,{displayName:"AssistantChatStepContent",disabled:!0},void 0,n()(M.Z,{store:r,disabled:!0,disableCommentMenu:!0,disableHoverMenu:!0,disableDrag:!0}))}var B=o(96486),A=o.n(B),D=o(84209);function P(t){const{store:e,clientStep:o}=t,r=A().compact(o.operations.map((t=>"insertBlockAfter"===t.command||"insertBlockBefore"===t.command?t.insertId:void 0))),a=A().compact(o.operations.map((t=>"removeBlock"===t.command?t.removeId:void 0))).filter((t=>!r.includes(t))),s=A().compact(o.operations.map((t=>"setBlockAttribute"===t.command||"setBlockTagName"===t.command||"setBlockText"===t.command?t.id:void 0)));return i.createElement(i.Fragment,null,a.length>0&&i.createElement(i.Fragment,null,n()("div",{},void 0,n()("b",{},void 0,"Removed blocks:")),n()(j,{store:e,blockIds:a})),r.length>0&&i.createElement(i.Fragment,null,n()("div",{},void 0,n()("b",{},void 0,"Inserted blocks:")),n()(j,{store:e,blockIds:r})),s.length>0&&i.createElement(i.Fragment,null,n()("div",{},void 0,n()("b",{},void 0,"Updated blocks:")),n()(j,{store:e,blockIds:s})))}function j(t){window.__c="BlockListRenderer";const{store:e,blockIds:o}=t,r=(0,a.O7)(),s=(0,i.useMemo)((()=>I.Z.withListenerIgnored((()=>{const t=e.state;if(!t)throw new Error("No state");return o.map((e=>new S.G(r,{table:N.iU,id:e},{inMemoryRecordCache:t.temporaryCache})))}))),[r,o,e]);return n()(T.O,{displayName:"AssistantBlockRenderer",disabled:!0},void 0,s.map(((t,e)=>n()(Z,{store:t},e))))}function Z(t){window.__c="BlockRenderer";const{store:e}=t,o=(0,s.VK)((()=>(0,D.h)(e)),[e]);return o?n()(o,{store:e,disabled:!0,isFirstItem:!1,isLastItem:!1}):null}function R(t){window.__c="ClientChatStep";const{store:e,clientStep:o}=t,r=(0,l.yK)((t=>({wrap:{display:"flex",marginTop:5,marginBottom:5},baseMessage:{maxWidth:"80%",borderRadius:12,paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6,fontSize:14,whiteSpace:"pre-wrap",overflowWrap:"break-word",position:"relative"},humanMessage:{backgroundColor:t.accentColors.purple[400],color:t.regularInvertedTextColor},assistantMessage:{backgroundColor:t.accentColors.gray[50],color:t.darkTextColor}})),[]);return n()("div",{style:r.wrap},void 0,"human"===o.type&&n()("div",{style:{flexGrow:1}}),n()("div",{style:{...r.baseMessage,..."human"===o.type?r.humanMessage:r.assistantMessage}},void 0,"human"===o.type?o.value:"assistantChat"===o.type?n()($,{clientStep:o}):"assistantTransaction"===o.type?n()(P,{store:e,clientStep:o}):void 0))}var V=o(68785);function L(t){window.__c="PendingAiStep";const{store:e,index:o,step:r}=t,c=(0,a.O7)(),u=(0,l.yK)((t=>({input:{marginTop:5,marginBottom:5,fontFamily:h.Z.baseFontFamily.githubMono,fontSize:12},inputInner:{height:150},topbarWrap:{display:"flex"},label:{fontSize:12},blue:{color:t.accentColors.blue[500]}})),[]),m=(0,i.useCallback)((t=>{(0,p.z)({store:e,step:{...r,value:t.target.value}})}),[e,r]),b=(0,i.useCallback)((()=>{d.mA({environment:c,store:e,step:r,commit:!1,isStreaming:!1})}),[c,e,r]),f=(0,i.useCallback)((()=>{d.cz({store:e})}),[e]),w=(0,s.VK)((()=>{var t;return null===(t=e.state)||void 0===t?void 0:t.loading}),[e]),g=(0,s.VK)((()=>{var t;return(null===(t=e.state)||void 0===t?void 0:t.previewingStep)===r}),[e,r]);return n()("div",{},void 0,n()("div",{style:u.topbarWrap},void 0,n()("div",{style:u.label},void 0,`Sample ${o+1}`),n()("div",{style:{flexGrow:1}}),!w&&(g?n()(k.Z,{style:u.blue,onClick:f},void 0,"Previewing"):n()(k.Z,{onClick:b},void 0,"Preview")),w&&n()(V.Z,{style:{width:12}})),n()(v.Z,{style:u.input,inputStyle:u.inputInner,value:r.value,onChange:m,textarea:!0,spellCheck:!1}))}function F(t){window.__c="AssistantChat";const{store:e,onClose:o}=t,[r,c]=(0,i.useState)(""),p=(0,i.useRef)(void 0),u=(0,s.VK)((()=>e.state),[e]),m=(0,a.O7)();(0,i.useEffect)((()=>{p.current&&p.current.scrollToBottom()}),[null==u?void 0:u.clientSteps]);const I=(0,l.yK)((t=>({wrap:{width:420,height:"90vh",display:"flex",flexDirection:"column"},topbarWrap:{display:"flex",marginLeft:6,marginRight:6},input:{width:void 0,marginLeft:8,marginRight:8},scroller:{flexGrow:1,paddingTop:8,paddingBottom:8,paddingLeft:8,paddingRight:8,backgroundColor:t.contentBackground},samplesLabel:{fontSize:12,marginTop:8,marginBottom:8},previewLabel:{fontSize:12}})),[]),E=(0,i.useCallback)((async()=>{e.state&&await d.CU({environment:m,store:e})}),[m,e]),C=(0,i.useCallback)((t=>{c(t.target.value)}),[c]),N=(0,i.useCallback)((()=>{e.state&&(!r||e.state.sampledSteps.length>0||(d.G6({environment:m,store:e,message:r}),c("")))}),[m,r,c,e]),U=(0,i.useCallback)((()=>{d.vR({environment:m,store:e})}),[m,e]);return n()("div",{style:I.wrap},void 0,n()(y.Z,{},void 0,n()("div",{style:I.topbarWrap},void 0,n()(k.Z,{onClick:E},void 0,"Reset"),n()("div",{style:{flexGrow:1}}),n()(k.Z,{onClick:o},void 0,"Close"))),i.createElement(g.Z,{ref:p,type:b.Z.Y,style:I.scroller},null==u?void 0:u.clientSteps.map(((t,o)=>n()(R,{store:e,clientStep:t},o))),(null==u?void 0:u.sampledSteps)&&u.sampledSteps.length>0&&i.createElement(i.Fragment,null,n()(f.Z,{size:24}),n()("div",{style:I.samplesLabel},void 0,n()("div",{},void 0,n()("b",{},void 0,"Sampling 2 options for the assistant's next step")),n()("div",{},void 0,"Use Preview on each to decide which one is best. You can also make manual edits."),n()("div",{},void 0,"Note: end-users will not be able to see this part.")),null==u?void 0:u.sampledSteps.map(((t,o)=>n()(L,{store:e,index:o,step:t},o)))),(null==u?void 0:u.previewingStep)&&i.createElement(i.Fragment,null,n()(f.Z,{size:24}),n()("div",{style:{display:"flex",marginTop:8,marginBottom:8}},void 0,n()("div",{style:I.previewLabel},void 0,n()("div",{},void 0,n()("b",{},void 0,"Previewing assistant step")),(null==u?void 0:u.previewingStepObservation)&&n()("div",{},void 0,"The assistant executed code that resulted in output. Clicking Accept will show this output to the assistant and allow it to take the next step.")),n()("div",{style:{flexGrow:1}}),n()(k.Z,{onClick:U},void 0,"Accept")),(null==u?void 0:u.previewingStepObservation)&&n()("div",{style:{fontSize:12,fontFamily:h.Z.baseFontFamily.githubMono,whiteSpace:"pre-wrap",overflowWrap:"break-word"}},void 0,null==u?void 0:u.previewingStepObservation.value),null==u?void 0:u.temporaryClientSteps.map(((t,o)=>n()(R,{store:e,clientStep:t},o))))),n()(y.Z,{},void 0,n()(w.Z,{capture:!0},void 0,n()(v.Z,{style:I.input,value:r,placeholder:"Ask a question or ask to modify this page…",onChange:C,onSubmit:N,focusInitial:!0}))))}function z(){window.__c="AssistantButton";const t=(0,a.O7)(),[e,o]=(0,i.useState)(!1),r=(0,s.VK)((()=>t.device.isPhone),[t]),h=(0,l.yK)((t=>({button:{position:"absolute",bottom:16,right:62,background:t.inputBackground,color:t.mediumTextColor,fill:t.mediumTextColor,boxShadow:t.borderBoxShadow,display:r?"none":"flex",alignItems:"center",borderRadius:24,height:36,paddingLeft:10,paddingRight:10,fontSize:14,zIndex:1}})),[r]),b=(0,i.useCallback)((async()=>{if(p.o.state||await d.CU({environment:t,store:p.o}),!p.o.state)throw new Error("No state");o(!0)}),[t,o]),f=(0,i.useCallback)((()=>{o(!1)}),[o]);return n()(m.ZP,{popupType:m.kQ.Popup,open:e,origin:n()(u.Z,{style:h.button,onClick:b},void 0,c.Z.sparkles({width:14,height:14,marginRight:4}),"Ask Notion AI"),originGap:6,disableMouseCapture:!0,render:()=>n()(F,{store:p.o,onClose:f})})}},88828:(t,e,o)=>{o.r(e),o.d(e,{AssistantLabelerBar:()=>h});var r=o(77094),n=o.n(r),i=o(67294),a=o(480),s=o(16489),l=o(24405),c=o(11462),d=o(80863),p=o(68785),u=o(89728),m=o(44532);function h(){window.__c="AssistantLabelerBar";const t=(0,a.O7)(),e=(0,l.yK)((t=>({wrap:{padding:8,backgroundColor:t.contentBackground},inner:{display:"flex",alignItems:"center"},error:{fontSize:14,color:t.accentColors.red[600]}})),[]),o=(0,s.VK)((()=>{const t=d.o.state;return Boolean(t&&t.sampledSteps.length>0)}),[]),r=(0,s.VK)((()=>{const t=d.o.state;return Boolean(t&&t.loading)}),[]),h=(0,s.VK)((()=>{const t=d.o.state;return null==t?void 0:t.previewingStepIndex}),[]),b=(0,s.VK)((()=>{const t=d.o.state;return null==t?void 0:t.previewingStepObservation}),[]),f=(0,i.useCallback)((()=>{c.cz({store:d.o})}),[]),w=(0,i.useCallback)((async e=>{const o=d.o.state;o&&await c.mA({environment:t,store:d.o,step:o.sampledSteps[e],commit:!1,isStreaming:!1})}),[t]),v=(0,i.useCallback)((async()=>{await c.vR({environment:t,store:d.o})}),[t]),g=(0,s.VK)((()=>({top:0,left:0,right:0,bottom:0,width:t.WindowSizeStore.state.width,height:0})),[t],{useDeepEqual:!0});return n()(m.ZP,{popupType:m.kQ.Popup,open:o,originRect:g,originGap:6,disableMouseCapture:!0,render:()=>n()("div",{style:e.wrap},void 0,n()("div",{style:e.inner},void 0,n()(u.Z,{hovered:void 0===h||void 0,onClick:f},void 0,"Original"),n()(u.Z,{hovered:0===h||void 0,onClick:()=>w(0)},void 0,"A"),n()(u.Z,{hovered:1===h||void 0,onClick:()=>w(1)},void 0,"B"),n()(u.Z,{disabled:void 0===h,onClick:v},void 0,"Accept"),r&&n()(p.Z,{})),b&&!r&&n()("div",{style:e.error},void 0,"Error: ",b.value))})}},80863:(t,e,o)=>{function r(t){const{store:e,step:o}=t;if(!e.state)throw new Error("No state");const r=e.state.sampledSteps.map((t=>t.id===o.id?o:t));e.set({...e.state,sampledSteps:r})}o.d(e,{z:()=>r,o:()=>n});const n=new(o(12318).default)(void 0)},78395:(t,e,o)=>{o.d(e,{pX:()=>i,t:()=>s,LI:()=>l,Mc:()=>c});const r=(t,e)=>e in t,n=["hr","embed","h1","h2","h3","database","math-block","code-block","child-page","link-page","child-database","link-database","text","page","uli","oli","toggle","quote","callout","todo","columns","table"],i={hr:{title:!1,content:[],attributes:{},properties:[]},embed:{title:!1,content:[],attributes:{},properties:[]},h1:{title:!0,content:[],attributes:{},properties:[]},h2:{title:!0,content:[],attributes:{},properties:[]},h3:{title:!0,content:[],attributes:{},properties:[]},database:{title:!0,content:[],attributes:{},properties:[]},"math-block":{title:!0,content:[],attributes:{},properties:[]},"code-block":{title:!0,content:[],attributes:{language:{values:!0,description:"language of code"}},properties:[]},"child-page":{title:!0,content:[],attributes:{"page-id":{values:!0,description:"ID of page, to be used in <load-page>"}},properties:[]},"link-page":{title:!0,content:[],attributes:{"page-id":{values:!0,description:"ID of page, to be used in <load-page>"}},properties:[]},"child-database":{title:!0,content:[],attributes:{"database-id":{values:!0,description:"ID of database"}},properties:[]},"link-database":{title:!0,content:[],attributes:{"database-id":{values:!0,description:"ID of database"}},properties:[]},text:{title:!0,content:n,attributes:{},properties:[]},page:{title:!0,content:n,attributes:{},properties:[]},uli:{title:!0,content:n,attributes:{},properties:[]},oli:{title:!0,content:n,attributes:{},properties:[]},toggle:{title:!0,content:n,attributes:{},properties:[]},quote:{title:!0,content:n,attributes:{},properties:[]},todo:{title:!0,content:n,attributes:{checked:{values:["true","false"],description:'checked state, either "true" or "false"'}},properties:[]},callout:{title:!0,content:n,attributes:{},properties:[]},columns:{title:!1,content:["column"],attributes:{},properties:[]},column:{title:!1,content:n,attributes:{},properties:[]},table:{title:!1,content:["tr"],attributes:{"header-row":{values:["true","false"],description:'whether first <tr> is row header, either "true" or "false"'},"header-column":{values:["true","false"],description:'whether first <td> in every <tr> is column header, either "true" or "false"'}},properties:[]},tr:{title:!1,content:[],attributes:{},properties:["property-text"]}},a={"property-text":{content:!0},"schema-property-text":{content:[]}},s={b:{attributes:{}},i:{attributes:{}},code:{attributes:{}},s:{attributes:{}},u:{attributes:{}},a:{attributes:{href:{values:!0,description:"link URL"}}},"mention-page":{attributes:{"page-id":{values:!0,description:"ID of page"}},isToken:!0},"mention-database":{attributes:{"database-id":{values:!0,description:"ID of database"}},isToken:!0},person:{attributes:{"person-id":{values:!0,description:"ID of person"}},isToken:!0}};const l={"load-page":async function(t){const{attributes:e,children:o,state:r}=t;if(o.length>0)throw new Error("<load-page> cannot have children");const{id:n,...i}=e;if(Object.keys(i).length>0)throw new Error(`<load-page> has invalid attributes: ${Object.keys(i).join(", ")}`);if("string"!=typeof n)throw new Error("<load-page> must have an id attribute");const a=await r.loadPage(n),s=[a],l=[];let c;for(;c=s.pop();)l.includes(c.id)||(r.blockIdMap[c.id]=c,s.push(...c.children),l.push(c.id));return function(t){const{node:e,state:o}=t;return g({node:e,state:o}).join("")}({node:a,state:r})}},c={"insert-before":function(t){const{attributes:e,children:o,state:r}=t,{id:n,name:i,...a}=e;if(Object.keys(a).length>0)throw new Error(`<insert-before> has invalid attributes: ${Object.keys(a).join(", ")}`);if("string"!=typeof n)throw new Error("Block missing id attribute.");const s=r.blockIdMap[n];if(!s)throw new Error(`Block with id ${n} not found.`);if(!s.parent)throw new Error(`Block with id ${n} has no parent.`);if("string"!=typeof i&&void 0!==i)throw new Error(`Invalid value for name attribute: ${i}`);if(void 0===i){const t=d({children:o,state:r,allowMove:!0}),e=s.parent.children.findIndex((t=>t.id===s.id));if(e<0)throw new Error("Cannot insert before without parent.");k({parent:s.parent,index:e,insert:t,state:r});for(const o of t)r.addOperation({command:"insertBlockBefore",parentId:s.parent.id,insertId:o.id,beforeId:s.id})}else if("string"==typeof i){if("table"!==s.tagName)throw new Error("<insert-before> with name attribute only works on tables.");const t=Number(i);if(!Number.isInteger(t)||t<1)throw new Error(`Invalid column index: ${t}.`);for(const e of s.children){if(!e.properties[i])throw new Error(`Property ${i} does not exist on table row.`)}I({tableBlockNode:s,children:o,atZeroBasedIndex:t-1,state:r})}},"insert-after":function(t){const{attributes:e,children:o,state:r}=t,{id:n,name:i,...a}=e;if(Object.keys(a).length>0)throw new Error(`<insert-after> has invalid attributes: ${Object.keys(a).join(", ")}`);if("string"!=typeof n)throw new Error("Block missing id attribute.");const s=r.blockIdMap[n];if(!s)throw new Error(`Block with id ${n} not found.`);if(!s.parent)throw new Error(`Block with id ${n} has no parent.`);if("string"!=typeof i&&void 0!==i)throw new Error(`Invalid value for name attribute: ${i}`);if(void 0===i){const t=d({children:o,state:r,allowMove:!0}),e=s.parent.children.findIndex((t=>t.id===s.id));if(e<0)throw new Error("Cannot insert before without parent.");k({parent:s.parent,index:e+1,insert:t,state:r});const n=[...t].reverse();for(const o of n)r.addOperation({command:"insertBlockAfter",parentId:s.parent.id,insertId:o.id,afterId:s.id})}else if("string"==typeof i){if("table"!==s.tagName)throw new Error("<insert-after> with name attribute only works on tables.");const t=Number(i);if(!Number.isInteger(t)||t<1)throw new Error(`Invalid column index: ${t}.`);for(const e of s.children){if(!e.properties[i])throw new Error(`Property ${i} does not exist on table row.`)}I({tableBlockNode:s,children:o,atZeroBasedIndex:t,state:r})}},"insert-inside":function(t){const{attributes:e,children:o,state:r}=t,{id:n,...i}=e;if(Object.keys(i).length>0)throw new Error(`<insert-inside> has invalid attributes: ${Object.keys(i).join(", ")}`);if("string"!=typeof n)throw new Error("Block missing id attribute.");const a=r.blockIdMap[n];if(!a)throw new Error(`Block with id ${n} not found.`);const s=d({children:o,state:r,allowMove:!0});k({parent:a,index:a.children.length+1,insert:s,state:r});const l=[...s].reverse();for(const c of l)r.addOperation({command:"insertBlockAfter",parentId:a.id,insertId:c.id})},delete:function(t){const{attributes:e,children:o,state:r}=t;if(o.length>0)throw new Error("<delete> cannot have children.");const{id:n,name:i,...a}=e;if(Object.keys(a).length>0)throw new Error(`<delete> has invalid attributes: ${Object.keys(a).join(", ")}`);if("string"!=typeof n)throw new Error("Block missing id attribute.");const s=r.blockIdMap[n];if(!s)throw new Error(`Block with id ${n} not found.`);if("string"!=typeof i&&void 0!==i)throw new Error(`Invalid value for name attribute: ${i}`);if(void 0===i)E({remove:[s],state:r});else if("string"==typeof i){if("table"!==s.tagName)throw new Error("<delete> with name attribute can only be used on <table> blocks.");const t=Number(i);for(const e of s.children){const o=e.properties;if(1===Object.keys(o).length)throw new Error(`Cannot delete property ${i} from row because it is the last property.`);if(!o[i])throw new Error(`Cannot delete property ${i} from row because it does not exist.`);delete o[i];let r=t;for(;o[r+1];)o[r+1].attributes.name=r.toString(),r++}r.addOperation({command:"removeTableColumn",blockId:s.id,columnIndex:t-1})}},"set-title":function(t){const{attributes:e,children:o,state:r}=t,{id:n,...i}=e;if(Object.keys(i).length>0)throw new Error(`<set-title> has invalid attributes: ${Object.keys(i).join(", ")}`);if("string"!=typeof n)throw new Error("Block missing id attribute.");const a=r.blockIdMap[n];if(!a)throw new Error(`Block with id ${n} not found.`);const s=o.map((t=>"text"===t.type?y({value:t.value}):h(t)));r.addOperation({command:"setBlockText",id:a.id,text:s}),a.text=s},"set-attribute":function(t){const{attributes:e,children:o,state:r}=t;if(o.length>0)throw new Error("<set-attribute> cannot have children.");if("string"!=typeof e.id)throw new Error("Block missing id attribute.");const n=r.blockIdMap[e.id];if(!n)throw new Error(`Block with id ${e.id} not found.`);if(Object.keys(e).length<2)throw new Error(`Attempted to set an attribute without a key: ${Object.keys(e).join(", ")}.`);if(Object.keys(e).length>2)throw new Error(`Attempted to set an attribute with more than one key: ${Object.keys(e).join(", ")}.`);const a=Object.keys(e).find((t=>"id"!==t));if("string"!=typeof a)throw new Error(`Attempted to set a non-string attribute: ${String(a)}.`);const s=e[a];if("string"!=typeof s)throw new Error(`Attempted to set an attribute to a non-string value: ${a}.`);if("id"===a)throw new Error("Attempted to set id attribute.");const l=Object.fromEntries(Object.entries(i[n.tagName].attributes).map((t=>{let[e,{values:o}]=t;return[e,o]})))[a];if(!l)throw new Error(`Attempted to set an attribute that is not allowed: ${a}.`);if(!0!==l&&!l.includes(s))throw new Error(`Attempted to set attribute ${a} to value that is not allowed: ${s}.`);r.addOperation({command:"setBlockAttribute",id:n.id,attribute:a,value:s}),n.attributes[a]=s},"set-tag-name":function(t){const{attributes:e,children:o,state:n}=t;if(o.length>0)throw new Error("<set-tag-name> cannot have children.");const{id:a,"tag-name":s,...l}=e;if(Object.keys(l).length>0)throw new Error(`<set-tag-name> has invalid attributes: ${Object.keys(l).join(", ")}`);if("string"!=typeof a)throw new Error("Block missing id attribute.");const c=n.blockIdMap[a];if(!c)throw new Error(`Block with id ${a} not found.`);if("string"!=typeof s)throw new Error(`Invalid argument type for tagName, expected a string: ${s}.`);if(!r(i,s))throw new Error(`Invalid block tag name: ${s}.`);c.tagName=s,n.addOperation({command:"setBlockTagName",id:c.id,tagName:s})},"set-property":function(t){const{attributes:e,children:o,state:r}=t,{id:n,...i}=e;if(Object.keys(i).length>0)throw new Error(`<set-property> has invalid attributes: ${Object.keys(i).join(", ")}`);if("string"!=typeof n)throw new Error("Block missing id attribute.");const a=r.blockIdMap[n];if(!a)throw new Error(`Block with id ${n} not found.`);if(!a.parent)throw new Error(`Block with id ${n} has no parent.`);if(0===o.length)throw new Error("No properties specified");if(o.length>1)throw new Error(`Attempted to set multiple properties: ${JSON.stringify(o)}.`);const s=m(o[0]),l=s.attributes.name;if("string"!=typeof l||!(l in a.properties))throw new Error("Attempted to add a new property to a block.");if(!a.parent)throw new Error("Attempted to set a property on a block without a parent.");if(a.properties[l].tagName!==s.tagName)throw new Error(`Attempted to set a property to a different tag name: ${a.properties[l].tagName} -> ${s.tagName}.`);a.properties[l]=s,r.addOperation({command:"setBlockProperty",blockId:a.id,parentBlockId:a.parent.id,property:s})},chat:function(t){const{attributes:e,children:o,state:r}=t;if(Object.keys(e).length>0)throw new Error(`<chat> has invalid attributes: ${Object.keys(e).join(", ")}`);const n=d({children:o,state:r,allowMove:!1}),i=n.map((t=>t.id)),a=[...n,...n.flatMap((t=>C(t)))].map((t=>({command:"createBlock",blockNode:t})));r.chat(i,a)},"persist-blocks":function(t){const{children:e,state:o}=t,r=d({children:e,state:o,allowMove:!1});for(const n of r)p({block:n,state:o})}};function d(t){const{children:e,state:o,allowMove:r}=t;return e.map((t=>u({node:t,persisted:!1,state:o,allowMove:r})))}function p(t){const{block:e,state:o}=t;if(!e.persisted){o.addOperation({command:"createBlock",blockNode:e});for(const t of e.children)p({block:t,state:o});e.persisted=!0}}function u(t){var e;const{node:o,persisted:n,state:l,allowMove:c}=t;if("element"!==o.type)throw new Error("Not an element.");const d=o.tagName;if("move"===o.tagName){if(!c)throw new Error("<move> is not allowed in this context.");const{attributes:{id:t,name:e}}=f(o);if(e)throw new Error("<move> is not allowed to have a name attribute in this context.");const r=l.blockIdMap[t];if(!r)throw new Error(`Block not found: ${t}`);return E({remove:[r],state:l}),r}if(!r(i,d))throw new Error(`Unsupported block tag name: ${d}.`);const p=null===(e=o.attributes)||void 0===e?void 0:e.id;let b;if(n){if(!p)throw new Error(`XML node is missing ID attribute: ${o.tagName}.`);b=p}else{if(p)throw new Error("When creating new blocks, do not provide an ID attribute.");b=l.randomID()}return l.blockIdMap[b]||function(t){let{id:e,tagName:o,attributes:n,childNodes:l,persisted:c,state:d,allowMove:p}=t;const b=i[o].title,f=i[o].properties,w=i[o].content,v=Object.fromEntries(Object.entries(i[o].attributes).map((t=>{let[e,{values:o}]=t;return[e,o]})));v.id=!0;for(const[r,i]of Object.entries(n)){const t=v[r];if(!t)throw new Error(`Attempted to set an attribute that is not allowed: ${r}.`);if(!0!==t&&!t.includes(i))throw new Error(`Attempted to set attribute ${r} to value that is not allowed: ${i}.`)}const g={...n,id:e},k={type:"block",id:e,tagName:o,persisted:c,attributes:g,text:[],properties:{},children:[],parent:void 0};for(const i of l)if("text"===i.type){if(i.value){const t=y({value:i.value});if(k.children.length>0)throw new Error(`Encountered a text node after a child block node: ${i.value}.`);if(Object.keys(k.properties).length>0)throw new Error(`Encountered a text node after a child property node: ${i.value}.`);if(!b)throw new Error(`Encountered a text node in a block that doesn't allow title: ${i.value}.`);k.text.push(t)}}else if("element"===i.type){const t=i.tagName;if(r(s,t)){if(k.children.length>0)throw new Error(`Encountered an inline node after a child block node: ${t} inside ${o}.`);if(Object.keys(k.properties).length>0)throw new Error(`Encountered an inline node after a child property node: ${t}.`);if(!b)throw new Error(`Encountered an inline node in a block that doesn't allow title: ${t} inside ${o}.`);const e=h(i);k.text.push(e)}else if(r(a,t)){if(k.children.length>0)throw new Error(`Encountered a property node after a child block node: ${t}.`);if(!f.includes(t))throw new Error(`Encountered a property node in a block that doesn't allow it: ${t}.`);const e=m(i);k.properties[e.attributes.name]=e}else{if(!w.includes(t))throw new Error(`Encountered a block node in a block that doesn't allow content: ${t} inside ${o}.`);const e=u({node:i,persisted:c,state:d,allowMove:p});e.parent=k,k.children.push(e)}}if(k.id in d.blockIdMap)throw new Error(`Attempted to create a duplicate block with id: ${k.id}`);return d.blockIdMap[k.id]=k,k}({tagName:d,id:b,attributes:o.attributes||{},childNodes:o.children||[],persisted:n,state:l,allowMove:c})}function m(t){var e;if("element"!==t.type)throw new Error("Not an element.");const o=t.tagName;if(!r(a,o))throw new Error(`Unsupported property tag name: ${o}.`);const n=null===(e=t.attributes)||void 0===e?void 0:e.name;if(!n)throw new Error(`Property node is missing name attribute: ${t.tagName}.`);return{type:"property",tagName:o,attributes:{name:n},children:b(t.children||[])}}function h(t){if("element"!==t.type)throw new Error("Not an element.");const e=t.tagName;if(!r(s,e))throw new Error(`Unsupported inline tag name: ${e}.`);const o=t.attributes||{},n=Object.fromEntries(Object.entries(s[e].attributes).map((t=>{let[e,{values:o}]=t;return[e,o]})));for(const[r,i]of Object.entries(o)){const t=n[r];if(!t)throw new Error(`Attempted to set an attribute that is not allowed: ${r}.`);if(!0!==t&&!t.includes(i))throw new Error(`Attempted to set attribute ${r} to value that is not allowed: ${i}.`)}return{type:"inline",tagName:e,attributes:o,children:b(t.children||[])}}function b(t){const e=[];for(const o of t)if("text"===o.type){if(o.value){const t=y({value:o.value});e.push(t)}}else if("element"===o.type){const t=o.tagName;if(!r(s,t))throw new Error(`Encountered an unsupported inline tag name: ${t}.`);{const t=h(o);e.push(t)}}return e}function f(t){var e;if("element"!==t.type)throw new Error("Not an element.");const o=t.tagName;if("move"!==o)throw new Error("Not a move node.");if(null!==(e=t.children)&&void 0!==e&&e.length)throw new Error("<move> cannot have children.");const{id:r,name:n,...i}=t.attributes||{};if(Object.keys(i).length>0)throw new Error(`<move> has invalid attributes: ${Object.keys(i).join(", ")}`);if("string"!=typeof r)throw new Error("<move> missing id attribute.");if("string"!=typeof n&&void 0!==n)throw new Error("<move> has invalid name attribute.");return{type:"move",tagName:o,attributes:{id:r,name:n},children:[]}}const w="\x3c!--<selection>--\x3e",v="\x3c!--</selection>--\x3e";function g(t){const{node:e,state:o}=t,r=[];if("text"===e.type)for(const s of e.value)r.push(s);else{let t="";t+=`<${e.tagName}`;for(const[o,r]of Object.entries(e.attributes||{}))t+=` ${o}="${r}"`;t+=">";const c=`</${e.tagName}>`;if("block"===e.type){var n,i,a;const s="block"===e.type&&"block"===(null===(n=o.selection)||void 0===n?void 0:n.type)&&o.selection.blockIds.includes(e.id);s&&r.push(w),r.push(t);const l=[];if(e.text)for(const t of e.text){const e=g({node:t,state:o});for(const t of e)l.push(t)}let d,p;"text"===(null===(i=o.selection)||void 0===i?void 0:i.type)&&o.selection.start.blockId===e.id&&(d=o.selection.start.index),"text"===(null===(a=o.selection)||void 0===a?void 0:a.type)&&o.selection.end.blockId===e.id&&(p=o.selection.end.index);for(let t=0;t<l.length;t++){const e=l[t];let o="";t===d&&(o+=w),t===p&&(o+=v),o+=e,r.push(o)}d===l.length&&r.push(w),p===l.length&&r.push(v);for(const t of Object.values(e.properties))r.push(...g({node:t,state:o}));if(e.children)for(const t of e.children){const e=g({node:t,state:o});for(const t of e)r.push(t)}r.push(c),s&&r.push(v)}else{var l;const n=[];if(e.children)for(const t of e.children){const e=g({node:t,state:o});for(const t of e)n.push(t)}if(n.length<=1||null!==(l=s[e.tagName])&&void 0!==l&&l.isToken)r.push(t+n.join("")+c);else for(let e=0;e<n.length;e++){const o=n[e];0===e?r.push(t+o):e===n.length-1?r.push(o+c):r.push(o)}}}return r}function y(t){let{value:e}=t;return{type:"text",value:e}}function k(t){const{parent:e,index:o,insert:r,state:n}=t,a=Array.isArray(r)?r:[r],s=i[e.tagName].content,l=a.map((t=>t.tagName));for(const i of l)if(!s.includes(i))throw new Error(`Encountered a block node in a block that doesn't allow content: ${i} inside ${e.tagName}.`);for(let i=a.length-1;i>=0;i--){const t=a[i];if("block"!==t.type)throw new Error("Cannot insert a non-block node.");t.parent=e,e.children.splice(o,0,t),p({block:t,state:n})}}function I(t){let{tableBlockNode:e,children:o,atZeroBasedIndex:r,state:n}=t,i=r+1;const a=[],s=[];for(const l of o){if("element"===l.type&&"move"===l.tagName){const t=f(l),o=t.attributes.name;if(!o)throw new Error("<move> inside <insert-X> with name attribute requires name attribute.");for(const r of e.children){if(!r.properties[o])throw new Error(`Property ${o} does not exist on table row.`)}if(s.includes(o))throw new Error(`Cannot move property ${o} more than once.`);a.push({...t,attributes:t.attributes}),s.push(o)}else{const t=m(l);if("schema-property-text"!==t.tagName)throw new Error("Tables only supports <schema-property-text>.");if(t.attributes.name!==i.toString())throw new Error("<insert-X> with name attribute requires properties to be in order.");a.push({...t,tagName:t.tagName})}i++}for(const l of e.children){const t=Object.values(l.properties).filter((t=>!s.includes(t.attributes.name))).sort(((t,e)=>Number(t.attributes.name)-Number(e.attributes.name))),o=t.map((t=>Number(t.attributes.name))),i=o.indexOf(Math.max(...o.filter((t=>t<r+1))))+1,c=Object.fromEntries([...t.slice(0,i),...a.map((t=>{if("move"===t.type)return l.properties[t.attributes.name];return{type:"property",tagName:"property-text",attributes:{name:t.attributes.name},children:[]}})),...t.slice(i)].map(((t,e)=>{const o=e+1;return[o,{...t,attributes:{...t.attributes,name:o.toString()}}]})));l.properties=c,n.addOperation({command:"insertOrMoveTableColumns",blockId:e.id,atIndex:r,insertOrMoves:a})}}function E(t){const{remove:e,state:o}=t;for(const r of e){if(!r.parent)throw new Error("Cannot remove block without parent.");const t=r.parent.children.findIndex((t=>t.id===r.id));if(t<0)throw new Error("Cannot remove block without parent.");o.addOperation({command:"removeBlock",parentId:r.parent.id,removeId:r.id}),r.parent.children.splice(t,1),r.parent=void 0}}function C(t){const e=[];for(const o of t.children)e.push(o),e.push(...C(o));return e}},88891:(t,e,o)=>{o.d(e,{N:()=>c});var r=o(41432),n=o(482),i=o(71644),a=o(21202),s=o(97880),l=o(24993);function c(t){let{assistantOperation:e,actorPointer:o,getRecordValue:c}=t;const p=Date.now(),u={last_edited_by_table:o.table,last_edited_by_id:o.id,last_edited_time:p},m={created_by_table:o.table,created_by_id:o.id,created_time:p,...u};if("createBlock"===e.command){var h,b;const t=l.BO[e.blockNode.tagName];if(!t)throw new Error(`Unknown block type: ${e.blockNode.tagName}`);const o={};if(e.blockNode.attributes)for(const[r,n]of Object.entries(e.blockNode.attributes))o[r]=(0,l.O2)(r,n);return[{pointer:{table:a.iU,id:d(e.blockNode.id)},command:"set",path:[],args:{type:t,properties:{title:e.blockNode.text.length>0?(0,l.Yt)(e.blockNode.text):void 0,...o},content:null===(h=e.blockNode.children)||void 0===h?void 0:h.map((t=>d(t.id))),...(null===(b=e.blockNode.parent)||void 0===b?void 0:b.id)&&{parent_id:d(e.blockNode.parent.id),parent_table:a.iU,alive:!0},...m}}]}if("removeBlock"===e.command)return[{pointer:{table:a.iU,id:d(e.parentId)},command:"listRemove",path:["content"],args:{id:d(e.removeId)}},n.op.update({pointer:{table:a.iU,id:d(e.parentId)},path:[],args:u}),{pointer:{table:a.iU,id:d(e.removeId)},command:"update",path:[],args:{parent_id:d(e.parentId),parent_table:a.iU,alive:!1,...u}}];if("insertBlockBefore"===e.command)return[{pointer:{table:a.iU,id:d(e.parentId)},command:"listBefore",path:["content"],args:{id:d(e.insertId),before:e.beforeId?d(e.beforeId):void 0}},n.op.update({pointer:{table:a.iU,id:d(e.parentId)},path:[],args:u}),{pointer:{table:a.iU,id:d(e.insertId)},command:"update",path:[],args:{parent_id:d(e.parentId),parent_table:a.iU,alive:!0,...u}}];if("insertBlockAfter"===e.command)return[{pointer:{table:a.iU,id:d(e.parentId)},command:"listAfter",path:["content"],args:{id:d(e.insertId),after:e.afterId?d(e.afterId):void 0}},n.op.update({pointer:{table:a.iU,id:d(e.parentId)},path:[],args:u}),{pointer:{table:a.iU,id:d(e.insertId)},command:"update",path:[],args:{parent_id:d(e.parentId),parent_table:a.iU,alive:!0,...u}}];if("setBlockText"===e.command)return[{pointer:{table:a.iU,id:d(e.id)},command:"update",path:["properties"],args:{title:e.text&&e.text.length>0?(0,l.Yt)(e.text):void 0}},n.op.update({pointer:{table:a.iU,id:d(e.id)},path:[],args:u})];if("setBlockAttribute"===e.command)return[{pointer:{table:a.iU,id:d(e.id)},command:"update",path:["properties"],args:{[e.attribute]:(0,l.O2)(e.attribute,e.value)}},n.op.update({pointer:{table:a.iU,id:d(e.id)},path:[],args:u})];if("setBlockTagName"===e.command){const t=l.BO[e.tagName];if(!t)throw new Error(`Unknown tag name: ${e.tagName}`);return[{pointer:{table:a.iU,id:d(e.id)},command:"update",path:[],args:{type:t,...u}}]}if("setBlockProperty"===e.command){var f;const{blockId:t,property:o,parentBlockId:s}=e,p={table:a.iU,id:d(t)},m={table:a.iU,id:d(s)},h=c(p),b=c(m);if(!h)throw new Error(`Block not found: ${t}.`);if(!b)throw new Error(`Block not found: ${s}.`);if(h.type!==r.ZP.tableRow)throw new Error(`Cannot set property (${o.attributes.name}) on block type ${h.type}.`);if(b.type!==r.ZP.table)throw new Error("Parent block is not of type table.");const w=Number(o.attributes.name);if(!Number.isInteger(w)||w<1)throw new Error(`Invalid column index: ${w}.`);const v=(null===(f=b.format)||void 0===f?void 0:f.table_block_column_order)||[];if(w>v.length+1)throw new Error(`Column index too high: ${w}.`);const g=v[w-1];let y;g?y=g:(y=(0,i.Z)(),v.push((0,i.Z)()));const k=[n.op.set({pointer:p,path:["properties",y],args:o.children.length>0?(0,l.Yt)(o.children):void 0}),n.op.update({pointer:p,path:[],args:u})];return g||k.push(n.op.set({pointer:m,path:["format","table_block_column_order"],args:v}),n.op.update({pointer:m,path:[],args:u})),k}if("insertOrMoveTableColumns"===e.command){var w;const{blockId:t,atIndex:o,insertOrMoves:l}=e,p={table:a.iU,id:d(t)},m=c(p);if(!m)throw new Error(`Block not found: ${t}.`);if(m.type!==r.ZP.table)throw new Error("Block is not of type table.");const h=(null===(w=m.format)||void 0===w?void 0:w.table_block_column_order)||[],b=l.map((t=>{if("property"===t.type){return(0,i.Z)()}if("move"===t.type){const e=h[Number(t.attributes.name)];if(!e)throw new Error(`Invalid column index: ${t.attributes.name}.`);return e}(0,s.t1)(t)})),f=[...h.slice(0,o).filter((t=>!b.includes(t))),...b,...h.slice(o).filter((t=>!b.includes(t)))];return[n.op.set({pointer:p,path:["format","table_block_column_order"],args:f}),n.op.update({pointer:p,path:[],args:u})]}if("removeTableColumn"===e.command){var v;const{blockId:t,columnIndex:o}=e,i={table:a.iU,id:d(t)},s=c(i);if(!s)throw new Error(`Block not found: ${t}.`);if(s.type!==r.ZP.table)throw new Error("Block is not of type table.");const l=(null===(v=s.format)||void 0===v?void 0:v.table_block_column_order)||[],p=l[o];if(!p)throw new Error(`Invalid column index: ${o}.`);const m=[...l.slice(0,o),...l.slice(o+1)];return[n.op.set({pointer:i,path:["format","table_block_column_order"],args:m}),n.op.update({pointer:i,path:[],args:u}),...(s.content||[]).flatMap((t=>{const e={table:a.iU,id:t},o=c(e);return o&&o.type===r.ZP.tableRow?[n.op.set({pointer:e,path:["properties",p],args:void 0}),n.op.update({pointer:e,path:[],args:u})]:[]}))]}(0,s.t1)(e)}function d(t){return t.split("/")[0]}},24993:(t,e,o)=>{o.d(e,{P5:()=>N,IT:()=>x,O2:()=>$,Yt:()=>B,BO:()=>D});var r=o(96486),n=o.n(r),i=o(41432),a=o(99036),s=o(16691),l=o(64572),c=o(45946),d=o(74446),p=o(45953),u=o(98459),m=o(98963),h=o(18844),b=o(21202),f=o(13493),w=o(70279),v=o(33709),g=o(80396),y=o(19889),k=o(70203),I=o(97880),E=o(7928),C=o(78395);function N(t){const e=(new DOMParser).parseFromString(`<wrap>${t}</wrap>`,"application/xml"),o=e.querySelector("parsererror");if(o)throw new Error(o.textContent||"Unknown error");return Array.from(e.childNodes[0].childNodes).map(U)}function U(t){if(t.nodeType===Node.ELEMENT_NODE){const e=t;return{type:"element",tagName:e.tagName.toLowerCase(),attributes:_(e.attributes),children:Array.from(t.childNodes).map(U)}}if(t.nodeType===Node.TEXT_NODE)return{type:"text",value:t.nodeValue||""};throw new Error(`Unexpected node type: ${t.nodeType}`)}function _(t){const e={};for(let o=0;o<t.length;o++){const r=t.item(o);r&&(e[r.name]=r.value)}return e}async function x(t){const{pointer:e,loadRecordValue:o,baseUrl:r,publicDomainName:a,intl:u}=t,{recordMap:I}=await async function(t){const{loadRecordValue:e}=t,o=t.pointer,r=p.Ak.create(),a=new Set,u=d.zF.fromMonomorphicFunctionUnsafe((async t=>{const o=r.get(t);if(o)return o;const n=await e(t);return r.set(t,n),n&&await I(t.table,n),n})),I=async function(e,o){const r=[],d=o;if(d.parent_table&&d.parent_id&&r.push([p.dr.getParentPointerFromRecordWithParent(d),"Block parent_id"]),e===b.iU){var I;const e=o;if(e.view_ids)for(const t of e.view_ids)r.push([{table:f.n,id:t,spaceId:e.space_id},"CollectionViewBlock view_id"]);const a=c.kk.fromBlock(e).getCollectionPointer();if(a&&r.push([a,"CollectionViewBlock collection_id"]),e.discussions)for(const t of e.discussions)r.push([p.dr.fromPointerLike({table:v.qF,id:t,spaceId:e.space_id}),"Discussion"]);if((0,i.XD)(e.type)&&e.properties&&e.properties.title){const o=k.lz(e.properties.title),i=n().union(...o.map(k.hD));for(const n of i){if(k.ST(n)&&r.push([{table:b.iU,id:k.TO(n)},"page annotation"]),k.IW(n)&&r.push([{table:y.KJ,id:k.zE(n)},"user annotation"]),k.j0(n)){const e=k.zW(n),o=(0,l.A5)({url:e,baseUrl:t.baseUrl,publicDomainName:t.publicDomainName});o&&r.push([{table:b.iU,id:o},"link annotation"])}if(k.nS(n)){const t=k.Ik(n);t&&r.push([{table:b.iU,id:t,spaceId:e.space_id},"eoi annotation"])}}}if(e.type===i.ZP.alias&&e.format&&e.format.alias_pointer&&r.push([e.format.alias_pointer,"alias"]),e.type===i.ZP.externalObjectInstance){var E,C;const t=(null===(E=e.format)||void 0===E?void 0:E.related_external_object_uris_to_instance_ids)&&Object.values(null===(C=e.format)||void 0===C?void 0:C.related_external_object_uris_to_instance_ids)||[];for(const o of t)r.push([{table:b.iU,id:o,spaceId:e.space_id},"eoi"])}e.type===i.ZP.button&&null!==(I=e.format)&&void 0!==I&&I.automation_id&&r.push([{table:m.cv,id:e.format.automation_id,spaceId:e.space_id},"button_automation"])}else if(e===v.qF){const t=o,e=t.comments||[];for(const o of e)r.push([p.dr.fromPointerLike({table:w.x_,id:o,spaceId:t.space_id}),"discussion table comment"])}else if(e===w.x_){const t=o,e=t.content;if(e)for(const o of e)r.push([p.dr.fromPointerLike({table:b.iU,id:o,spaceId:t.space_id}),"comment table comment"]);if(t.reactions)for(const o of t.reactions)r.push([p.dr.fromPointerLike({table:g.yo,id:o,spaceId:t.space_id}),"comment table reaction"])}else if(e===f.n){var N;const t=o,e=null==t||null===(N=t.format)||void 0===N?void 0:N.collection_pointer;e&&r.push([e,"CollectionView collection_id"])}else if(e===m.cv){const t=o;for(const e of t.action_ids??[])r.push([{table:h.Xj,id:e,spaceId:t.space_id},"Automation action_ids"])}await Promise.all(r.filter((t=>{let[e,o]=t;const r=(0,s.dn)(e);return!a.has(r)&&(a.add(r),!0)})).map((t=>{let[e,o]=t;return e})).map(u))};let E=[o];const C=async function(){if(0===E.length)return!1;const t=E;E=[];const e=await Promise.all(t.map((async t=>await u(t))));for(let r=0;r<t.length;r++){const t=e[r],n=t&&t.content;if(t&&n&&"column_list"===t.type)for(const e of n)E.push({table:b.iU,id:e});else if(t&&"transclusion_reference"===t.type&&t.format&&t.format.transclusion_reference_pointer)E.push(t.format.transclusion_reference_pointer);else if(t&&n&&(0,i.Um)(t.type,t.format)&&(t.id===o.id||"page"!==t.type&&!(0,i.BX)(t.type,t.format)))for(const e of n)E.push({table:b.iU,id:e})}return!0};for(;await C(););return{recordMap:r}}({pointer:e,baseUrl:r,publicDomainName:a,loadRecordValue:o}),E=O({pointer:e,recordMap:I,rootPointer:e,parentPointer:void 0,intl:u});if(!E)throw new Error("Failed to build XML node");return E}function S(t){const{intl:e,textValue:o,recordMap:r}=t,n=[];for(const a of o){let o=n,s=!1;const l=k.hD(a);for(const n of l){k.ZA(n)&&(s=!0);const a=k.J7(n),[l]=P[a];if(!(0,I.qg)(C.t,l))continue;const c={type:"inline",tagName:l,attributes:{},children:[]};if(k.j0(n)){const t=k.zW(n);c.attributes.href=t}else if(k.ST(n)){const e=k.TO(n),o=r.get({table:b.iU,id:e});if(o){"collection_view"===o.type||"collection_view_page"===o.type?(c.tagName="mention-database",c.attributes["database-id"]=e):(c.tagName="mention-page",c.attributes["page-id"]=e);const r=(0,u.Bq)({table:b.iU,value:o});if(r){const e=t.recordMap.get(r);null!=e&&e.name&&(c.children=[{type:"text",value:k.Q(e.name)}])}else{var i;c.children=[{type:"text",value:k.Q(null===(i=o.properties)||void 0===i?void 0:i.title)}]}}}else if(k.IW(n)){const t=k.zE(n);c.attributes["person-id"]=t;const o=r.get({table:y.KJ,id:t});o&&(c.children=[{type:"text",value:(0,E.Nz)(e,o)}])}o.push(c),o=c.children}if(!s){const t=k.Wi(a);o.push({type:"text",value:t})}}return n}function O(t){const{pointer:e,recordMap:o,rootPointer:r,parentPointer:n,intl:a}=t,s=o.get(e);if(!s)return;const l=A[s.type];if(!(0,I.qg)(C.pX,l))return;const c={type:"block",id:s.id,tagName:l,text:[],attributes:{id:s.id},properties:{},children:[],parent:void 0,persisted:!0};if(s.type===i.ZP.page)T({node:c,block:s,recordMap:o,intl:a}),e!==r&&(c.tagName="child-page",c.attributes.id=`${s.id}/${(null==n?void 0:n.id)||r.id}`,c.attributes["page-id"]=s.id);else if(s.type===i.ZP.collectionView||s.type===i.ZP.collectionViewPage)T({node:c,block:s,recordMap:o,intl:a}),e!==r&&(c.tagName="child-database",c.attributes.id=`${s.id}/${(null==n?void 0:n.id)||r.id}`,c.attributes["database-id"]=s.id);else if(s.type===i.ZP.alias){var d;if(null===(d=s.format)||void 0===d||!d.alias_pointer||s.format.alias_pointer.table!==b.iU)return;const t=o.get(s.format.alias_pointer);if(!t)return;T({node:c,block:t,recordMap:o,intl:a}),t.type===i.ZP.collectionView||t.type===i.ZP.collectionViewPage?(c.tagName="link-database",c.attributes["database-id"]=t.id):(c.tagName="link-page",c.attributes["page-id"]=t.id)}else if(s.type===i.ZP.table){var p,u;const t=null===(p=s.format)||void 0===p?void 0:p.table_block_row_header,e=null===(u=s.format)||void 0===u?void 0:u.table_block_column_header;t&&(c.attributes["header-row"]=t?"true":"false"),e&&(c.attributes["header-column"]=e?"true":"false")}else if(s.type===i.ZP.tableRow){var m;if(s.parent_table!==b.iU)return;const t=o.get({table:s.parent_table,id:s.parent_id,spaceId:s.space_id});if(!t||t.type!==i.ZP.table)return;const e=(null===(m=t.format)||void 0===m?void 0:m.table_block_column_order)||[];for(const r of e){var h;const t=(e.indexOf(r)+1).toString(),n={type:"property",tagName:"property-text",attributes:{name:t},children:S({textValue:(null===(h=s.properties)||void 0===h?void 0:h[r])||[],recordMap:o,intl:a})};c.properties[t]=n}}else T({block:s,node:c,recordMap:o,intl:a});if(s.content){const t=s.content.map((t=>O({pointer:{table:"block",id:t},recordMap:o,rootPointer:r,parentPointer:e,intl:a}))).filter(I.$K);c.children.push(...t)}return c}function T(t){const{block:e,node:o,recordMap:r,intl:n}=t;for(const s of a.qF){var i;const a=null===(i=e.properties)||void 0===i?void 0:i[s];if("title"===s){const i=(0,u.Bq)({table:b.iU,value:e});if(i){const e=t.recordMap.get(i);null!=e&&e.name&&o.text.push(...S({textValue:e.name,recordMap:r,intl:n}))}else a&&o.text.push(...S({textValue:a,recordMap:r,intl:n}))}else if(a){const t=M(s,a);t&&(o.attributes[s]=t)}}}function M(t,e){if("checked"===t)return k.Q(e)===a.bx?"true":"false"}function $(t,e){if("checked"===t)return"true"===e?k.TP(a.bx):void 0}function B(t){const e=t.flatMap((t=>{if("inline"===t.type){const e=j[t.tagName];if(!e)throw new Error(`Unknown inline element: ${t.tagName}`);const o=t.attributes,r=B(t.children),n=[e,...P[e].slice(1).map((e=>{const r=o[e];if(!r)throw new Error(`Missing attribute ${e} for inline element ${t.tagName}`);return r}))];return r.map((t=>k.V3(k.Wi(t),[n,...k.hD(t)])))}if("text"===t.type)return[k.V3(t.value,[])];(0,I.t1)(t)}));return k.Zx(e)}const A={text:"text",page:"page",bulleted_list:"uli",numbered_list:"oli",toggle:"toggle",quote:"quote",factory:"factory",button:"button",to_do:"todo",column_list:"columns",column:"column",embed:"embed",framer:"embed",tweet:"embed",gist:"embed",drive:"embed",figma:"embed",loom:"embed",typeform:"embed",codepen:"embed",audio:"embed",maps:"embed",invision:"embed",image:"embed",pdf:"embed",video:"embed",file:"embed",bookmark:"embed",equation:"math-block",code:"code-block",header:"h1",sub_header:"h2",sub_sub_header:"h3",collection_view:"database",collection_view_page:"database",breadcrumb:"breadcrumb",copy_indicator:"copy_indicator",link_to_page:"link_to_page",link_to_collection:"link_to_collection",alias:"link-page",transclusion_container:"syncedblocksource",transclusion_reference:"syncedblockreference",divider:"hr",callout:"callout",table_of_contents:"tableofcontents",whimsical:"embed",miro:"embed",abstract:"embed",sketch:"embed",excalidraw:"embed",replit:"embed",hex:"embed",deepnote:"embed",external_object_instance:"embed",external_object_instance_page:"embed",table:"table",table_row:"tr",tab:"tab",ai_block:"ai-block"},D={...Object.fromEntries((0,I.qP)(A).map((t=>{let[e,o]=t;return[o,e]}))),"child-page":"page","child-database":"page","link-page":"alias","link-database":"alias"},P={b:["b"],i:["i"],s:["s"],c:["code"],_:["u"],"+":["+"],"-":["-"],z:["z"],u:["person"],r:["r"],p:["mention-page"],pt:["pt"],d:["date"],eoi:["eoi"],tv:["tv"],cm:["cm"],m:["m"],a:["a","href"],h:["h"],e:["e"],et:["et"],xt:["xt"],st:["st"],fpp:["fpp"],fup:["fup"],fv:["fv"],g:["group"]},j=Object.fromEntries((0,I.qP)(P).map((t=>{let[e,[o]]=t;return[o,e]})))}}]);